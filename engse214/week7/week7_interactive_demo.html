<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 7: Web Security Interactive Demo - ENGSE214</title>
    <style>
        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #e94560;
            --success: #4ade80;
            --warning: #fbbf24;
            --danger: #ef4444;
            --info: #3b82f6;
            --light: #f8fafc;
            --dark: #1e293b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            min-height: 100vh;
            color: var(--light);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid var(--accent);
            margin-bottom: 30px;
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--accent);
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tab-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            background: var(--dark);
            color: var(--light);
        }
        
        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(233, 69, 96, 0.3);
        }
        
        .tab-btn.active {
            background: var(--accent);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .demo-section {
            background: var(--dark);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }
        
        .demo-section h2 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .demo-section h3 {
            margin: 20px 0 15px;
            color: var(--warning);
            font-size: 1.2rem;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #374151;
            border-radius: 8px;
            background: var(--secondary);
            color: var(--light);
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: var(--accent);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: var(--dark);
        }
        
        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .result-box {
            background: #0f172a;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--info);
        }
        
        .result-box.vulnerable {
            border-left-color: var(--danger);
        }
        
        .result-box.secure {
            border-left-color: var(--success);
        }
        
        .code-block {
            background: #0f172a;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .code-block.vulnerable {
            border: 2px solid var(--danger);
        }
        
        .code-block.secure {
            border: 2px solid var(--success);
        }
        
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-right: 5px;
        }
        
        .badge-danger {
            background: var(--danger);
            color: white;
        }
        
        .badge-success {
            background: var(--success);
            color: var(--dark);
        }
        
        .badge-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .badge-info {
            background: var(--info);
            color: white;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #374151;
        }
        
        th {
            background: var(--secondary);
            font-weight: 600;
        }
        
        .payload-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }
        
        .payload-btn {
            padding: 8px 15px;
            background: var(--secondary);
            border: 1px solid #374151;
            border-radius: 5px;
            cursor: pointer;
            font-family: monospace;
            font-size: 0.85rem;
            color: var(--light);
            transition: all 0.2s;
        }
        
        .payload-btn:hover {
            background: var(--accent);
            border-color: var(--accent);
        }
        
        .warning-box {
            background: rgba(251, 191, 36, 0.1);
            border: 2px solid var(--warning);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .warning-box h4 {
            color: var(--warning);
            margin-bottom: 10px;
        }
        
        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border: 2px solid var(--info);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .user-card {
            background: var(--secondary);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .comment-card {
            background: var(--secondary);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 3px solid var(--info);
        }
        
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .comparison > div {
            padding: 20px;
            border-radius: 10px;
        }
        
        .comparison .vulnerable-side {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--danger);
        }
        
        .comparison .secure-side {
            background: rgba(74, 222, 128, 0.1);
            border: 2px solid var(--success);
        }
        
        .highlight-danger {
            color: var(--danger);
            font-weight: bold;
        }
        
        .highlight-success {
            color: var(--success);
            font-weight: bold;
        }
        
        #xss-output-frame {
            width: 100%;
            min-height: 150px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            color: black;
        }
        
        .owasp-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }
        
        @media (max-width: 900px) {
            .owasp-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .owasp-card {
            background: var(--secondary);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .owasp-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(233, 69, 96, 0.2);
        }
        
        .owasp-card.highlighted {
            border: 2px solid var(--accent);
            background: rgba(233, 69, 96, 0.1);
        }
        
        .owasp-rank {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
        }
        
        .owasp-name {
            font-size: 0.85rem;
            margin-top: 5px;
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            border-top: 2px solid var(--accent);
            margin-top: 30px;
        }
        
        .quiz-option {
            display: block;
            padding: 15px;
            margin: 10px 0;
            background: var(--secondary);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .quiz-option:hover {
            border-color: var(--accent);
        }
        
        .quiz-option.correct {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
        }
        
        .quiz-option.incorrect {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }
        
        .score-display {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            padding: 20px;
            background: var(--secondary);
            border-radius: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üõ°Ô∏è Web Application Security Demo</h1>
            <p>ENGSE214 - Week 7: OWASP Top 10, SQL Injection & XSS</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('overview')">üìä OWASP Overview</button>
            <button class="tab-btn" onclick="showTab('sqli')">üíâ SQL Injection</button>
            <button class="tab-btn" onclick="showTab('xss')">üé≠ XSS Demo</button>
            <button class="tab-btn" onclick="showTab('prevention')">üõ°Ô∏è Prevention</button>
            <button class="tab-btn" onclick="showTab('quiz')">üìù Quick Quiz</button>
        </div>

        <!-- OWASP Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="demo-section">
                <h2>üèÜ OWASP Top 10:2025</h2>
                <p style="margin-bottom: 20px;">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</p>
                
                <div class="owasp-grid">
                    <div class="owasp-card" onclick="showOwaspDetail('a01')">
                        <div class="owasp-rank">#1</div>
                        <div class="owasp-name">üîì Broken Access Control</div>
                    </div>
                    <div class="owasp-card" onclick="showOwaspDetail('a02')">
                        <div class="owasp-rank">#2</div>
                        <div class="owasp-name">‚öôÔ∏è Security Misconfiguration</div>
                    </div>
                    <div class="owasp-card" onclick="showOwaspDetail('a03')">
                        <div class="owasp-rank">#3</div>
                        <div class="owasp-name">üì¶ Supply Chain Failures</div>
                        <span class="badge badge-warning">NEW!</span>
                    </div>
                    <div class="owasp-card" onclick="showOwaspDetail('a04')">
                        <div class="owasp-rank">#4</div>
                        <div class="owasp-name">üîê Cryptographic Failures</div>
                    </div>
                    <div class="owasp-card highlighted" onclick="showOwaspDetail('a05')">
                        <div class="owasp-rank">#5</div>
                        <div class="owasp-name">üíâ Injection</div>
                        <span class="badge badge-danger">TODAY!</span>
                    </div>
                    <div class="owasp-card" onclick="showOwaspDetail('a06')">
                        <div class="owasp-rank">#6</div>
                        <div class="owasp-name">üìê Insecure Design</div>
                    </div>
                    <div class="owasp-card" onclick="showOwaspDetail('a07')">
                        <div class="owasp-rank">#7</div>
                        <div class="owasp-name">üîë Auth Failures</div>
                    </div>
                    <div class="owasp-card" onclick="showOwaspDetail('a08')">
                        <div class="owasp-rank">#8</div>
                        <div class="owasp-name">üß© Vulnerable Components</div>
                    </div>
                    <div class="owasp-card" onclick="showOwaspDetail('a09')">
                        <div class="owasp-rank">#9</div>
                        <div class="owasp-name">üìù Logging Failures</div>
                    </div>
                    <div class="owasp-card" onclick="showOwaspDetail('a10')">
                        <div class="owasp-rank">#10</div>
                        <div class="owasp-name">‚ö†Ô∏è Exceptional Conditions</div>
                        <span class="badge badge-warning">NEW!</span>
                    </div>
                </div>

                <div id="owasp-detail" class="result-box" style="display:none; margin-top:20px;">
                    <h3 id="owasp-detail-title"></h3>
                    <p id="owasp-detail-desc"></p>
                    <h4 style="margin-top:15px; color:var(--success);">Prevention:</h4>
                    <ul id="owasp-detail-prevention" style="margin-left:20px;"></ul>
                </div>
            </div>
        </div>

        <!-- SQL Injection Tab -->
        <div id="sqli" class="tab-content">
            <div class="warning-box">
                <h4>‚ö†Ô∏è Educational Purpose Only</h4>
                <p>‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢! Demo ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
            </div>

            <div class="demo-section">
                <h2>üíâ SQL Injection Demo</h2>
                
                <div class="grid-2">
                    <div>
                        <h3>üîê Login Form (Simulated)</h3>
                        <div class="form-group">
                            <label>Username:</label>
                            <input type="text" id="sqli-username" placeholder="Enter username">
                        </div>
                        <div class="form-group">
                            <label>Password:</label>
                            <input type="password" id="sqli-password" placeholder="Enter password">
                        </div>
                        <button class="btn btn-primary" onclick="demonstrateSQLi()">Login (Vulnerable)</button>
                        <button class="btn btn-success" onclick="demonstrateSecureSQLi()">Login (Secure)</button>
                        
                        <h4 style="margin-top:20px; color:var(--warning);">Try These Payloads:</h4>
                        <div class="payload-list">
                            <button class="payload-btn" onclick="fillSQLiPayload(`' OR '1'='1`)">Basic Bypass</button>
                            <button class="payload-btn" onclick="fillSQLiPayload(`admin'--`)">Comment</button>
                            <button class="payload-btn" onclick="fillSQLiPayload(`' OR 1=1--`)">OR 1=1</button>
                            <button class="payload-btn" onclick="fillSQLiPayload(`' UNION SELECT * FROM users--`)">UNION</button>
                        </div>
                    </div>

                    <div>
                        <h3>üìä Simulated Database</h3>
                        <table>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Password (hashed)</th>
                                <th>Role</th>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>admin</td>
                                <td>$2y$10$xK...</td>
                                <td>Administrator</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>john</td>
                                <td>$2y$10$yM...</td>
                                <td>User</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>jane</td>
                                <td>$2y$10$zL...</td>
                                <td>User</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div id="sqli-result" class="result-box" style="display:none;">
                    <h3 id="sqli-result-title"></h3>
                    <div id="sqli-result-content"></div>
                </div>

                <h3 style="margin-top:30px;">üìù Generated SQL Query</h3>
                <div class="comparison">
                    <div class="vulnerable-side">
                        <span class="badge badge-danger">‚ùå Vulnerable</span>
                        <pre class="code-block" id="sqli-vulnerable-query">SELECT * FROM users 
WHERE username = '[INPUT]' 
AND password = '[INPUT]'</pre>
                    </div>
                    <div class="secure-side">
                        <span class="badge badge-success">‚úÖ Secure</span>
                        <pre class="code-block" id="sqli-secure-query">$stmt = $pdo->prepare(
  "SELECT * FROM users 
   WHERE username = ? 
   AND password = ?"
);
$stmt->execute([$username, $password]);</pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- XSS Tab -->
        <div id="xss" class="tab-content">
            <div class="warning-box">
                <h4>‚ö†Ô∏è Demo Environment</h4>
                <p>XSS ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á Preview ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</p>
            </div>

            <div class="demo-section">
                <h2>üé≠ Cross-Site Scripting (XSS) Demo</h2>

                <div class="grid-2">
                    <div>
                        <h3>üí¨ Comment Box (Simulated)</h3>
                        <div class="form-group">
                            <label>Your Name:</label>
                            <input type="text" id="xss-name" placeholder="Enter your name">
                        </div>
                        <div class="form-group">
                            <label>Your Comment:</label>
                            <textarea id="xss-comment" rows="4" placeholder="Enter your comment"></textarea>
                        </div>
                        <button class="btn btn-primary" onclick="demonstrateXSS('vulnerable')">Post (Vulnerable)</button>
                        <button class="btn btn-success" onclick="demonstrateXSS('secure')">Post (Secure)</button>
                        
                        <h4 style="margin-top:20px; color:var(--warning);">Try These Payloads:</h4>
                        <div class="payload-list">
                            <button class="payload-btn" onclick="fillXSSPayload(`<script>alert('XSS!')</script>`)">Alert</button>
                            <button class="payload-btn" onclick="fillXSSPayload(`<img src=x onerror=alert('XSS')>`)">Img Tag</button>
                            <button class="payload-btn" onclick="fillXSSPayload(`<svg onload=alert('XSS')>`)">SVG</button>
                            <button class="payload-btn" onclick="fillXSSPayload(`<body onload=alert('XSS')>`)">Body</button>
                            <button class="payload-btn" onclick="fillXSSPayload(`<script>document.body.innerHTML='<h1>Hacked!</h1>'</script>`)">Defacement</button>
                        </div>
                    </div>

                    <div>
                        <h3>üì∫ Preview (Vulnerable Rendering)</h3>
                        <div id="xss-output-frame">
                            <p style="color:#999;">Comments will appear here...</p>
                        </div>
                        
                        <h3 style="margin-top:20px;">üì∫ Preview (Secure Rendering)</h3>
                        <div id="xss-output-secure" style="background:white; color:black; padding:20px; border-radius:10px; min-height:100px;">
                            <p style="color:#999;">Comments will appear here...</p>
                        </div>
                    </div>
                </div>

                <h3 style="margin-top:30px;">üìù Code Comparison</h3>
                <div class="comparison">
                    <div class="vulnerable-side">
                        <span class="badge badge-danger">‚ùå Vulnerable Code</span>
                        <pre class="code-block">// JavaScript (Dangerous!)
element.innerHTML = userInput;

// PHP (Dangerous!)
echo $userInput;</pre>
                    </div>
                    <div class="secure-side">
                        <span class="badge badge-success">‚úÖ Secure Code</span>
                        <pre class="code-block">// JavaScript (Safe)
element.textContent = userInput;

// PHP (Safe)
echo htmlspecialchars($userInput, 
     ENT_QUOTES, 'UTF-8');</pre>
                    </div>
                </div>

                <div class="info-box" style="margin-top:20px;">
                    <h4>üí° XSS Types</h4>
                    <ul style="margin-left:20px; margin-top:10px;">
                        <li><strong>Stored XSS:</strong> Script ‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô Database - ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î!</li>
                        <li><strong>Reflected XSS:</strong> Script ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô URL - ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å</li>
                        <li><strong>DOM-based XSS:</strong> ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡πà‡∏á Client - ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏¢‡∏≤‡∏Å</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Prevention Tab -->
        <div id="prevention" class="tab-content">
            <div class="demo-section">
                <h2>üõ°Ô∏è Prevention Techniques</h2>

                <div class="grid-2">
                    <div>
                        <h3>üíâ SQL Injection Prevention</h3>
                        <div class="info-box">
                            <h4>1. Parameterized Queries</h4>
                            <pre class="code-block secure">// PHP PDO
$stmt = $pdo->prepare(
    "SELECT * FROM users WHERE id = ?"
);
$stmt->execute([$userId]);

// Python
cursor.execute(
    "SELECT * FROM users WHERE id = %s",
    (userId,)
);</pre>
                        </div>
                        
                        <div class="info-box">
                            <h4>2. ORM Usage</h4>
                            <pre class="code-block secure">// Laravel Eloquent
$user = User::where('email', $email)->first();

// Python SQLAlchemy
user = session.query(User).filter(
    User.email == email
).first();</pre>
                        </div>
                        
                        <div class="info-box">
                            <h4>3. Input Validation</h4>
                            <pre class="code-block secure">// Whitelist validation
if (!preg_match('/^[a-zA-Z0-9]+$/', $input)) {
    return error('Invalid characters');
}

// Type checking
$id = filter_var($id, FILTER_VALIDATE_INT);
if ($id === false) {
    return error('Invalid ID');
}</pre>
                        </div>
                    </div>

                    <div>
                        <h3>üé≠ XSS Prevention</h3>
                        <div class="info-box">
                            <h4>1. Output Encoding</h4>
                            <pre class="code-block secure">// PHP
echo htmlspecialchars(
    $input, ENT_QUOTES, 'UTF-8'
);

// JavaScript
element.textContent = userInput;
// NOT: element.innerHTML</pre>
                        </div>
                        
                        <div class="info-box">
                            <h4>2. Content Security Policy</h4>
                            <pre class="code-block secure">// HTTP Header
Content-Security-Policy: 
    default-src 'self';
    script-src 'self';
    style-src 'self' 'unsafe-inline';</pre>
                        </div>
                        
                        <div class="info-box">
                            <h4>3. HTTPOnly Cookies</h4>
                            <pre class="code-block secure">// Set-Cookie Header
Set-Cookie: session=abc123; 
    HttpOnly; 
    Secure; 
    SameSite=Strict</pre>
                        </div>
                    </div>
                </div>

                <h3 style="margin-top:30px;">‚úÖ Secure Coding Checklist</h3>
                <table>
                    <tr>
                        <th>Category</th>
                        <th>Best Practice</th>
                        <th>Tools/Methods</th>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>Always use Prepared Statements</td>
                        <td>PDO, mysqli, ORM</td>
                    </tr>
                    <tr>
                        <td>Output</td>
                        <td>Encode all user input before display</td>
                        <td>htmlspecialchars(), textContent</td>
                    </tr>
                    <tr>
                        <td>Headers</td>
                        <td>Set security headers</td>
                        <td>CSP, X-XSS-Protection</td>
                    </tr>
                    <tr>
                        <td>Cookies</td>
                        <td>Use secure cookie flags</td>
                        <td>HttpOnly, Secure, SameSite</td>
                    </tr>
                    <tr>
                        <td>Dependencies</td>
                        <td>Audit regularly</td>
                        <td>npm audit, Snyk, Dependabot</td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Quiz Tab -->
        <div id="quiz" class="tab-content">
            <div class="demo-section">
                <h2>üìù Quick Quiz: Test Your Knowledge</h2>
                
                <div class="score-display">
                    Score: <span id="quiz-score">0</span> / <span id="quiz-total">5</span>
                </div>

                <div id="quiz-container">
                    <!-- Questions will be loaded here -->
                </div>

                <button class="btn btn-primary" id="quiz-submit" onclick="submitQuiz()" style="margin-top:20px;">Submit Answers</button>
                <button class="btn btn-warning" onclick="resetQuiz()" style="margin-top:20px; margin-left:10px;">Reset Quiz</button>
            </div>
        </div>

        <footer>
            <p>ENGSE214 - Introduction to Cybersecurity</p>
            <p>Week 7: Web Application Security & OWASP Overview</p>
            <p style="margin-top:10px; opacity:0.7;">Created for educational purposes only</p>
        </footer>
    </div>

    <script>
        // Tab switching
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // OWASP Details Data
        const owaspData = {
            a01: {
                title: '#1 - Broken Access Control',
                desc: '‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô',
                prevention: ['Implement proper access control checks', 'Deny by default', 'Log access control failures', 'Rate limit API access']
            },
            a02: {
                title: '#2 - Security Misconfiguration',
                desc: '‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ä‡πâ Default password, ‡πÄ‡∏õ‡∏¥‡∏î Debug mode, ‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Software',
                prevention: ['Remove unnecessary features', 'Regular security hardening', 'Automated configuration checks', 'Change default credentials']
            },
            a03: {
                title: '#3 - Software Supply Chain Failures [NEW!]',
                desc: '‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏à‡∏≤‡∏Å Third-party libraries ‡∏´‡∏£‡∏∑‡∏≠ Dependencies ‡πÄ‡∏ä‡πà‡∏ô Log4Shell, SolarWinds hack',
                prevention: ['Regular dependency audits', 'Use verified sources', 'Pin dependency versions', 'Implement SBOM (Software Bill of Materials)']
            },
            a04: {
                title: '#4 - Cryptographic Failures',
                desc: '‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Cryptography ‡∏ú‡∏¥‡∏î‡∏ß‡∏¥‡∏ò‡∏µ ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ä‡πâ MD5, ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ sensitive data, Hard-coded keys',
                prevention: ['Use modern algorithms (AES-256, SHA-256+)', 'Never store plaintext passwords', 'Use secure key management', 'Always use HTTPS']
            },
            a05: {
                title: '#5 - Injection (TODAY\'S FOCUS!)',
                desc: '‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏£‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô User input ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á SQL Injection, XSS, Command Injection',
                prevention: ['Use Parameterized Queries', 'Output Encoding', 'Input Validation (Whitelist)', 'Content Security Policy (CSP)']
            },
            a06: {
                title: '#6 - Insecure Design',
                desc: '‡∏Ç‡πâ‡∏≠‡∏ö‡∏Å‡∏û‡∏£‡πà‡∏≠‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏£‡∏Å ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á Security ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô Design',
                prevention: ['Threat Modeling', 'Secure Design Patterns', 'Security Requirements', 'Reference Architectures']
            },
            a07: {
                title: '#7 - Authentication & Session Failures',
                desc: '‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Session ‡πÄ‡∏ä‡πà‡∏ô Weak passwords, Session hijacking',
                prevention: ['Multi-Factor Authentication', 'Secure session management', 'Password strength requirements', 'Account lockout policies']
            },
            a08: {
                title: '#8 - Vulnerable and Outdated Components',
                desc: '‡πÉ‡∏ä‡πâ Library ‡∏´‡∏£‡∏∑‡∏≠ Framework ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ',
                prevention: ['Regular updates', 'Automated vulnerability scanning', 'Remove unused dependencies', 'Monitor security advisories']
            },
            a09: {
                title: '#9 - Security Logging and Alerting Failures',
                desc: '‡πÑ‡∏°‡πà‡∏°‡∏µ Log ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö Alert ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥',
                prevention: ['Log all security events', 'Implement alerting systems', 'Regular log review', 'Centralized log management']
            },
            a10: {
                title: '#10 - Mishandling of Exceptional Conditions [NEW!]',
                desc: '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Error/Exception ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° ‡πÄ‡∏ä‡πà‡∏ô Expose sensitive info ‡πÉ‡∏ô error messages',
                prevention: ['Generic error messages to users', 'Log detailed errors internally', 'Fail securely (deny by default)', 'Proper exception handling']
            }
        };

        function showOwaspDetail(id) {
            const data = owaspData[id];
            document.getElementById('owasp-detail').style.display = 'block';
            document.getElementById('owasp-detail-title').textContent = data.title;
            document.getElementById('owasp-detail-desc').textContent = data.desc;
            
            const prevList = document.getElementById('owasp-detail-prevention');
            prevList.innerHTML = data.prevention.map(p => `<li>${p}</li>`).join('');
        }

        // SQL Injection Demo
        const users = [
            { id: 1, username: 'admin', password: 'admin123', role: 'Administrator' },
            { id: 2, username: 'john', password: 'john456', role: 'User' },
            { id: 3, username: 'jane', password: 'jane789', role: 'User' }
        ];

        function fillSQLiPayload(payload) {
            document.getElementById('sqli-username').value = payload;
            document.getElementById('sqli-password').value = 'anything';
        }

        function demonstrateSQLi() {
            const username = document.getElementById('sqli-username').value;
            const password = document.getElementById('sqli-password').value;
            
            // Show the vulnerable query
            document.getElementById('sqli-vulnerable-query').textContent = 
                `SELECT * FROM users 
WHERE username = '${username}' 
AND password = '${password}'`;
            
            const resultDiv = document.getElementById('sqli-result');
            const titleEl = document.getElementById('sqli-result-title');
            const contentEl = document.getElementById('sqli-result-content');
            
            // Check for SQLi patterns
            const sqliPatterns = ["'", "OR", "UNION", "--", "/*", "1=1"];
            const isSqli = sqliPatterns.some(p => username.toUpperCase().includes(p) || password.toUpperCase().includes(p));
            
            if (isSqli) {
                resultDiv.className = 'result-box vulnerable';
                titleEl.innerHTML = '‚ö†Ô∏è SQL Injection Detected! (In Real Attack: ALL Data Exposed)';
                contentEl.innerHTML = `
                    <p style="color:var(--danger);">Your input bypassed authentication!</p>
                    <p>In a real vulnerable application, this would return:</p>
                    <div style="margin-top:10px;">
                        ${users.map(u => `
                            <div class="user-card">
                                <strong>ID:</strong> ${u.id} | 
                                <strong>Username:</strong> ${u.username} | 
                                <strong>Role:</strong> ${u.role}
                            </div>
                        `).join('')}
                    </div>
                    <p style="margin-top:15px; color:var(--warning);">üí° This is why we NEVER concatenate user input into SQL queries!</p>
                `;
            } else {
                const user = users.find(u => u.username === username && u.password === password);
                if (user) {
                    resultDiv.className = 'result-box secure';
                    titleEl.innerHTML = '‚úÖ Login Successful';
                    contentEl.innerHTML = `<p>Welcome, ${user.username}! Role: ${user.role}</p>`;
                } else {
                    resultDiv.className = 'result-box';
                    titleEl.innerHTML = '‚ùå Login Failed';
                    contentEl.innerHTML = '<p>Invalid username or password.</p>';
                }
            }
            
            resultDiv.style.display = 'block';
        }

        function demonstrateSecureSQLi() {
            const username = document.getElementById('sqli-username').value;
            const password = document.getElementById('sqli-password').value;
            
            const resultDiv = document.getElementById('sqli-result');
            const titleEl = document.getElementById('sqli-result-title');
            const contentEl = document.getElementById('sqli-result-content');
            
            // With prepared statements, input is treated as data, not code
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                resultDiv.className = 'result-box secure';
                titleEl.innerHTML = '‚úÖ Login Successful (Secure Method)';
                contentEl.innerHTML = `<p>Welcome, ${user.username}! Role: ${user.role}</p>`;
            } else {
                resultDiv.className = 'result-box secure';
                titleEl.innerHTML = 'üîí Login Failed (Secure Method)';
                contentEl.innerHTML = `
                    <p>Invalid username or password.</p>
                    <p style="margin-top:10px; color:var(--success);">
                        ‚úÖ With Prepared Statements, special characters like ' OR '1'='1 
                        are treated as literal string values, not SQL code!
                    </p>
                `;
            }
            
            resultDiv.style.display = 'block';
        }

        // XSS Demo
        function fillXSSPayload(payload) {
            document.getElementById('xss-comment').value = payload;
        }

        function demonstrateXSS(mode) {
            const name = document.getElementById('xss-name').value || 'Anonymous';
            const comment = document.getElementById('xss-comment').value;
            
            if (mode === 'vulnerable') {
                // WARNING: This is for demo only. Never do this in production!
                const vulnerableOutput = document.getElementById('xss-output-frame');
                vulnerableOutput.innerHTML = `
                    <div style="margin-bottom:10px; padding:10px; background:#f0f0f0; border-radius:5px;">
                        <strong>${name}</strong> says:
                        <p>${comment}</p>
                    </div>
                `;
            } else {
                // Secure: use textContent and escape HTML
                const secureOutput = document.getElementById('xss-output-secure');
                const div = document.createElement('div');
                div.style.cssText = 'margin-bottom:10px; padding:10px; background:#f0f0f0; border-radius:5px;';
                
                const strong = document.createElement('strong');
                strong.textContent = name;
                
                const span = document.createElement('span');
                span.textContent = ' says:';
                
                const p = document.createElement('p');
                p.textContent = comment;
                
                div.appendChild(strong);
                div.appendChild(span);
                div.appendChild(p);
                
                secureOutput.innerHTML = '';
                secureOutput.appendChild(div);
                
                // Show escaped HTML
                const escapedComment = comment
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#039;');
                
                const infoDiv = document.createElement('div');
                infoDiv.style.cssText = 'margin-top:10px; padding:10px; background:#d4edda; border-radius:5px; font-size:12px;';
                infoDiv.innerHTML = `<strong>‚úÖ Escaped Output:</strong><br><code>${escapedComment}</code>`;
                secureOutput.appendChild(infoDiv);
            }
        }

        // Quiz
        const quizQuestions = [
            {
                question: "‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô SQL Injection ‡∏Ñ‡∏∑‡∏≠?",
                options: [
                    "Blacklist dangerous characters",
                    "Use Parameterized Queries / Prepared Statements",
                    "Encrypt user input",
                    "Disable JavaScript"
                ],
                correct: 1
            },
            {
                question: "XSS ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏î‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?",
                options: [
                    "Reflected XSS",
                    "DOM-based XSS",
                    "Stored XSS",
                    "URL-based XSS"
                ],
                correct: 2
            },
            {
                question: "OWASP Top 10:2025 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1 ‡∏Ñ‡∏∑‡∏≠?",
                options: [
                    "SQL Injection",
                    "Cross-Site Scripting",
                    "Broken Access Control",
                    "Cryptographic Failures"
                ],
                correct: 2
            },
            {
                question: "HTTPOnly cookie flag ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏∞‡πÑ‡∏£?",
                options: [
                    "CSRF attacks",
                    "JavaScript access to cookie",
                    "Cookie expiration",
                    "Cookie encryption"
                ],
                correct: 1
            },
            {
                question: "Supply Chain Failures ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô OWASP 2025 ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á?",
                options: [
                    "‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Network",
                    "‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏à‡∏≤‡∏Å Third-party dependencies",
                    "‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏ô Hardware",
                    "‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Database"
                ],
                correct: 1
            }
        ];

        let userAnswers = {};

        function loadQuiz() {
            const container = document.getElementById('quiz-container');
            document.getElementById('quiz-total').textContent = quizQuestions.length;
            
            container.innerHTML = quizQuestions.map((q, i) => `
                <div style="margin-bottom:30px; padding:20px; background:var(--secondary); border-radius:10px;">
                    <h4 style="margin-bottom:15px;">${i + 1}. ${q.question}</h4>
                    ${q.options.map((opt, j) => `
                        <label class="quiz-option" id="q${i}o${j}" onclick="selectAnswer(${i}, ${j})">
                            <input type="radio" name="q${i}" value="${j}" style="display:none;">
                            ${String.fromCharCode(65 + j)}. ${opt}
                        </label>
                    `).join('')}
                </div>
            `).join('');
        }

        function selectAnswer(qIndex, oIndex) {
            // Reset all options for this question
            quizQuestions[qIndex].options.forEach((_, j) => {
                document.getElementById(`q${qIndex}o${j}`).className = 'quiz-option';
            });
            
            // Highlight selected
            document.getElementById(`q${qIndex}o${oIndex}`).style.borderColor = 'var(--accent)';
            userAnswers[qIndex] = oIndex;
        }

        function submitQuiz() {
            let score = 0;
            
            quizQuestions.forEach((q, i) => {
                const selected = userAnswers[i];
                
                // Reset all
                q.options.forEach((_, j) => {
                    const el = document.getElementById(`q${i}o${j}`);
                    if (j === q.correct) {
                        el.classList.add('correct');
                    } else if (j === selected && selected !== q.correct) {
                        el.classList.add('incorrect');
                    }
                });
                
                if (selected === q.correct) {
                    score++;
                }
            });
            
            document.getElementById('quiz-score').textContent = score;
            document.getElementById('quiz-submit').disabled = true;
        }

        function resetQuiz() {
            userAnswers = {};
            loadQuiz();
            document.getElementById('quiz-score').textContent = '0';
            document.getElementById('quiz-submit').disabled = false;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadQuiz();
        });
    </script>
</body>
</html>
