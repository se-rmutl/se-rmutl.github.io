<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Infographic: OWASP Top 10 2021</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            scroll-behavior: smooth;
        }

        .modal {
            transition: opacity 0.25s ease;
        }

        .modal-content {
            transition: transform 0.25s ease;
        }

        .code-block {
            background-color: #1E293B;
            /* slate-800 */
            color: #E2E8F0;
            /* slate-200 */
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .code-block .comment {
            color: #94A3B8;
        }

        /* slate-400 */
        .code-block .keyword {
            color: #F472B6;
        }

        /* pink-400 */
        .code-block .string {
            color: #A5B4FC;
        }

        /* indigo-300 */
        .code-block .function {
            color: #60A5FA;
        }

        /* blue-400 */
        .code-block .variable {
            color: #CBD5E1;
        }

        /* slate-300 */
    </style>
</head>

<body class="bg-slate-900 text-slate-200">

    <!-- Main Container -->
    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">OWASP Top 10 - 2021</h1>
            <p class="text-lg text-slate-400">Infographic สำหรับ Software Engineer | ENGSE214 Introduction to Cyber
                Security</p>
        </header>

        <!-- Grid of OWASP Top 10 Items -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6">
            <!-- Item Cards will be injected here by JavaScript -->
        </div>
    </div>

    <!-- Modals for each item -->
    <div id="modal-container">
        <!-- Modals will be injected here by JavaScript -->
    </div>

    <script>
        // Data for OWASP Top 10
        const owaspData = [
            {
                id: 'A01',
                title: 'Broken Access Control',
                subtitle: 'การควบคุมการเข้าถึงที่ผิดพลาด',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><path d="M12 11.1V22"></path><path d="M16 14.1c-2 0-4.5 2-4.5 3.9 0 1.4.5 2.8 1.5 3.8"></path><path d="M8.5 17.9c0-1.9 2.5-3.9 4.5-3.9"></path></svg>`,
                description: 'เกิดขึ้นเมื่อผู้ใช้สามารถเข้าถึงข้อมูลหรือฟังก์ชันการทำงานเกินกว่าสิทธิ์ที่ตนเองควรจะได้รับ ทำให้สามารถดู, แก้ไข, หรือลบข้อมูลของผู้อื่น หรือเข้าถึงส่วนของผู้ดูแลระบบได้',
                attackExample: `ผู้ใช้ธรรมดาล็อกอินเข้าระบบและเข้าถึงหน้าโปรไฟล์ของตนเองผ่าน URL: <br><code class="text-yellow-300">/user/profile?id=123</code><br>ผู้โจมตีลองเปลี่ยนค่า <code class="text-yellow-300">id</code> ใน URL เป็น <code class="text-yellow-300">id=124</code> หรือ <code class="text-yellow-300">id=1</code> (ซึ่งอาจเป็น admin) เพื่อเข้าดูข้อมูลของคนอื่นโดยที่ระบบไม่ได้ตรวจสอบสิทธิ์ความเป็นเจ้าของข้อมูล`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>บังคับใช้การตรวจสอบสิทธิ์ทุกครั้ง (Enforce checks on server-side):</strong> ทุก request ที่มีการเข้าถึงข้อมูล ต้องมีการตรวจสอบจากฝั่งเซิร์ฟเวอร์เสมอว่าผู้ใช้ที่ร้องขอมีสิทธิ์ในข้อมูลนั้นๆ จริงหรือไม่ อย่าเชื่อถือการตรวจสอบจากฝั่ง client เพียงอย่างเดียว</li>
                        <li><strong>ใช้ Role-Based Access Control (RBAC):</strong> กำหนด Role (เช่น admin, user, guest) และกำหนดสิทธิ์ของแต่ละ Role ให้ชัดเจน</li>
                        <li><strong>หลีกเลี่ยงการใช้ ID ที่คาดเดาได้ง่าย:</strong> แทนที่จะใช้ ID ที่เป็นตัวเลขเรียงกัน (1, 2, 3, ...) ให้ใช้ UUID (Universally Unique Identifier) ซึ่งคาดเดาได้ยากกว่ามาก</li>
                    </ul>`,
                codeExample: `
<span class="comment">// ตัวอย่างโค้ด (Node.js/Express) ที่ไม่ดี ❌</span>
<span class="keyword">app</span>.<span class="function">get</span>(<span class="string">'/invoice/:invoiceId'</span>, (<span class="variable">req, res</span>) => {
  <span class="comment">// ดึงข้อมูลใบแจ้งหนี้จาก ID ที่รับมาโดยไม่ตรวจสอบเจ้าของ</span>
  <span class="keyword">const</span> <span class="variable">invoice</span> = <span class="variable">db</span>.<span class="function">invoices</span>.<span class="function">find</span>(<span class="variable">req</span>.<span class="variable">params</span>.<span class="variable">invoiceId</span>);
  <span class="variable">res</span>.<span class="function">json</span>(<span class="variable">invoice</span>);
});

<span class="comment">// ตัวอย่างโค้ดที่ดี ✔️</span>
<span class="keyword">app</span>.<span class="function">get</span>(<span class="string">'/invoice/:invoiceId'</span>, <span class="function">requireAuth</span>, (<span class="variable">req, res</span>) => {
  <span class="keyword">const</span> <span class="variable">invoice</span> = <span class="variable">db</span>.<span class="function">invoices</span>.<span class="function">find</span>(<span class="variable">req</span>.<span class="variable">params</span>.<span class="variable">invoiceId</span>);
  <span class="comment">// ตรวจสอบว่าผู้ใช้ที่ล็อกอินอยู่เป็นเจ้าของใบแจ้งหนี้นี้หรือไม่</span>
  <span class="keyword">if</span> (<span class="variable">invoice</span>.<span class="variable">ownerId</span> !== <span class="variable">req</span>.<span class="variable">user</span>.<span class="variable">id</span>) {
    <span class="keyword">return</span> <span class="variable">res</span>.<span class="function">status</span>(<span class="string">403</span>).<span class="function">send</span>(<span class="string">'Forbidden'</span>);
  }
  <span class="variable">res</span>.<span class="function">json</span>(<span class="variable">invoice</span>);
});`
            },
            {
                id: 'A02',
                title: 'Cryptographic Failures',
                subtitle: 'ความล้มเหลวด้านการเข้ารหัส',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>`,
                description: 'เกี่ยวข้องกับการจัดการข้อมูลที่ละเอียดอ่อน (Sensitive Data) เช่น รหัสผ่าน, ข้อมูลบัตรเครดิต, ข้อมูลส่วนบุคคล โดยใช้การเข้ารหัสที่อ่อนแอ, ไม่มีการเข้ารหัสเลย, หรือจัดการ Key ไม่ถูกต้อง ทำให้ข้อมูลรั่วไหลได้ง่ายเมื่อถูกดักจับ',
                attackExample: `
                    <ul class="list-disc list-inside space-y-2">
                        <li>เว็บไซต์ส่งข้อมูลรหัสผ่านเป็น Plain Text ผ่าน HTTP ทำให้ผู้โจมตีที่ดักฟังเครือข่าย (Man-in-the-Middle) สามารถเห็นรหัสผ่านได้ทันที</li>
                        <li>ฐานข้อมูลเก็บรหัสผ่านโดยใช้ Hash Algorithm ที่ล้าสมัยและไม่ปลอดภัย เช่น MD5 หรือ SHA1 ซึ่งสามารถถูกถอดรหัสกลับมาเป็นรหัสผ่านเดิมได้ในเวลาอันสั้นด้วย Rainbow Tables</li>
                    </ul>`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>ใช้ HTTPS เสมอ:</strong> บังคับใช้ TLS/HTTPS เพื่อเข้ารหัสข้อมูลทั้งหมดที่ส่งระหว่าง Client และ Server</li>
                        <li><strong>ใช้ Hashing Algorithm ที่แข็งแกร่งสำหรับรหัสผ่าน:</strong> ใช้อัลกอริทึมที่ออกแบบมาเพื่อการเก็บรหัสผ่านโดยเฉพาะ เช่น Argon2, scrypt, bcrypt ซึ่งทนทานต่อการโจมตีแบบ Brute-force</li>
                        <li><strong>เข้ารหัสข้อมูลที่ละเอียดอ่อน (Data at Rest):</strong> ข้อมูลสำคัญที่เก็บในฐานข้อมูลหรือไฟล์ควรถูกเข้ารหัสด้วยอัลกอริทึมที่แข็งแกร่ง เช่น AES-256</li>
                        <li><strong>อย่าสร้างอัลกอริทึมเข้ารหัสเอง:</strong> ใช้ Library ที่ผ่านการตรวจสอบและเป็นที่ยอมรับในวงกว้าง</li>
                    </ul>`,
                codeExample: `
<span class="comment">// ตัวอย่างการ Hash รหัสผ่านด้วย bcrypt ใน Node.js ✔️</span>
<span class="keyword">const</span> <span class="variable">bcrypt</span> = <span class="function">require</span>(<span class="string">'bcrypt'</span>);
<span class="keyword">const</span> <span class="variable">saltRounds</span> = <span class="string">10</span>; <span class="comment">// Cost factor</span>

<span class="keyword">const</span> <span class="variable">myPlaintextPassword</span> = <span class="string">'mySecurePassword123'</span>;

<span class="comment">// การสร้าง Hash</span>
<span class="variable">bcrypt</span>.<span class="function">hash</span>(<span class="variable">myPlaintextPassword</span>, <span class="variable">saltRounds</span>, (<span class="variable">err, hash</span>) => {
  <span class="comment">// เก็บ 'hash' ลงในฐานข้อมูล ไม่ใช่รหัสผ่านตรงๆ</span>
  <span class="variable">console</span>.<span class="function">log</span>(<span class="string">'Hashed Password:'</span>, <span class="variable">hash</span>);
});

<span class="comment">// การตรวจสอบรหัสผ่าน</span>
<span class="variable">bcrypt</span>.<span class="function">compare</span>(<span class="variable">myPlaintextPassword</span>, <span class="variable">storedHashFromDB</span>, (<span class="variable">err, result</span>) => {
  <span class="keyword">if</span> (<span class="variable">result</span>) {
    <span class="comment">// รหัสผ่านถูกต้อง</span>
  } <span class="keyword">else</span> {
    <span class="comment">// รหัสผ่านผิด</span>
  }
});`
            },
            {
                id: 'A03',
                title: 'Injection',
                subtitle: 'การโจมตีแบบแทรกแซง',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="m11.5 10.5-3 3 3 3"></path><path d="m8.5 13.5 h5"></path></svg>`,
                description: 'เกิดขึ้นเมื่อผู้โจมตีสามารถส่งข้อมูลที่เป็นโค้ดหรือคำสั่งอันตราย (Untrusted Data) เข้าไปในระบบ และระบบนำข้อมูลนั้นไปประมวลผล (Execute) โดยไม่ผ่านการตรวจสอบ ทำให้ผู้โจมตีสามารถควบคุมการทำงานของระบบได้ เช่น การดึงข้อมูล, การลบข้อมูล หรือการยึดครองระบบ ประเภทที่พบบ่อยที่สุดคือ SQL Injection',
                attackExample: `
                    <strong>SQL Injection:</strong> ในหน้าล็อกอิน ระบบใช้ SQL query เพื่อตรวจสอบ username และ password โดยการนำค่าที่รับมาต่อกับสตริง (String Concatenation) ดังนี้:<br>
                    <code class="text-yellow-300">query = "SELECT * FROM users WHERE username = '" + userInputUsername + "' AND password = '" + userInputPassword + "'"</code><br>
                    ผู้โจมตีใส่ <code class="text-yellow-300">' OR '1'='1</code> ในช่อง username และใส่อะไรก็ได้ในช่อง password<br>
                    ทำให้ SQL query สุดท้ายกลายเป็น:<br>
                    <code class="text-yellow-300">SELECT * FROM users WHERE username = '' OR '1'='1' AND password = '...'</code><br>
                    ซึ่งเงื่อนไข <code class="text-yellow-300">'1'='1'</code> เป็นจริงเสมอ ทำให้สามารถล็อกอินเข้าระบบได้โดยไม่ต้องรู้รหัสผ่าน`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>ใช้ Parameterized Queries (Prepared Statements):</strong> เป็นวิธีที่ดีที่สุดในการป้องกัน SQL Injection โดยการแยกส่วนของคำสั่ง SQL ออกจากข้อมูลที่ผู้ใช้ส่งมา ทำให้ Database Engine ไม่สับสนว่าข้อมูลนั้นเป็นส่วนหนึ่งของคำสั่ง</li>
                        <li><strong>ใช้ Object-Relational Mapping (ORM):</strong> ORM Libraries ส่วนใหญ่มีกลไกป้องกัน Injection มาให้ในตัว</li>
                        <li><strong>ตรวจสอบและกรองข้อมูลนำเข้า (Input Validation & Sanitization):</strong> ตรวจสอบข้อมูลที่รับมาจากผู้ใช้เสมอว่ามีรูปแบบและประเภทถูกต้องตามที่คาดหวัง</li>
                    </ul>`,
                codeExample: `
<span class="comment">// ตัวอย่างโค้ด (Node.js/mysql) ที่ไม่ดี ❌</span>
<span class="keyword">const</span> <span class="variable">query</span> = \`SELECT * FROM users WHERE id = \${<span class="variable">userInput</span>}\`; <span class="comment">// เสี่ยงต่อ SQL Injection</span>
<span class="variable">connection</span>.<span class="function">query</span>(<span class="variable">query</span>, ...);

<span class="comment">// ตัวอย่างโค้ดที่ดี (ใช้ Prepared Statements) ✔️</span>
<span class="keyword">const</span> <span class="variable">sql</span> = <span class="string">'SELECT * FROM users WHERE id = ?'</span>;
<span class="comment">// Database driver จะจัดการกับ userInput อย่างปลอดภัย</span>
<span class="variable">connection</span>.<span class="function">query</span>(<span class="variable">sql</span>, [<span class="variable">userInput</span>], (<span class="variable">error, results</span>) => {
  <span class="comment">// process results</span>
});`
            },
            {
                id: 'A04',
                title: 'Insecure Design',
                subtitle: 'การออกแบบที่ไม่ปลอดภัย',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path><path d="M22 12A10 10 0 0 0 12 2v10z"></path><path d="M12 12 5.1 5.1"></path><path d="M12 12 2.7 17.3"></path><path d="m12 12 7.3 5.3"></path></svg>`,
                description: 'ไม่ใช่ข้อบกพร่องในการเขียนโค้ด แต่เป็นจุดอ่อนที่ฝังอยู่ในขั้นตอนการออกแบบและสถาปัตยกรรมของซอฟต์แวร์ตั้งแต่แรก เป็นการขาดการพิจารณาถึงภัยคุกคาม (Threats) ที่อาจเกิดขึ้น ทำให้ระบบมีช่องโหว่แม้ว่าจะเขียนโค้ดได้ถูกต้องตามหลักการก็ตาม',
                attackExample: `
                    <ul class="list-disc list-inside space-y-2">
                        <li>ระบบ E-commerce ออกแบบฟีเจอร์ Flash Sale แต่ไม่ได้ออกแบบกลไกป้องกันการซื้อซ้ำ หรือการใช้บอท ทำให้ผู้โจมตีคนเดียวสามารถกว้านซื้อสินค้าทั้งหมดไปได้ในไม่กี่วินาที</li>
                        <li>ระบบโอนเงินที่ขั้นตอนการยืนยันการโอน (เช่น ใส่ OTP) เกิดขึ้นหลังจากที่ระบบได้ทำการตัดเงินจากบัญชีไปแล้ว ทำให้แม้ผู้ใช้จะยกเลิก แต่เงินก็ถูกโอนไปเรียบร้อย</li>
                    </ul>`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>ใช้ Threat Modeling:</strong> ในขั้นตอนการออกแบบ ให้ระดมสมองเพื่อหาว่า "มีอะไรที่อาจผิดพลาดได้บ้าง?" (What can go wrong?) และออกแบบวิธีการป้องกันไว้ล่วงหน้า</li>
                        <li><strong>ใช้หลักการ Secure by Design:</strong> สร้างความปลอดภัยให้เป็นส่วนหนึ่งของกระบวนการพัฒนาตั้งแต่ต้น ไม่ใช่สิ่งที่มาเพิ่มทีหลัง</li>
                        <li><strong>สร้าง Abuse Cases:</strong> นอกจากการคิดถึง Use Cases ของผู้ใช้ทั่วไปแล้ว ให้คิดถึง Abuse Cases หรือสถานการณ์ที่ผู้ไม่หวังดีจะพยายามใช้ฟีเจอร์ในทางที่ผิด</li>
                    </ul>`,
                codeExample: `
<span class="comment">// Insecure Design ไม่ใช่สิ่งที่แก้ได้ด้วยโค้ดสั้นๆ แต่เป็นเรื่องของ Logic และ Flow</span>
<span class="comment">// ตัวอย่างการคิดเรื่อง Threat Modeling สำหรับฟีเจอร์ "Reset Password"</span>

<span class="comment">// Threat: ผู้โจมตีสามารถขอรีเซ็ตรหัสผ่านของคนอื่นได้เรื่อยๆ ทำให้เกิดอีเมลสแปมไปยังเจ้าของบัญชี</span>
<span class="comment">// Mitigation: ใช้ Rate Limiting จำกัดจำนวนครั้งในการขอรีเซ็ตรหัสผ่านต่อช่วงเวลา</span>

<span class="comment">// Threat: Token สำหรับรีเซ็ตรหัสผ่านสามารถใช้งานได้ตลอดไป</span>
<span class="comment">// Mitigation: กำหนดให้ Token มีอายุสั้นๆ (เช่น 15 นาที) และใช้งานได้เพียงครั้งเดียว</span>

<span class="comment">// Threat: ข้อความที่แสดงผลบอกว่า "User not found" ทำให้ผู้โจมตีรู้ว่าอีเมลไหนมีในระบบ</span>
<span class="comment">// Mitigation: แสดงข้อความที่เป็นกลาง เช่น "If an account with that email exists, we have sent a password reset link."</span>`
            },
            {
                id: 'A05',
                title: 'Security Misconfiguration',
                subtitle: 'การตั้งค่าความปลอดภัยผิดพลาด',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M12.22 2h-4.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.44.25a2 2 0 0 1-2 1.73V20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5.29a2 2 0 0 1-2-1.73l-.44-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>`,
                description: 'เป็นหนึ่งในช่องโหว่ที่พบบ่อยที่สุด เกิดจากการตั้งค่าที่ไม่ปลอดภัยในส่วนต่างๆ ของ Application Stack เช่น ระบบปฏิบัติการ, เว็บเซิร์ฟเวอร์, เฟรมเวิร์ก, ฐานข้อมูล หรือ Cloud Services',
                attackExample: `
                    <ul class="list-disc list-inside space-y-2">
                        <li>เปิดใช้ Directory Listing บนเว็บเซิร์ฟเวอร์ ทำให้ผู้โจมตีสามารถเห็นไฟล์ทั้งหมดในไดเรกทอรีได้</li>
                        <li>ใช้รหัสผ่านเริ่มต้น (Default Passwords) สำหรับบัญชีแอดมินของฐานข้อมูลหรือแพลตฟอร์มต่างๆ</li>
                        <li>แสดง Error Message ที่มีข้อมูลทางเทคนิคละเอียดเกินไป (Verbose Error Messages) เช่น Stack Traces, ชื่อตัวแปร ซึ่งเป็นประโยชน์ต่อผู้โจมตี</li>
                        <li>S3 bucket บน Cloud ถูกตั้งค่าเป็น Public ทำให้ใครก็สามารถเข้าถึงไฟล์ภายในได้</li>
                    </ul>`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>Hardening:</strong> ปรับปรุงระบบให้มีความปลอดภัยสูงสุดโดยการปิดฟีเจอร์, พอร์ต, หรือเซอร์วิสที่ไม่จำเป็น</li>
                        <li><strong>เปลี่ยนค่าเริ่มต้นทั้งหมด:</strong> โดยเฉพาะรหัสผ่านและชื่อผู้ใช้เริ่มต้น</li>
                        <li><strong>ใช้ Automation:</strong> ใช้เครื่องมือ Infrastructure as Code (IaC) เช่น Terraform, Ansible เพื่อให้การตั้งค่าเหมือนกันทุกสภาพแวดล้อม (Dev, Staging, Prod) และตรวจสอบได้ง่าย</li>
                        <li><strong>ตั้งค่า Error Handling ให้เหมาะสม:</strong> แสดงข้อความแสดงข้อผิดพลาดที่เป็นมิตรต่อผู้ใช้ และบันทึกรายละเอียดทางเทคนิคไว้ใน Log สำหรับนักพัฒนาเท่านั้น</li>
                    </ul>`,
                codeExample: `
<span class="comment">// ตัวอย่างการตั้งค่า Error Handling ใน Express.js ✔️</span>
<span class="keyword">app</span>.<span class="function">use</span>((<span class="variable">err, req, res, next</span>) => {
  <span class="comment">// บันทึก error ทั้งหมดลง log สำหรับตรวจสอบ</span>
  <span class="variable">console</span>.<span class="function">error</span>(<span class="variable">err</span>.<span class="variable">stack</span>);

  <span class="comment">// ส่ง response ที่เป็นกลางไปยังผู้ใช้</span>
  <span class="variable">res</span>.<span class="function">status</span>(<span class="string">500</span>).<span class="function">json</span>({
    <span class="variable">error</span>: <span class="string">'An unexpected error occurred. Please try again later.'</span>
  });
});

<span class="comment">// ตัวอย่างการตั้งค่าใน nginx.conf เพื่อปิด directory listing ✔️</span>
<span class="variable">location /</span> {
  <span class="variable">autoindex</span> <span class="keyword">off</span>;
}`
            },
            {
                id: 'A06',
                title: 'Vulnerable & Outdated Components',
                subtitle: 'ส่วนประกอบที่ล้าสมัยและมีช่องโหว่',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>`,
                description: 'เกิดขึ้นเมื่อแอปพลิเคชันใช้ส่วนประกอบ (Components) เช่น Libraries, Frameworks, หรือ Modules อื่นๆ ที่มีช่องโหว่ความปลอดภัยที่ถูกค้นพบและเปิดเผยต่อสาธารณะแล้ว (Known Vulnerabilities) แต่ยังไม่ได้รับการอัปเดต (Patch)',
                attackExample: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>Log4Shell (2021):</strong> แอปพลิเคชันที่ใช้ Apache Log4j library เวอร์ชันที่มีช่องโหว่ สามารถถูกโจมตีแบบ Remote Code Execution ได้เพียงแค่ทำให้ระบบบันทึก Log ที่มีข้อความพิเศษที่ผู้โจมตีสร้างขึ้น</li>
                        <li><strong>ImageMagick Vulnerability:</strong> แอปพลิเคชันที่ใช้ library ImageMagick เวอร์ชันเก่าในการประมวลผลรูปภาพที่ผู้ใช้อัปโหลด อาจถูกโจมตีโดยการอัปโหลดไฟล์รูปภาพที่สร้างขึ้นเป็นพิเศษเพื่อรันโค้ดบนเซิร์ฟเวอร์</li>
                    </ul>`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>สแกนหาช่องโหว่เป็นประจำ:</strong> ใช้เครื่องมือ Software Composition Analysis (SCA) เพื่อสแกนหาช่องโหว่ใน Dependencies ของโปรเจกต์ เช่น <code class="text-yellow-300">npm audit</code>, <code class="text-yellow-300">pip-audit</code>, OWASP Dependency-Check, Snyk, GitHub Dependabot</li>
                        <li><strong>อัปเดตส่วนประกอบอย่างสม่ำเสมอ:</strong> ติดตามและอัปเดต Libraries และ Frameworks ให้เป็นเวอร์ชันล่าสุดที่มีการแก้ไขช่องโหว่แล้ว</li>
                        <li><strong>ลบ Dependencies ที่ไม่ได้ใช้ออก:</strong> ลดพื้นที่การโจมตี (Attack Surface) โดยการลบ Libraries ที่ไม่ได้ใช้งานออกจากโปรเจกต์</li>
                        <li><strong>ใช้ส่วนประกอบจากแหล่งที่น่าเชื่อถือ:</strong> ดาวน์โหลด library จาก Official Repositories เท่านั้น</li>
                    </ul>`,
                codeExample: `
<span class="comment"># ตัวอย่างการใช้ npm audit เพื่อตรวจสอบช่องโหว่ในโปรเจกต์ Node.js</span>
<span class="variable">npm audit</span>

<span class="comment"># ผลลัพธ์จะแสดงรายการ library ที่มีช่องโหว่ และคำสั่งสำหรับแก้ไข</span>
<span class="variable">found 6 vulnerabilities (2 low, 4 high) in 999 scanned packages</span>
<span class="variable">run \`npm audit fix\` to fix them, or \`npm audit\` for details</span>

<span class="comment"># คำสั่งสำหรับแก้ไขอัตโนมัติ</span>
<span class="variable">npm audit fix</span>`
            },
            {
                id: 'A07',
                title: 'Identification & Authentication Failures',
                subtitle: 'ความล้มเหลวด้านการระบุและพิสูจน์ตัวตน',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>`,
                description: 'เกี่ยวข้องกับจุดอ่อนในฟังก์ชันการจัดการผู้ใช้และการยืนยันตัวตน ทำให้ผู้โจมตีสามารถสวมรอยเป็นผู้ใช้อื่น, ขโมย Session, หรือคาดเดารหัสผ่านได้',
                attackExample: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>Credential Stuffing:</strong> ผู้โจมตีนำชุด Username/Password ที่รั่วไหลจากเว็บอื่น มาลองล็อกอินกับเว็บเป้าหมาย เพราะผู้ใช้จำนวนมากมักใช้รหัสผ่านเดียวกันในหลายๆ เว็บไซต์</li>
                        <li><strong>Brute-force Attack:</strong> ผู้โจมตีใช้โปรแกรมสุ่มรหัสผ่านไปเรื่อยๆ จนกว่าจะเจอรหัสผ่านที่ถูกต้อง โดยเฉพาะเมื่อระบบไม่มีการจำกัดจำนวนครั้งในการล็อกอินผิด</li>
                        <li><strong>Weak Password Recovery:</strong> ระบบรีเซ็ตรหัสผ่านที่ใช้คำถามความปลอดภัยที่คาดเดาง่าย (เช่น "โรงเรียนแรกของคุณชื่ออะไร?")</li>
                        <li><strong>Session ไม่หมดอายุ:</strong> ผู้ใช้กด Logout แต่ Session ID ยังคงใช้งานได้อยู่ ทำให้ผู้ที่เข้าถึงเบราว์เซอร์ต่อสามารถกลับเข้าระบบได้</li>
                    </ul>`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>บังคับใช้ Multi-Factor Authentication (MFA):</strong> เป็นวิธีที่มีประสิทธิภาพสูงในการป้องกันการเข้าถึงบัญชีโดยไม่ได้รับอนุญาต</li>
                        <li><strong>ใช้ Password Policy ที่แข็งแกร่ง:</strong> กำหนดความยาวขั้นต่ำ, ความซับซ้อน และตรวจสอบรหัสผ่านกับรายการรหัสผ่านที่ถูกใช้บ่อย (Common Password Lists)</li>
                        <li><strong>ป้องกันการโจมตีแบบ Brute-force:</strong> ใช้ Account Lockout (ล็อกบัญชีชั่วคราวหลังล็อกอินผิดหลายครั้ง) หรือ Rate Limiting</li>
                        <li><strong>จัดการ Session อย่างปลอดภัย:</strong> สร้าง Session ID ใหม่ทุกครั้งที่ล็อกอิน, ทำให้ Session ID เป็นโมฆะเมื่อ Logout, และตั้งค่า Timeout ที่เหมาะสม</li>
                    </ul>`,
                codeExample: `
<span class="comment">// ตัวอย่างการจัดการ Session ใน Express.js (express-session) ✔️</span>
<span class="keyword">app</span>.<span class="function">post</span>(<span class="string">'/login'</span>, (<span class="variable">req, res</span>) => {
  <span class="comment">// ... หลังจากตรวจสอบรหัสผ่านถูกต้อง ...</span>

  <span class="comment">// สร้าง Session ใหม่เพื่อป้องกัน Session Fixation</span>
  <span class="variable">req</span>.<span class="variable">session</span>.<span class="function">regenerate</span>((<span class="variable">err</span>) => {
    <span class="keyword">if</span> (<span class="variable">err</span>) <span class="keyword">return</span> <span class="function">next</span>(<span class="variable">err</span>);

    <span class="comment">// เก็บข้อมูลผู้ใช้ใน session</span>
    <span class="variable">req</span>.<span class="variable">session</span>.<span class="variable">user</span> = <span class="variable">userData</span>;
    <span class="variable">req</span>.<span class="variable">session</span>.<span class="function">save</span>((<span class="variable">err</span>) => {
      <span class="keyword">if</span> (<span class="variable">err</span>) <span class="keyword">return</span> <span class="function">next</span>(<span class="variable">err</span>);
      <span class="variable">res</span>.<span class="function">redirect</span>(<span class="string">'/dashboard'</span>);
    });
  });
});

<span class="keyword">app</span>.<span class="function">get</span>(<span class="string">'/logout'</span>, (<span class="variable">req, res</span>) => {
  <span class="comment">// ทำลาย Session เมื่อ Logout</span>
  <span class="variable">req</span>.<span class="variable">session</span>.<span class="function">destroy</span>((<span class="variable">err</span>) => {
    <span class="variable">res</span>.<span class="function">redirect</span>(<span class="string">'/'</span>);
  });
});`
            },
            {
                id: 'A08',
                title: 'Software and Data Integrity Failures',
                subtitle: 'ความล้มเหลวด้านความสมบูรณ์ของซอฟต์แวร์และข้อมูล',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M14 9a2 2 0 0 1-2 2H6l-4 4V4c0-1.1.9-2 2-2h8.5L14 9Z"></path><path d="M18 9h-1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2V11a2 2 0 0 0-2-2Z"></path></svg>`,
                description: 'เกี่ยวข้องกับการตรวจสอบความถูกต้องสมบูรณ์ (Integrity) ของโค้ด, ไลบรารี, และข้อมูล ว่าไม่ถูกเปลี่ยนแปลงแก้ไขโดยไม่ได้รับอนุญาตในระหว่างกระบวนการต่างๆ เช่น การอัปเดตซอฟต์แวร์, การดึง Dependencies, หรือการทำงานของ CI/CD Pipeline รวมถึงช่องโหว่จากการ Deserialization ข้อมูลที่ไม่น่าเชื่อถือ',
                attackExample: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>Insecure Deserialization:</strong> แอปพลิเคชันทำการ Deserialization (แปลงข้อมูลจาก Text/Binary กลับเป็น Object) ข้อมูลที่ได้รับมาจากผู้ใช้โดยไม่มีการตรวจสอบ ผู้โจมตีสามารถสร้างข้อมูลพิเศษ (Malicious Payload) ที่เมื่อถูก Deserialized แล้วจะทำให้เกิดการรันโค้ดอันตรายบนเซิร์ฟเวอร์ได้</li>
                        <li><strong>Dependency Confusion:</strong> ผู้โจมตีสร้าง Package ที่มีชื่อเดียวกันกับ Private Package ภายในองค์กร แล้วนำไปเผยแพร่บน Public Registry (เช่น npm, PyPI) เมื่อระบบ Build พยายามดึง Dependency อาจจะไปดึง Package อันตรายจาก Public Registry มาแทน</li>
                    </ul>`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>ตรวจสอบความถูกต้องของส่วนประกอบ (Verify Integrity):</strong> ใช้ Digital Signatures หรือ Hash (เช่น SHA-256) เพื่อตรวจสอบว่าไฟล์หรือ library ที่ดาวน์โหลดมาไม่ถูกเปลี่ยนแปลงแก้ไข</li>
                        <li><strong>ป้องกัน CI/CD Pipeline:</strong> จำกัดสิทธิ์การเข้าถึง, ตรวจสอบโค้ด, และสแกนหาช่องโหว่ในทุกขั้นตอนของ Pipeline</li>
                        <li><strong>หลีกเลี่ยงการ Deserialization ข้อมูลที่ไม่น่าเชื่อถือ:</strong> หากจำเป็นต้องทำ ควรใช้ Format ข้อมูลที่ปลอดภัย เช่น JSON และไม่ควร Deserialized ข้อมูลที่ผู้ใช้เป็นคนควบคุมได้โดยตรง</li>
                    </ul>`,
                codeExample: `
<span class="comment"># ตัวอย่างการตรวจสอบ Hash ของไฟล์ที่ดาวน์โหลด (Shell script) ✔️</span>
<span class="variable">wget https://example.com/some-library.zip</span>
<span class="variable">wget https://example.com/some-library.zip.sha256</span>

<span class="comment"># คำนวณ Hash ของไฟล์ที่โหลดมา</span>
<span class="variable">DOWNLOAD_HASH=$(sha256sum some-library.zip | awk '{ print $1 }')</span>
<span class="comment"># อ่าน Hash ที่ถูกต้องจากไฟล์ .sha256</span>
<span class="variable">EXPECTED_HASH=$(cat some-library.zip.sha256)</span>

<span class="keyword">if</span> [ "<span class="variable">$DOWNLOAD_HASH</span>" == "<span class="variable">$EXPECTED_HASH</span>" ]; <span class="keyword">then</span>
  <span class="variable">echo</span> <span class="string">"Integrity check passed!"</span>
  <span class="comment"># ดำเนินการต่อ</span>
<span class="keyword">else</span>
  <span class="variable">echo</span> <span class="string">"ERROR: Integrity check failed!"</span>
  <span class="variable">rm some-library.zip</span>
<span class="keyword">fi</span>`
            },
            {
                id: 'A09',
                title: 'Security Logging & Monitoring Failures',
                subtitle: 'ความล้มเหลวด้านการบันทึกและติดตามความปลอดภัย',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" x2="12" y1="18" y2="12"></line><line x1="9" x2="15" y1="15" y2="15"></line></svg>`,
                description: 'เกิดขึ้นเมื่อระบบขาดการบันทึก (Logging), การตรวจสอบ (Monitoring), และการแจ้งเตือน (Alerting) ที่เพียงพอ ทำให้ไม่สามารถตรวจจับกิจกรรมที่น่าสงสัยหรือการโจมตีที่กำลังเกิดขึ้นได้ทันท่วงที และเมื่อเกิดเหตุการณ์ขึ้นแล้ว ก็ยากที่จะสืบสวนหาสาเหตุและผลกระทบได้',
                attackExample: `
                    <ul class="list-disc list-inside space-y-2">
                        <li>ผู้โจมตีทำการ Brute-force รหัสผ่าน แต่ระบบไม่มีการบันทึก Log การล็อกอินที่ล้มเหลว และไม่มีการแจ้งเตือนไปยังแอดมิน ทำให้การโจมตีดำเนินต่อไปได้โดยไม่มีใครรู้</li>
                        <li>หลังจากที่ผู้โจมตีเจาะเข้าระบบได้แล้ว พวกเขาลบ Log ทิ้งเพื่อทำลายหลักฐาน แต่ระบบไม่มีการสำรอง Log หรือป้องกันการลบ ทำให้ไม่สามารถสืบสวนย้อนหลังได้</li>
                    </ul>`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>บันทึกเหตุการณ์ที่สำคัญ:</strong> บันทึก Log ของเหตุการณ์ด้านความปลอดภัยที่สำคัญ เช่น การล็อกอิน (สำเร็จ/ล้มเหลว), การเข้าถึงข้อมูลที่ละเอียดอ่อน, การเปลี่ยนแปลงสิทธิ์, หรือ Input Validation Failures</li>
                        <li><strong>กำหนดรูปแบบ Log ที่เป็นมาตรฐาน:</strong> เพื่อให้ง่ายต่อการประมวลผลโดยเครื่องมือวิเคราะห์ Log อัตโนมัติ (เช่น SIEM)</li>
                        <li><strong>ปกป้อง Log:</strong> ตรวจสอบให้แน่ใจว่า Log ไม่สามารถถูกแก้ไขหรือลบได้โดยผู้ที่ไม่ได้รับอนุญาต และมีการสำรอง Log ไปยังที่จัดเก็บที่ปลอดภัย</li>
                        <li><strong>สร้างระบบ Monitoring และ Alerting:</strong> ตั้งค่าระบบให้แจ้งเตือนเมื่อมีเหตุการณ์ที่น่าสงสัยเกิดขึ้น เช่น มีการล็อกอินล้มเหลวจาก IP เดิมซ้ำๆ กันจำนวนมาก</li>
                    </ul>`,
                codeExample: `
<span class="comment">// ตัวอย่างการ Logging ที่ดี (ใช้ library เช่น Winston ใน Node.js) ✔️</span>
<span class="keyword">const</span> <span class="variable">logger</span> = <span class="function">require</span>(<span class="string">'./logger'</span>); <span class="comment">// Winston logger instance</span>

<span class="keyword">function</span> <span class="function">loginUser</span>(<span class="variable">username, password</span>) {
  <span class="keyword">const</span> <span class="variable">user</span> = <span class="variable">authenticate</span>(<span class="variable">username, password</span>);

  <span class="keyword">if</span> (<span class="variable">user</span>) {
    <span class="comment">// Log การล็อกอินสำเร็จ</span>
    <span class="variable">logger</span>.<span class="function">info</span>({
      <span class="variable">event</span>: <span class="string">'LOGIN_SUCCESS'</span>,
      <span class="variable">username</span>: <span class="variable">username</span>,
      <span class="variable">ipAddress</span>: <span class="variable">req</span>.<span class="variable">ip</span>
    });
    <span class="comment">// ...</span>
  } <span class="keyword">else</span> {
    <span class="comment">// Log การล็อกอินล้มเหลว</span>
    <span class="variable">logger</span>.<span class="function">warn</span>({
      <span class="variable">event</span>: <span class="string">'LOGIN_FAILURE'</span>,
      <span class="variable">username</span>: <span class="variable">username</span>,
      <span class="variable">ipAddress</span>: <span class="variable">req</span>.<span class="variable">ip</span>
    });
    <span class="comment">// ...</span>
  }
}`
            },
            {
                id: 'A10',
                title: 'Server-Side Request Forgery (SSRF)',
                subtitle: 'การปลอมแปลงคำร้องขอจากฝั่งเซิร์ฟเวอร์',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path><path d="M12 10v6"></path><path d="m15 13-3-3-3 3"></path></svg>`,
                description: 'เป็นช่องโหว่ที่ผู้โจมตีสามารถหลอกให้เซิร์ฟเวอร์ของแอปพลิเคชันเป้าหมายส่ง Request ไปยังปลายทางที่ผู้โจมตีต้องการได้ ทำให้ผู้โจมตีสามารถใช้เซิร์ฟเวอร์นั้นเป็นตัวกลาง (Proxy) ในการสแกนเครือข่ายภายใน, เข้าถึงเซอร์วิสภายในที่ไม่ควรเข้าถึงได้จากภายนอก, หรือโจมตีระบบอื่นได้',
                attackExample: `
                    แอปพลิเคชันมีฟีเจอร์สำหรับแสดงรูปภาพจาก URL ที่ผู้ใช้ระบุ โดยส่ง URL ผ่านพารามิเตอร์ เช่น:<br>
                    <code class="text-yellow-300">/loadImage?url=http://example.com/image.jpg</code><br>
                    เซิร์ฟเวอร์จะทำการ fetch ข้อมูลจาก URL นั้นแล้วแสดงผล<br>
                    ผู้โจมตีเปลี่ยน URL เป็น URL ของระบบภายในที่ปกติจะเข้าถึงไม่ได้จากอินเทอร์เน็ต:<br>
                    <code class="text-yellow-300">/loadImage?url=http://192.168.1.1/admin/config</code><br>
                    หรือ<br>
                    <code class="text-yellow-300">/loadImage?url=file:///etc/passwd</code><br>
                    หากไม่มีการป้องกัน เซิร์ฟเวอร์จะส่ง Request ไปยังเป้าหมายเหล่านั้นและอาจจะแสดงผลข้อมูลที่ละเอียดอ่อนกลับมาให้ผู้โจมตีเห็น`,
                prevention: `
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>ใช้ Allow List:</strong> กำหนดรายการของ Domain, IP Address, หรือ Protocol ที่อนุญาตให้เซิร์ฟเวอร์เชื่อมต่อได้เท่านั้น (เช่น <code class="text-yellow-300">api.trusted.com</code>) และปฏิเสธการเชื่อมต่ออื่นๆ ทั้งหมด</li>
                        <li><strong>แยกส่วนการจัดการ Resource:</strong> สร้าง Network Segment แยกสำหรับเซอร์วิสที่ต้องมีการเชื่อมต่อออกไปยังภายนอก เพื่อจำกัดผลกระทบหากเกิด SSRF</li>
                        <li><strong>ตรวจสอบและกรอง Input:</strong> อย่าเชื่อถือ URL ที่ผู้ใช้ส่งมาโดยตรง ตรวจสอบให้แน่ใจว่าเป็น URL ที่ถูกต้องและชี้ไปยังปลายทางที่คาดหวัง</li>
                        <li><strong>ปิดการใช้งาน URL Schema ที่ไม่จำเป็น:</strong> เช่น <code class="text-yellow-300">file://</code>, <code class="text-yellow-300">ftp://</code>, <code class="text-yellow-300">gopher://</code></li>
                    </ul>`,
                codeExample: `
<span class="comment">// ตัวอย่างโค้ด (Python/requests) ที่ไม่ดี ❌</span>
<span class="keyword">@app.route</span>(<span class="string">'/fetch'</span>)
<span class="keyword">def</span> <span class="function">fetch_url</span>():
    <span class="variable">url</span> = <span class="variable">request</span>.<span class="variable">args</span>.<span class="function">get</span>(<span class="string">'url'</span>)
    <span class="comment"># ดึงข้อมูลจาก URL ที่ผู้ใช้ส่งมาโดยตรง</span>
    <span class="variable">response</span> = <span class="variable">requests</span>.<span class="function">get</span>(<span class="variable">url</span>)
    <span class="keyword">return</span> <span class="variable">response</span>.<span class="variable">text</span>

<span class="comment">// ตัวอย่างโค้ดที่ดี (ใช้ Allow List) ✔️</span>
<span class="variable">ALLOWED_DOMAINS</span> = [<span class="string">'api.images.com'</span>, <span class="string">'cdn.assets.com'</span>]

<span class="keyword">@app.route</span>(<span class="string">'/fetch'</span>)
<span class="keyword">def</span> <span class="function">safe_fetch_url</span>():
    <span class="variable">url_str</span> = <span class="variable">request</span>.<span class="variable">args</span>.<span class="function">get</span>(<span class="string">'url'</span>)
    <span class="keyword">try</span>:
        <span class="variable">parsed_url</span> = <span class="variable">urlparse</span>(<span class="variable">url_str</span>)
        <span class="comment"># ตรวจสอบว่า hostname อยู่ใน allow list หรือไม่</span>
        <span class="keyword">if</span> <span class="variable">parsed_url</span>.<span class="variable">hostname</span> <span class="keyword">not in</span> <span class="variable">ALLOWED_DOMAINS</span>:
            <span class="keyword">return</span> <span class="string">"Error: Hostname not allowed"</span>, <span class="string">400</span>
        
        <span class="variable">response</span> = <span class="variable">requests</span>.<span class="function">get</span>(<span class="variable">url_str</span>, <span class="variable">timeout</span>=<span class="string">3</span>)
        <span class="keyword">return</span> <span class="variable">response</span>.<span class="variable">text</span>
    <span class="keyword">except</span> <span class="variable">Exception</span> <span class="keyword">as</span> <span class="variable">e</span>:
        <span class="keyword">return</span> <span class="string">"An error occurred"</span>, <span class="string">500</span>`
            }
        ];

        const cardContainer = document.querySelector('.grid');
        const modalContainer = document.getElementById('modal-container');

        // Function to create item cards
        function createCards() {
            owaspData.forEach(item => {
                const card = `
                    <div class="card bg-slate-800 p-6 rounded-lg shadow-lg cursor-pointer hover:bg-slate-700 hover:scale-105 transition-all duration-200 flex flex-col items-center text-center" data-modal-target="modal-${item.id}">
                        <div class="text-blue-400 mb-3">${item.icon}</div>
                        <h3 class="text-xl font-bold text-white">${item.id}:2021</h3>
                        <p class="text-slate-300">${item.title}</p>
                        <p class="text-sm text-slate-400 mt-1">${item.subtitle}</p>
                    </div>
                `;
                cardContainer.innerHTML += card;
            });
        }

        // Function to create modals
        function createModals() {
            owaspData.forEach(item => {
                const modal = `
                    <div id="modal-${item.id}" class="modal fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-75 opacity-0 pointer-events-none hidden">
                        <div class="modal-content bg-slate-800 rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto transform scale-95">
                            <div class="sticky top-0 bg-slate-800 px-6 py-4 border-b border-slate-700 flex justify-between items-center z-10">
                                <div>
                                    <h2 class="text-2xl font-bold text-white">${item.id}:2021 - ${item.title}</h2>
                                    <p class="text-slate-400">${item.subtitle}</p>
                                </div>
                                <button class="close-modal text-slate-400 hover:text-white text-3xl">&times;</button>
                            </div>
                            <div class="p-6 space-y-6">
                                <div>
                                    <h4 class="text-lg font-semibold text-blue-300 mb-2">คำอธิบาย (Description)</h4>
                                    <p class="text-slate-300">${item.description}</p>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold text-yellow-300 mb-2">ตัวอย่างการโจมตี (Attack Example)</h4>
                                    <div class="bg-slate-900 p-4 rounded-md text-slate-300">${item.attackExample}</div>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold text-green-300 mb-2">แนวทางการป้องกัน (Prevention)</h4>
                                    <div class="text-slate-300">${item.prevention}</div>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold text-indigo-300 mb-2">ตัวอย่างโค้ด (Code Example)</h4>
                                    <div class="code-block">${item.codeExample}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                modalContainer.innerHTML += modal;
            });
        }

        // Initialize cards and modals
        createCards();
        createModals();

        // Event Listeners
        document.querySelectorAll('.card').forEach(card => {
            card.addEventListener('click', () => {
                const modalId = card.getAttribute('data-modal-target');
                const modal = document.getElementById(modalId);
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0', 'pointer-events-none');
                    modal.querySelector('.modal-content').classList.remove('scale-95');
                }, 10);
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            });
        });

        function closeModal(modal) {
            modal.querySelector('.modal-content').classList.add('scale-95');
            modal.classList.add('opacity-0', 'pointer-events-none');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 250);
            document.body.style.overflow = 'auto';
        }

        document.querySelectorAll('.modal').forEach(modal => {
            // Close on button click
            modal.querySelector('.close-modal').addEventListener('click', () => {
                closeModal(modal);
            });

            // Close on clicking the backdrop
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal(modal);
                }
            });
        });

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal:not(.hidden)').forEach(closeModal);
            }
        });

    </script>

</body>

</html>