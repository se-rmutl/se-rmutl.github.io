<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบทดสอบ | ENGSE214 ความมั่นคงปลอดภัยทางไซเบอร์เบื้องต้น</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #111827; /* bg-gray-900 */
        }
        .answer-btn {
            transition: all 0.2s ease-in-out;
        }
        .answer-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            background-color: #4b5563; /* hover:bg-gray-600 */
        }
        .answer-btn.selected {
            background-color: #3b82f6; /* bg-blue-600 */
            border-color: #2563eb; /* border-blue-700 */
            color: white;
        }
        .answer-btn.correct {
            background-color: #16a34a; /* bg-green-600 */
            color: white;
            border-color: #15803d;
        }
        .answer-btn.incorrect {
            background-color: #dc2626; /* bg-red-600 */
            color: white;
            border-color: #b91c1c;
        }
        .btn-icon {
            width: 1.25rem;
            height: 1.25rem;
            margin-right: 0.5rem;
        }
        #explanation-box {
            transition: opacity 0.5s ease-in-out;
        }
    </style>
</head>
<body class="text-gray-200 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl mx-auto">

        <!-- Start Screen -->
        <div id="start-screen" class="bg-gray-800 p-8 rounded-2xl shadow-2xl text-center transition-opacity duration-500">
            <div class="flex justify-center items-center gap-4 mb-4">
                 <svg class="w-10 h-10 text-blue-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.286zm0 13.036h.008v.008h-.008v-.008z" />
                </svg>
                <h1 class="text-3xl md:text-4xl font-bold text-blue-400">แบบทดสอบ Pre-Test / Post-Test</h1>
            </div>
            <p class="text-lg md:text-xl text-gray-300 mb-1">ENGSE214: ความมั่นคงปลอดภัยทางไซเบอร์เบื้องต้น</p>
            <p class="text-md text-gray-400 mb-8">สัปดาห์ที่ 3: ช่องโหว่และการประเมินความเสี่ยง</p>
            
            <form id="student-form" class="space-y-6">
                <div>
                    <label for="student-id" class="block text-left text-gray-300 mb-2 font-medium">รหัสนักศึกษา</label>
                    <input type="text" id="student-id" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="เช่น 66xxxxxxxx" required>
                </div>
                <div>
                    <label for="student-name" class="block text-left text-gray-300 mb-2 font-medium">ชื่อ - นามสกุล</label>
                    <input type="text" id="student-name" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="เช่น สมชาย ใจดี" required>
                </div>
                <button type="submit" id="start-btn" class="w-full flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 text-lg shadow-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.82m5.84-2.56a12.025 12.025 0 01-4.132 4.032m-4.132-4.032L6.91 9.51m1.36-2.56a12.025 12.025 0 014.132-4.032m4.132 4.032L17.09 9.51m-1.36 2.56a6 6 0 01-5.84-7.38v4.82" />
                    </svg>
                    เริ่มต้นทำแบบทดสอบ
                </button>
            </form>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden bg-gray-800 p-6 md:p-8 rounded-2xl shadow-2xl transition-opacity duration-500">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-400">ความคืบหน้า</span>
                    <span id="question-counter" class="text-sm font-bold text-blue-400">ข้อ 1 / 30</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out"></div>
                </div>
            </div>

            <div class="mb-6">
                <h2 id="question-text" class="text-xl md:text-2xl font-bold mb-4" style="min-height: 6rem;"></h2>
                <img id="question-image" class="hidden max-w-full md:max-w-md mx-auto rounded-lg my-4 shadow-lg" alt="รูปภาพประกอบคำถาม">
            </div>

            <div id="answer-buttons" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>

            <!-- Explanation Box (New) -->
            <div id="explanation-box" class="hidden mt-6"></div>

            <div class="mt-8 flex justify-end">
                <button id="next-btn" class="flex items-center justify-center bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-lg transition duration-300">
                    <span id="next-btn-text">ข้อถัดไป</span>
                    <svg class="w-5 h-5 ml-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="hidden bg-gray-800 p-6 md:p-8 rounded-2xl shadow-2xl text-center transition-opacity duration-500">
            <h2 class="text-3xl font-bold text-blue-400 mb-2">สรุปผลการทดสอบ</h2>
            <p id="result-student-info" class="text-lg text-gray-300 mb-4"></p>
            
            <div class="bg-gray-700 rounded-xl p-6 my-6">
                <p class="text-lg text-gray-300">คะแนนของคุณคือ</p>
                <p id="score-text" class="text-6xl font-bold text-white my-2">25 / 30</p>
                <p id="score-percentage" class="text-xl text-blue-400"></p>
            </div>

            <div id="summary-container" class="space-y-4 text-left mt-8"></div>

            <button id="retry-btn" class="mt-8 w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition duration-300 text-lg shadow-lg">
                ทำแบบทดสอบอีกครั้ง
            </button>
        </div>
    </div>

<script>
    // --- DATA ---
    const quizData = [
        {
            question: "ข้อใดคือคำจำกัดความที่ถูกต้องที่สุดของ 'Vulnerability' ในบริบทของความมั่นคงปลอดภัยทางไซเบอร์",
            answers: [
                { text: "ภัยคุกคามที่อาจเกิดขึ้นกับระบบสารสนเทศ", correct: false },
                { text: "จุดอ่อนในสินทรัพย์หรือมาตรการป้องกันที่อาจถูกภัยคุกคามใช้ประโยชน์เพื่อสร้างความเสียหาย", correct: true },
                { text: "ซอฟต์แวร์หรือฮาร์ดแวร์ที่ใช้ในการป้องกันการโจมตีทางไซเบอร์", correct: false },
                { text: "ผลกระทบทางลบที่เกิดขึ้นกับองค์กรเมื่อระบบถูกโจมตีสำเร็จ", correct: false }
            ],
            rationale: "Vulnerability คือจุดอ่อน (Weakness) ที่มีอยู่ในระบบ ซึ่งเปิดโอกาสให้ภัยคุกคาม (Threat) เข้ามาโจมตีและสร้างความเสียหาย (Impact) ได้"
        },
        {
            question: "ช่องโหว่ประเภทใดที่เกี่ยวข้องกับข้อผิดพลาดในการเขียนโค้ดของซอฟต์แวร์โดยตรง",
            answers: [
                { text: "Configuration Vulnerability", correct: false },
                { text: "Design Vulnerability", correct: false },
                { text: "Implementation Vulnerability", correct: true },
                { text: "Process Vulnerability", correct: false }
            ],
            rationale: "Implementation Vulnerability (หรือ Coding Vulnerability) เกิดจากข้อผิดพลาดในขั้นตอนการเขียนโปรแกรม เช่น Buffer Overflow, SQL Injection, หรือ Cross-Site Scripting (XSS)"
        },
        {
            question: "CVE ย่อมาจากอะไร และมีหน้าที่หลักคืออะไร",
            answers: [
                { text: "Common Vulnerability Enumeration, มีหน้าที่จัดลำดับความรุนแรงของช่องโหว่", correct: false },
                { text: "Common Vulnerabilities and Exposures, มีหน้าที่ให้รหัสอ้างอิงที่ไม่ซ้ำกันสำหรับช่องโหว่แต่ละรายการ", correct: true },
                { text: "Critical Vulnerability Entry, มีหน้าที่แจ้งเตือนเมื่อพบช่องโหว่ร้ายแรง", correct: false },
                { text: "Cyber Vulnerability Ecosystem, มีหน้าที่สร้างชุมชนสำหรับนักวิจัยความปลอดภัย", correct: false }
            ],
            rationale: "CVE (Common Vulnerabilities and Exposures) คือพจนานุกรมของช่องโหว่ที่เป็นที่รู้จักในสาธารณะ โดยแต่ละช่องโหว่จะได้รับรหัส CVE ID ที่ไม่ซ้ำกัน (เช่น CVE-2021-44228) เพื่อเป็นมาตรฐานในการอ้างอิง"
        },
        {
            question: "ข้อใดคือองค์ประกอบหลักของสมการความเสี่ยง (Risk)",
            answers: [
                { text: "ภัยคุกคาม (Threat) x ผลกระทบ (Impact)", correct: false },
                { text: "สินทรัพย์ (Asset) x ช่องโหว่ (Vulnerability)", correct: false },
                { text: "ภัยคุกคาม (Threat) x ช่องโหว่ (Vulnerability) x ผลกระทบ (Impact)", correct: true },
                { text: "ช่องโหว่ (Vulnerability) x มาตรการป้องกัน (Control)", correct: false }
            ],
            rationale: "ความเสี่ยง (Risk) คือโอกาสที่ภัยคุกคาม (Threat) จะใช้ประโยชน์จากช่องโหว่ (Vulnerability) ของสินทรัพย์ (Asset) และก่อให้เกิดผลกระทบหรือความเสียหาย (Impact) ดังนั้น Risk = Threat x Vulnerability x Impact"
        },
        {
            question: "ขั้นตอนแรกสุดในกระบวนการ Risk Management คืออะไร",
            answers: [
                { text: "Risk Mitigation (การลดความเสี่ยง)", correct: false },
                { text: "Risk Assessment (การประเมินความเสี่ยง)", correct: true },
                { text: "Risk Monitoring (การติดตามความเสี่ยง)", correct: false },
                { text: "Risk Acceptance (การยอมรับความเสี่ยง)", correct: false }
            ],
            rationale: "กระบวนการจัดการความเสี่ยงเริ่มต้นด้วยการประเมินความเสี่ยง (Risk Assessment) ซึ่งประกอบด้วยการระบุ (Identify), วิเคราะห์ (Analyze), และประเมินค่า (Evaluate) ความเสี่ยง เพื่อให้เข้าใจภาพรวมทั้งหมดก่อนตัดสินใจจัดการ"
        },
        {
            question: "CVSS ย่อมาจากอะไร",
            answers: [
                { text: "Cyber Vulnerability Scoring Software", correct: false },
                { text: "Critical Vulnerability Scoring Standard", correct: false },
                { text: "Common Vulnerability Scoring System", correct: true },
                { text: "Common Vulnerability Security Service", correct: false }
            ],
            rationale: "CVSS (Common Vulnerability Scoring System) เป็นมาตรฐานเปิดที่ใช้ในการประเมินความรุนแรงของช่องโหว่ทางไซเบอร์และให้คะแนนเป็นตัวเลขเพื่อช่วยในการจัดลำดับความสำคัญ"
        },
        {
            question: "ใน CVSS v3.1, Metric Group ใดที่ประเมินคุณลักษณะของช่องโหว่ที่ไม่เปลี่ยนแปลงตามเวลาและสภาพแวดล้อม",
            imageUrl: "https://www.riskbasedsecurity.com/wp-content/uploads/2020/07/CVSSv3.1-Metric-Groups-768x413.png",
            answers: [
                { text: "Base Metric Group", correct: true },
                { text: "Temporal Metric Group", correct: false },
                { text: "Environmental Metric Group", correct: false },
                { text: "Supplemental Metric Group", correct: false }
            ],
            rationale: "Base Metric Group ประเมินคุณลักษณะโดยธรรมชาติ (Intrinsic) ของช่องโหว่ ซึ่งเป็นค่าคงที่ เช่น Attack Vector (AV), Attack Complexity (AC) และผลกระทบต่อ Confidentiality, Integrity, Availability"
        },
        {
            question: "การจัดการความเสี่ยงแบบ 'Risk Acceptance' เหมาะสมกับสถานการณ์ใดมากที่สุด",
            answers: [
                { text: "เมื่อความเสี่ยงมีผลกระทบสูงมากและมีโอกาสเกิดสูง", correct: false },
                { text: "เมื่อต้นทุนในการแก้ไขหรือลดความเสี่ยงสูงกว่าความเสียหายที่อาจเกิดขึ้นอย่างมีนัยสำคัญ", correct: true },
                { text: "เมื่อไม่มีเทคโนโลยีใดสามารถลดความเสี่ยงนั้นได้", correct: false },
                { text: "เมื่อความเสี่ยงนั้นเกี่ยวข้องกับข้อมูลที่เป็นความลับสูงสุดขององค์กร", correct: false }
            ],
            rationale: "การยอมรับความเสี่ยง (Risk Acceptance) เป็นการตัดสินใจเชิงกลยุทธ์ที่องค์กรยอมรับผลที่อาจเกิดขึ้นจากความเสี่ยงนั้นๆ โดยมักทำเมื่อค่าใช้จ่ายในการป้องกัน (Cost of Control) ไม่คุ้มกับความเสียหายที่อาจเกิดขึ้น (Potential Loss)"
        },
        {
            question: "รหัส CVE ในรูปแบบ 'CVE-YYYY-NNNNN' ส่วน 'YYYY' หมายถึงอะไร",
            answers: [
                { text: "ปีที่ช่องโหว่ถูกแก้ไข", correct: false },
                { text: "เวอร์ชันของ CVE", correct: false },
                { text: "ปีที่ช่องโหว่ถูกรายงานหรือรหัสถูกสงวนไว้", correct: true },
                { text: "ระดับความรุนแรงของช่องโหว่", correct: false }
            ],
            rationale: "'YYYY' คือปีที่รหัส CVE ถูกกำหนดหรือปีที่ช่องโหว่ถูกเปิดเผยต่อสาธารณะ ส่วน 'NNNNN' คือหมายเลขลำดับที่ถูกกำหนดในปีนั้นๆ"
        },
        {
            question: "ข้อใด ไม่ใช่ ประเภทของช่องโหว่ (Vulnerability) ตามหมวดหมู่ทั่วไป",
            answers: [
                { text: "Hardware Vulnerability", correct: false },
                { text: "Software Vulnerability", correct: false },
                { text: "Network Vulnerability", correct: false },
                { text: "Data Breach Vulnerability", correct: true }
            ],
            rationale: "Data Breach (การละเมิดข้อมูล) คือผลลัพธ์หรือเหตุการณ์ (Event) ที่เกิดจากการใช้ประโยชน์จากช่องโหว่ ไม่ใช่ประเภทของช่องโหว่โดยตรง ช่องโหว่คือ 'สาเหตุ' ส่วน Data Breach คือ 'ผลลัพธ์'"
        },
        {
            question: "ใน CVSS, เมตริก 'Attack Vector (AV)' ประเมินอะไร",
            answers: [
                { text: "ความซับซ้อนของวิธีการโจมตี", correct: false },
                { text: "ระดับสิทธิ์ที่ผู้โจมตีต้องมีก่อนการโจมตี", correct: false },
                { text: "บริบทที่ผู้โจมตีสามารถใช้ประโยชน์จากช่องโหว่ได้ (เช่น Network, Adjacent, Local, Physical)", correct: true },
                { text: "การมีปฏิสัมพันธ์กับผู้ใช้งานที่จำเป็นสำหรับการโจมตี", correct: false }
            ],
            rationale: "Attack Vector (AV) ระบุถึงเส้นทางที่ใช้ในการโจมตี: Network (ผ่านอินเทอร์เน็ต), Adjacent (เครือข่ายท้องถิ่น), Local (ต้องเข้าถึงเครื่องได้), Physical (ต้องสัมผัสอุปกรณ์)"
        },
        {
            question: "การซื้อประกันภัยไซเบอร์ (Cyber Insurance) เป็นตัวอย่างของการจัดการความเสี่ยงแบบใด",
            answers: [
                { text: "Risk Avoidance (การหลีกเลี่ยงความเสี่ยง)", correct: false },
                { text: "Risk Mitigation (การลดความเสี่ยง)", correct: false },
                { text: "Risk Transfer (การถ่ายโอนความเสี่ยง)", correct: true },
                { text: "Risk Acceptance (การยอมรับความเสี่ยง)", correct: false }
            ],
            rationale: "การถ่ายโอนความเสี่ยง (Risk Transfer) คือการย้ายความรับผิดชอบทางการเงินของความเสี่ยงไปให้บุคคลที่สาม ซึ่งการซื้อประกันเป็นตัวอย่างที่ชัดเจนที่สุด"
        },
        {
            question: "Zero-day Vulnerability หมายถึงอะไร",
            answers: [
                { text: "ช่องโหว่ที่ไม่รุนแรงและมีคะแนน CVSS เป็นศูนย์", correct: false },
                { text: "ช่องโหว่ที่ถูกค้นพบและเปิดเผยในวันเดียวกัน", correct: false },
                { text: "ช่องโหว่ที่ผู้ผลิตซอฟต์แวร์ยังไม่รู้จัก และยังไม่มีแพตช์สำหรับแก้ไข", correct: true },
                { text: "ช่องโหว่ที่สามารถถูกโจมตีได้โดยไม่ต้องใช้ทักษะใดๆ", correct: false }
            ],
            rationale: "เรียกว่า 'Zero-day' เพราะผู้พัฒนาซอฟต์แวร์มีเวลา '0 วัน' ในการเตรียมตัวรับมือ เนื่องจากแฮกเกอร์ได้ค้นพบและอาจเริ่มใช้โจมตีก่อนที่ผู้พัฒนาจะรับรู้และมีแพตช์แก้ไขออกมา"
        },
        {
            question: "Qualitative Risk Analysis (การวิเคราะห์ความเสี่ยงเชิงคุณภาพ) มีลักษณะอย่างไร",
            answers: [
                { text: "ใช้การคำนวณทางการเงินที่ซับซ้อนเพื่อระบุมูลค่าความเสียหายเป็นตัวเงิน (ALE)", correct: false },
                { text: "จัดลำดับความสำคัญของความเสี่ยงโดยใช้มาตราส่วน เช่น 'สูง, กลาง, ต่ำ'", correct: true },
                { text: "ต้องใช้ข้อมูลทางสถิติที่แม่นยำเกี่ยวกับความถี่ในการเกิดเหตุการณ์", correct: false },
                { text: "ให้ผลลัพธ์เป็นตัวเลขคะแนน CVSS ที่ชัดเจน", correct: false }
            ],
            rationale: "การวิเคราะห์เชิงคุณภาพ (Qualitative) ใช้การประเมินจากประสบการณ์และความคิดเห็นของผู้เชี่ยวชาญเพื่อจัดลำดับความเสี่ยงด้วยมาตราส่วนที่ไม่ใช่ตัวเลข เช่น สูง-กลาง-ต่ำ หรือใช้สี (แดง-เหลือง-เขียว) เพื่อให้เข้าใจง่ายและรวดเร็ว"
        },
        {
            question: "ข้อใดคือเป้าหมายหลักของ Risk Assessment",
            answers: [
                { text: "เพื่อกำจัดความเสี่ยงทั้งหมดให้หมดไปจากองค์กร", correct: false },
                { text: "เพื่อระบุและจัดลำดับความสำคัญของความเสี่ยงเพื่อให้สามารถตัดสินใจจัดการได้อย่างเหมาะสม", correct: true },
                { text: "เพื่อซื้อเทคโนโลยีความปลอดภัยล่าสุดทั้งหมดที่มีในตลาด", correct: false },
                { text: "เพื่อสร้างรายการช่องโหว่ (CVE) ทั้งหมดที่มีอยู่ในระบบ", correct: false }
            ],
            rationale: "เป้าหมายหลักคือการให้ข้อมูลแก่ผู้บริหารเพื่อใช้ในการตัดสินใจ (Decision Making) โดยการชี้ให้เห็นว่าความเสี่ยงใดที่สำคัญที่สุดและต้องการการจัดการอย่างเร่งด่วน เพื่อให้สามารถจัดสรรทรัพยากรได้อย่างคุ้มค่าและมีประสิทธิภาพ"
        },
        {
            question: "ใน CVSS, เมตริก 'Scope (S)' มีความหมายว่าอย่างไร",
            answers: [
                { text: "ขอบเขตของผลกระทบต่อข้อมูล (Confidentiality, Integrity, Availability)", correct: false },
                { text: "ช่องโหว่สามารถส่งผลกระทบต่อส่วนประกอบอื่นนอกเหนือจากส่วนประกอบที่มีช่องโหว่หรือไม่", correct: true },
                { text: "ขอบเขตของเครือข่ายที่สามารถทำการโจมตีได้", correct: false },
                { text: "ช่องโหว่นี้เป็นที่รู้จักในขอบเขตสาธารณะหรือไม่", correct: false }
            ],
            rationale: "ถ้าการโจมตีช่องโหว่ในคอมโพเนนต์หนึ่ง (เช่น web browser) สามารถส่งผลกระทบต่อคอมโพเนนต์อื่นที่มีขอบเขตความปลอดภัยต่างกันได้ (เช่น operating system) จะถือว่า Scope มีการเปลี่ยนแปลง (Changed) ซึ่งจะทำให้คะแนนสูงขึ้น"
        },
        {
            question: "การติดตั้ง Patch อุดช่องโหว่ที่ผู้ผลิตปล่อยออกมา เป็นตัวอย่างของการจัดการความเสี่ยงแบบใด",
            answers: [
                { text: "Risk Avoidance (การหลีกเลี่ยงความเสี่ยง)", correct: false },
                { text: "Risk Mitigation (การลดความเสี่ยง)", correct: true },
                { text: "Risk Transfer (การถ่ายโอนความเสี่ยง)", correct: false },
                { text: "Risk Acceptance (การยอมรับความเสี่ยง)", correct: false }
            ],
            rationale: "การลดความเสี่ยง (Risk Mitigation) หรือที่เรียกว่า Risk Reduction คือการใช้มาตรการควบคุม (Security Control) เพื่อลดโอกาสเกิด (Likelihood) หรือลดผลกระทบ (Impact) ของความเสี่ยง ซึ่งการติดตั้งแพตช์ก็คือหนึ่งในมาตรการควบคุมนั้น"
        },
        {
            question: "'False Positive' ในบริบทของการสแกนช่องโหว่หมายถึงอะไร",
            answers: [
                { text: "เครื่องมือสแกนไม่สามารถตรวจพบช่องโหว่ที่มีอยู่จริงได้", correct: false },
                { text: "เครื่องมือสแกนรายงานว่ามีช่องโหว่ แต่ในความเป็นจริงแล้วไม่มี", correct: true },
                { text: "เครื่องมือสแกนตรวจพบช่องโหว่และรายงานได้อย่างถูกต้อง", correct: false },
                { text: "เครื่องมือสแกนไม่พบช่องโหว่และในระบบก็ไม่มีช่องโหว่นั้นจริงๆ", correct: false }
            ],
            rationale: "False Positive คือการแจ้งเตือนที่ผิดพลาด (False Alarm) ซึ่งอาจทำให้ทีมความปลอดภัยเสียเวลาในการตรวจสอบสิ่งที่ไม่มีอยู่จริง ในทางตรงกันข้าม 'False Negative' คือการที่เครื่องมือพลาดการตรวจจับช่องโหว่ที่มีอยู่จริง ซึ่งอันตรายกว่ามาก"
        },
        {
            question: "ข้อใดคือความแตกต่างที่สำคัญระหว่าง Vulnerability Assessment และ Penetration Testing",
            answers: [
                { text: "Vulnerability Assessment ทำโดยแฮกเกอร์ ในขณะที่ Penetration Testing ทำโดยผู้ดูแลระบบ", correct: false },
                { text: "Vulnerability Assessment ให้รายการช่องโหว่ ในขณะที่ Penetration Testing พยายามใช้ประโยชน์จากช่องโหว่เพื่อแสดงความเสี่ยงจริง", correct: true },
                { text: "Vulnerability Assessment ใช้เครื่องมืออัตโนมัติเท่านั้น ในขณะที่ Penetration Testing ใช้แต่มนุษย์", correct: false },
                { text: "ไม่มีความแตกต่าง ทั้งสองคำเป็นคำที่ใช้แทนกันได้", correct: false }
            ],
            rationale: "Vulnerability Assessment (VA) เปรียบเหมือนการ 'สำรวจ' เพื่อหาว่ามีประตูหน้าต่างบานไหนที่อาจจะไม่ได้ล็อค ส่วน Penetration Testing (Pentest) คือการ 'ลองงัดแงะ' ประตูหน้าต่างเหล่านั้นเพื่อพิสูจน์ว่าสามารถบุกรุกเข้าไปได้จริงหรือไม่"
        },
        {
            question: "คะแนน CVSS Base Score มีช่วงตั้งแต่เท่าไหร่ถึงเท่าไหร่",
            answers: [
                { text: "1 ถึง 10", correct: false },
                { text: "0.0 ถึง 10.0", correct: true },
                { text: "0 ถึง 100", correct: false },
                { text: "ต่ำ, กลาง, สูง, วิกฤต", correct: false }
            ],
            rationale: "คะแนน CVSS Base Score เป็นตัวเลขทศนิยมหนึ่งตำแหน่งในช่วง 0.0 ถึง 10.0 ซึ่งจะถูกแบ่งเป็นระดับความรุนแรงต่างๆ: None (0.0), Low (0.1-3.9), Medium (4.0-6.9), High (7.0-8.9), และ Critical (9.0-10.0)"
        },
        {
            question: "ทำไมองค์กรจึงควรทำ Risk Management อย่างต่อเนื่อง",
            answers: [
                { text: "เพื่อปฏิบัติตามกฎหมายเพียงอย่างเดียว", correct: false },
                { text: "เพราะภัยคุกคาม, ช่องโหว่, และสภาพแวดล้อมทางธุรกิจมีการเปลี่ยนแปลงตลอดเวลา", correct: true },
                { text: "เพื่อลดค่าใช้จ่ายในการซื้อประกันภัยไซเบอร์", correct: false },
                { text: "เพราะผู้ตรวจสอบ (Auditor) กำหนดให้ทำทุกปี", correct: false }
            ],
            rationale: "ภูมิทัศน์ของภัยคุกคาม (Threat Landscape) เปลี่ยนแปลงเร็วมาก มีช่องโหว่ใหม่ๆ เกิดขึ้นทุกวัน และธุรกิจก็มีการนำเทคโนโลยีใหม่ๆ มาใช้เสมอ การจัดการความเสี่ยงจึงต้องเป็นกระบวนการต่อเนื่อง (Continuous Process) ไม่ใช่โครงการที่ทำครั้งเดียวจบ"
        },
        {
            question: "ใน CVSS v3.1, ถ้าการโจมตีช่องโหว่หนึ่งส่งผลกระทบต่อความพร้อมใช้งาน (Availability) อย่างสมบูรณ์ ทำให้ระบบหยุดทำงานโดยสิ้นเชิง จะให้ค่าเมตริก Availability (A) เป็นอะไร",
            answers: [
                { text: "None (N)", correct: false },
                { text: "Low (L)", correct: false },
                { text: "High (H)", correct: true },
                { text: "Critical (C)", correct: false }
            ],
            rationale: "ค่า High (H) สำหรับผลกระทบ (C, I, A) หมายถึงการสูญเสียคุณสมบัตินั้นๆ โดยสิ้นเชิง เช่น ข้อมูลทั้งหมดรั่วไหล (C=High), ข้อมูลทั้งหมดถูกแก้ไขได้ (I=High), หรือระบบหยุดให้บริการโดยสมบูรณ์ (A=High)"
        },
        {
            question: "ข้อใดเป็นตัวอย่างของ 'Design Vulnerability'",
            answers: [
                { text: "การใช้รหัสผ่านที่คาดเดาง่าย เช่น '123456'", correct: false },
                { text: "ระบบยืนยันตัวตนที่อนุญาตให้ผู้ใช้ตั้งคำถามรีเซ็ตรหัสผ่านที่คาดเดาได้ง่าย", correct: true },
                { text: "การไม่ได้ตรวจสอบ Input ของผู้ใช้ ทำให้เกิด SQL Injection", correct: false },
                { text: "การลืมติดตั้งแพตช์ความปลอดภัยล่าสุดบนเซิร์ฟเวอร์", correct: false }
            ],
            rationale: "Design Vulnerability คือข้อบกพร่องที่ฝังอยู่ในสถาปัตยกรรมหรือตรรกะของระบบตั้งแต่แรก การออกแบบให้ใช้คำถามรีเซ็ตรหัสผ่านที่คาดเดาได้ง่าย (เช่น 'สัตว์เลี้ยงตัวแรกชื่ออะไร') ถือเป็นข้อบกพร่องในการออกแบบกระบวนการความปลอดภัย"
        },
        {
            question: "Threat Modeling คือกระบวนการอะไร",
            answers: [
                { text: "การสร้างแบบจำลองภัยคุกคามทางกายภาพ เช่น ไฟไหม้ หรือน้ำท่วม", correct: false },
                { text: "การระบุภัยคุกคามและช่องโหว่ที่อาจเกิดขึ้นอย่างเป็นระบบ และกำหนดมาตรการป้องกันล่วงหน้าในขั้นตอนการออกแบบ", correct: true },
                { text: "การสร้างแบบจำลองการแพร่กระจายของมัลแวร์ในเครือข่าย", correct: false },
                { text: "การจำลองการโจมตีแบบ Phishing เพื่อทดสอบพนักงาน", correct: false }
            ],
            rationale: "Threat Modeling คือกระบวนการเชิงรุก (Proactive) ที่ทำในขั้นตอนการออกแบบซอฟต์แวร์ (SDLC) เพื่อคิดจากมุมมองของแฮกเกอร์ว่า 'ระบบของเราจะถูกโจมตีได้อย่างไรบ้าง' และออกแบบมาตรการป้องกันไว้ตั้งแต่เนิ่นๆ"
        },
        {
            question: "ใน CVSS, เมตริก 'User Interaction (UI)' มีความหมายว่าอย่างไร",
            answers: [
                { text: "ช่องโหว่นี้สามารถโจมตีได้โดยผู้ใช้หลายคนพร้อมกัน", correct: false },
                { text: "การโจมตีต้องอาศัยการกระทำบางอย่างจากผู้ใช้ (ที่ไม่ใช่ผู้โจมตี) จึงจะสำเร็จ", correct: true },
                { text: "ช่องโหว่อยู่ในส่วนติดต่อผู้ใช้ (User Interface) ของโปรแกรม", correct: false },
                { text: "ผู้โจมตีต้องมีปฏิสัมพันธ์กับระบบในฐานะผู้ใช้ที่ได้รับอนุญาต", correct: false }
            ],
            rationale: "UI จะมีค่าเป็น Required (R) หากการโจมตีจะสำเร็จได้ก็ต่อเมื่อผู้ใช้ต้องกระทำการบางอย่าง เช่น การคลิกลิงก์อันตราย หรือการเปิดไฟล์แนบที่ติดมัลแวร์ ถ้าไม่ต้องการการกระทำใดๆ จากผู้ใช้ ค่าจะเป็น None (N)"
        },
        {
            question: "ข้อใดคือเป้าหมายสูงสุดของกระบวนการ Risk Management",
            answers: [
                { text: "เพื่อให้องค์กรปราศจากความเสี่ยงโดยสิ้นเชิง (Zero Risk)", correct: false },
                { text: "เพื่อลดความเสี่ยงให้อยู่ในระดับที่องค์กรยอมรับได้ (Risk Appetite)", correct: true },
                { text: "เพื่อให้ได้คะแนน CVSS เฉลี่ยของทุกระบบต่ำที่สุด", correct: false },
                { text: "เพื่อถ่ายโอนความเสี่ยงทั้งหมดให้กับบริษัทประกัน", correct: false }
            ],
            rationale: "เป้าหมายไม่ใช่การกำจัดความเสี่ยงให้เป็นศูนย์ (ซึ่งเป็นไปไม่ได้) แต่เป็นการจัดการความเสี่ยงให้อยู่ในระดับที่องค์กรยอมรับได้ (Risk Appetite) เพื่อให้องค์กรสามารถดำเนินธุรกิจและบรรลุเป้าหมายได้โดยมีความเสี่ยงที่ควบคุมได้"
        },
        {
            question: "บริษัทพบช่องโหว่บนเว็บเซิร์ฟเวอร์ ผู้โจมตีต้องอยู่ในเครือข่ายเดียวกัน (เช่น Wi-Fi) ถึงจะโจมตีได้ การโจมตีทำได้ง่าย ไม่ต้องอาศัยการกระทำจากผู้ใช้ และจะทำให้ควบคุมเซิร์ฟเวอร์ได้ทั้งหมด ค่า CVSS Attack Vector (AV) ควรเป็นอะไร",
            answers: [
                { text: "Network (N)", correct: false },
                { text: "Adjacent (A)", correct: true },
                { text: "Local (L)", correct: false },
                { text: "Physical (P)", correct: false }
            ],
            rationale: "Adjacent (A) ถูกใช้เมื่อผู้โจมตีต้องอยู่ในเครือข่ายท้องถิ่น (Local Network) เดียวกันกับเป้าหมาย เช่น อยู่ใน broadcast หรือ collision domain เดียวกัน ซึ่งตรงกับสถานการณ์ที่ต้องอยู่ใน Wi-Fi เดียวกัน"
        },
        {
            question: "ความแตกต่างระหว่าง Threat, Vulnerability, และ Risk คืออะไร",
            answers: [
                { text: "ทั้งสามคำมีความหมายเหมือนกันและใช้แทนกันได้", correct: false },
                { text: "Risk คือโอกาสที่ Threat จะใช้ประโยชน์จาก Vulnerability เพื่อสร้าง Impact", correct: true },
                { text: "Vulnerability คือ Risk ที่เกิดจาก Threat", correct: false },
                { text: "Threat คือผลลัพธ์ของ Risk และ Vulnerability", correct: false }
            ],
            rationale: "จำง่ายๆ: แฮกเกอร์ (Threat) ค้นพบประตูที่ไม่ได้ล็อค (Vulnerability) และมีความเป็นไปได้ที่เขาจะเข้าไปขโมยของ (Risk) ซึ่งจะทำให้ของหาย (Impact)"
        },
        {
            question: "องค์กรที่ไม่ทำการประเมินความเสี่ยงเลยจะประสบกับปัญหาใดมากที่สุด",
            answers: [
                { text: "มีค่าใช้จ่ายด้านความปลอดภัยสูงเกินความจำเป็น", correct: false },
                { text: "ไม่สามารถจัดลำดับความสำคัญในการแก้ไขปัญหาและใช้ทรัพยากรได้อย่างไม่มีประสิทธิภาพ", correct: true },
                { text: "ถูกโจมตีโดย Zero-day exploit เท่านั้น", correct: false },
                { text: "มีคะแนน CVSS ที่สูงในทุกระบบ", correct: false }
            ],
            rationale: "หากไม่มีการประเมินความเสี่ยง องค์กรจะเหมือนคนตาบอดคลำทาง ไม่รู้ว่าควรป้องกันอะไรก่อน อาจไปทุ่มทรัพยากรป้องกันความเสี่ยงต่ำๆ แต่ปล่อยให้ความเสี่ยงระดับวิกฤต (Critical Risk) ถูกละเลย"
        },
        {
            question: "ข้อใดคือตัวอย่างของ Quantitative Risk Analysis (การวิเคราะห์ความเสี่ยงเชิงปริมาณ)",
            imageUrl: "https://www.simplilearn.com/ice9/free_resources_article_thumb/quantitative_and_qualitative_risk_analysis.jpg",
            answers: [
                { text: "การระบุว่าความเสี่ยงจากการดาวน์ไทม์ของเซิร์ฟเวอร์อยู่ในระดับ 'สูง'", correct: false },
                { text: "การจัดประชุมเพื่อระดมสมองเกี่ยวกับภัยคุกคามที่อาจเกิดขึ้น", correct: false },
                { text: "การคำนวณว่าหากเซิร์ฟเวอร์อีเมลล่ม จะสร้างความเสียหายทางธุรกิจชั่วโมงละ 50,000 บาท", correct: true },
                { text: "การสร้าง Risk Matrix ที่มีแกนเป็น Likelihood และ Impact", correct: false }
            ],
            rationale: "การวิเคราะห์เชิงปริมาณ (Quantitative) จะพยายามคำนวณความเสี่ยงออกมาเป็นตัวเลขทางการเงินที่จับต้องได้ เช่น Annual Loss Expectancy (ALE) ซึ่งคำนวณจาก SLE x ARO เพื่อให้สามารถตัดสินใจโดยใช้ข้อมูลตัวเลขได้"
        }
    ];

    // --- DOM ELEMENTS ---
    const startScreen = document.getElementById('start-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const resultScreen = document.getElementById('result-screen');
    const studentForm = document.getElementById('student-form');
    const studentIdInput = document.getElementById('student-id');
    const studentNameInput = document.getElementById('student-name');
    const questionText = document.getElementById('question-text');
    const questionImage = document.getElementById('question-image');
    const answerButtons = document.getElementById('answer-buttons');
    const nextBtn = document.getElementById('next-btn');
    const nextBtnText = document.getElementById('next-btn-text');
    const questionCounter = document.getElementById('question-counter');
    const progressBar = document.getElementById('progress-bar');
    const scoreText = document.getElementById('score-text');
    const scorePercentage = document.getElementById('score-percentage');
    const resultStudentInfo = document.getElementById('result-student-info');
    const summaryContainer = document.getElementById('summary-container');
    const retryBtn = document.getElementById('retry-btn');
    const explanationBox = document.getElementById('explanation-box'); // New

    // --- STATE VARIABLES ---
    let shuffledQuestions, currentQuestionIndex;
    let score = 0;
    let userAnswers = [];
    let studentId = '';
    let studentName = '';

    // --- EVENT LISTENERS ---
    studentForm.addEventListener('submit', (e) => {
        e.preventDefault();
        studentId = studentIdInput.value.trim();
        studentName = studentNameInput.value.trim();
        if (studentId && studentName) {
            startQuiz();
        }
    });

    nextBtn.addEventListener('click', () => {
        currentQuestionIndex++;
        if (currentQuestionIndex < shuffledQuestions.length) {
            setNextQuestion();
        } else {
            showResults();
        }
    });

    retryBtn.addEventListener('click', resetQuiz);

    // --- FUNCTIONS ---
    function startQuiz() {
        shuffledQuestions = quizData.sort(() => Math.random() - 0.5);
        currentQuestionIndex = 0;
        score = 0;
        userAnswers = [];
        startScreen.classList.add('hidden');
        resultScreen.classList.add('hidden');
        quizScreen.classList.remove('hidden');
        setNextQuestion();
    }

    function resetQuiz() {
        resultScreen.classList.add('hidden');
        startScreen.classList.remove('hidden');
        studentIdInput.value = '';
        studentNameInput.value = '';
    }

    function setNextQuestion() {
        resetState();
        showQuestion(shuffledQuestions[currentQuestionIndex]);
        updateProgress();
    }

    function updateProgress() {
        const questionNumber = currentQuestionIndex + 1;
        questionCounter.innerText = `ข้อ ${questionNumber} / ${shuffledQuestions.length}`;
        const progressPercentage = (questionNumber / shuffledQuestions.length) * 100;
        progressBar.style.width = `${progressPercentage}%`;
    }

    function showQuestion(question) {
        questionText.innerText = question.question;
        
        if (question.imageUrl) {
            questionImage.src = question.imageUrl;
            questionImage.classList.remove('hidden');
            questionImage.onerror = () => { questionImage.classList.add('hidden'); };
        } else {
            questionImage.classList.add('hidden');
        }

        question.answers.forEach(answer => {
            const button = document.createElement('button');
            button.innerText = answer.text;
            button.classList.add('answer-btn', 'w-full', 'bg-gray-700', 'border', 'border-gray-600', 'text-gray-200', 'font-medium', 'py-4', 'px-4', 'rounded-lg', 'text-left');
            if (answer.correct) {
                button.dataset.correct = answer.correct;
            }
            button.addEventListener('click', selectAnswer);
            answerButtons.appendChild(button);
        });
    }

    function resetState() {
        nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
        nextBtn.disabled = true;
        while (answerButtons.firstChild) {
            answerButtons.removeChild(answerButtons.firstChild);
        }
        // Hide and clear explanation box (New)
        explanationBox.classList.add('hidden');
        explanationBox.innerHTML = '';
    }

    function selectAnswer(e) {
        Array.from(answerButtons.children).forEach(button => {
            button.disabled = true;
            button.classList.add('cursor-not-allowed');
        });

        const selectedButton = e.target;
        const correct = selectedButton.dataset.correct === "true";
        
        userAnswers.push({
            question: shuffledQuestions[currentQuestionIndex].question,
            selected: selectedButton.innerText,
            correctAnswer: shuffledQuestions[currentQuestionIndex].answers.find(a => a.correct).text,
            isCorrect: correct,
            rationale: shuffledQuestions[currentQuestionIndex].rationale
        });

        if (correct) {
            score++;
        }
        
        // Show correct/incorrect feedback
        Array.from(answerButtons.children).forEach(button => {
            if (button.dataset.correct === "true") {
                button.classList.add('correct');
            }
        });
        if (!correct) {
            selectedButton.classList.add('incorrect');
        }

        // Show explanation for the question (New)
        showExplanation();

        // Enable Next button
        nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        nextBtn.disabled = false;
        
        if (shuffledQuestions.length > currentQuestionIndex + 1) {
            nextBtnText.innerText = 'ข้อถัดไป';
        } else {
            nextBtnText.innerText = 'ดูผลลัพธ์';
        }
    }

    // New function to show explanation after answering
    function showExplanation() {
        const rationale = shuffledQuestions[currentQuestionIndex].rationale;
        explanationBox.innerHTML = `
            <div class="bg-gray-900/50 p-4 rounded-lg border-l-4 border-blue-400">
                <h3 class="font-bold text-lg text-blue-300 mb-2">คำอธิบาย</h3>
                <p class="text-gray-300">${rationale}</p>
            </div>
        `;
        explanationBox.classList.remove('hidden');
    }

    function showResults() {
        quizScreen.classList.add('hidden');
        resultScreen.classList.remove('hidden');

        resultStudentInfo.innerText = `รหัสนักศึกษา: ${studentId} | ชื่อ: ${studentName}`;
        scoreText.innerText = `${score} / ${shuffledQuestions.length}`;
        const percentage = Math.round((score / shuffledQuestions.length) * 100);
        scorePercentage.innerText = `คิดเป็น ${percentage}%`;

        summaryContainer.innerHTML = '';
        const correctIcon = `<svg class="w-6 h-6 text-green-400 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`;
        const incorrectIcon = `<svg class="w-6 h-6 text-red-400 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`;

        userAnswers.forEach((answer, index) => {
            const summaryItem = document.createElement('div');
            summaryItem.classList.add('bg-gray-700', 'p-4', 'rounded-lg', 'border-l-4');
            summaryItem.classList.add(answer.isCorrect ? 'border-green-500' : 'border-red-500');
            
            summaryItem.innerHTML = `
                <div class="flex justify-between items-start">
                    <p class="font-bold text-white mb-2 flex-1 pr-4">ข้อ ${index + 1}: ${answer.question}</p>
                    ${answer.isCorrect ? correctIcon : incorrectIcon}
                </div>
                <div class="text-sm space-y-1">
                    <p class="text-gray-400">คุณตอบ: <span class="font-medium ${answer.isCorrect ? 'text-green-400' : 'text-red-400'}">${answer.selected}</span></p>
                    ${!answer.isCorrect ? `<p class="text-gray-400">คำตอบที่ถูก: <span class="font-medium text-green-400">${answer.correctAnswer}</span></p>` : ''}
                </div>
                <div class="mt-3 pt-3 border-t border-gray-600 bg-gray-900/50 p-3 rounded-md">
                    <p class="text-sm text-blue-300"><strong class="font-semibold text-blue-200">คำอธิบาย:</strong> ${answer.rationale}</p>
                </div>
            `;
            summaryContainer.appendChild(summaryItem);
        });
    }

</script>

</body>
</html>
