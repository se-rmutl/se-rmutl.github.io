<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบทดสอบ | ENGSE214 การรักษาความปลอดภัยของระบบปฏิบัติการ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #111827; /* bg-gray-900 */
        }
        .answer-btn {
            transition: all 0.2s ease-in-out;
        }
        .answer-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            background-color: #4b5563; /* hover:bg-gray-600 */
        }
        .answer-btn.selected {
            background-color: #3b82f6; /* bg-blue-600 */
            border-color: #2563eb; /* border-blue-700 */
            color: white;
        }
        .answer-btn.correct {
            background-color: #16a34a; /* bg-green-600 */
            color: white;
            border-color: #15803d;
        }
        .answer-btn.incorrect {
            background-color: #dc2626; /* bg-red-600 */
            color: white;
            border-color: #b91c1c;
        }
        .btn-icon {
            width: 1.25rem;
            height: 1.25rem;
            margin-right: 0.5rem;
        }
        #explanation-box {
            transition: opacity 0.5s ease-in-out;
        }
    </style>
</head>
<body class="text-gray-200 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl mx-auto">

        <!-- Start Screen -->
        <div id="start-screen" class="bg-gray-800 p-8 rounded-2xl shadow-2xl text-center transition-opacity duration-500">
            <div class="flex justify-center items-center gap-4 mb-4">
                 <svg class="w-10 h-10 text-blue-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                </svg>
                <h1 class="text-3xl md:text-4xl font-bold text-blue-400">แบบทดสอบ Pre-Test / Post-Test</h1>
            </div>
            <p class="text-lg md:text-xl text-gray-300 mb-1">ENGSE214: ความมั่นคงปลอดภัยทางไซเบอร์เบื้องต้น</p>
            <p class="text-md text-gray-400 mb-8">สัปดาห์ที่ 4: การรักษาความปลอดภัยของระบบปฏิบัติการ</p>
            
            <form id="student-form" class="space-y-6">
                <div>
                    <label for="student-id" class="block text-left text-gray-300 mb-2 font-medium">รหัสนักศึกษา</label>
                    <input type="text" id="student-id" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="เช่น 66xxxxxxxx" required>
                </div>
                <div>
                    <label for="student-name" class="block text-left text-gray-300 mb-2 font-medium">ชื่อ - นามสกุล</label>
                    <input type="text" id="student-name" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="เช่น สมชาย ใจดี" required>
                </div>
                <button type="submit" id="start-btn" class="w-full flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 text-lg shadow-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.82m5.84-2.56a12.025 12.025 0 01-4.132 4.032m-4.132-4.032L6.91 9.51m1.36-2.56a12.025 12.025 0 014.132-4.032m4.132 4.032L17.09 9.51m-1.36 2.56a6 6 0 01-5.84-7.38v4.82" />
                    </svg>
                    เริ่มต้นทำแบบทดสอบ
                </button>
            </form>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden bg-gray-800 p-6 md:p-8 rounded-2xl shadow-2xl transition-opacity duration-500">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-400">ความคืบหน้า</span>
                    <span id="question-counter" class="text-sm font-bold text-blue-400">ข้อ 1 / 30</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out"></div>
                </div>
            </div>

            <div class="mb-6">
                <h2 id="question-text" class="text-xl md:text-2xl font-bold mb-4" style="min-height: 6rem;"></h2>
                <img id="question-image" class="hidden max-w-full md:max-w-md mx-auto rounded-lg my-4 shadow-lg" alt="รูปภาพประกอบคำถาม">
            </div>

            <div id="answer-buttons" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>

            <div id="explanation-box" class="hidden mt-6"></div>

            <div class="mt-8 flex justify-end">
                <button id="next-btn" class="flex items-center justify-center bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-lg transition duration-300">
                    <span id="next-btn-text">ข้อถัดไป</span>
                    <svg class="w-5 h-5 ml-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="hidden bg-gray-800 p-6 md:p-8 rounded-2xl shadow-2xl text-center transition-opacity duration-500">
            <h2 class="text-3xl font-bold text-blue-400 mb-2">สรุปผลการทดสอบ</h2>
            <p id="result-student-info" class="text-lg text-gray-300 mb-4"></p>
            
            <div class="bg-gray-700 rounded-xl p-6 my-6">
                <p class="text-lg text-gray-300">คะแนนของคุณคือ</p>
                <p id="score-text" class="text-6xl font-bold text-white my-2">25 / 30</p>
                <p id="score-percentage" class="text-xl text-blue-400"></p>
            </div>

            <div id="summary-container" class="space-y-4 text-left mt-8"></div>

            <button id="retry-btn" class="mt-8 w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition duration-300 text-lg shadow-lg">
                ทำแบบทดสอบอีกครั้ง
            </button>
        </div>
    </div>

<script>
    // --- DATA ---
    const quizData = [
        {
            question: "หลักการ 'Least Privilege' ในการรักษาความปลอดภัยของระบบปฏิบัติการหมายถึงอะไร",
            answers: [
                { text: "ให้สิทธิ์ผู้ใช้น้อยที่สุดเท่าที่จะเป็นไปได้", correct: false },
                { text: "ให้สิทธิ์ผู้ใช้และโปรเซสเท่าที่จำเป็นในการทำงานให้สำเร็จเท่านั้น", correct: true },
                { text: "ให้สิทธิ์ผู้ใช้ทุกคนเท่าเทียมกันเพื่อความสะดวก", correct: false },
                { text: "ให้สิทธิ์สูงสุดแก่ผู้ดูแลระบบเสมอ", correct: false }
            ],
            rationale: "หลักการ Least Privilege (PoLP) คือการจำกัดสิทธิ์การเข้าถึงของผู้ใช้, โปรแกรม, และโปรเซสให้มีเพียงเท่าที่จำเป็นต้องใช้ในการทำงานตามหน้าที่เท่านั้น เพื่อลดความเสียหายหากบัญชีหรือโปรเซสนั้นถูกบุกรุก"
        },
        {
            question: "ข้อใดคือสามปัจจัยหลักของการพิสูจน์ตัวตน (Authentication Factors)",
            answers: [
                { text: "ชื่อผู้ใช้, รหัสผ่าน, และคำถามลับ", correct: false },
                { text: "สิ่งที่คุณรู้, สิ่งที่คุณมี, และสิ่งที่คุณเป็น", correct: true },
                { text: "ลายนิ้วมือ, การจดจำใบหน้า, และการสแกนม่านตา", correct: false },
                { text: "โทเค็น, สมาร์ทการ์ด, และโทรศัพท์มือถือ", correct: false }
            ],
            rationale: "ปัจจัยการพิสูจน์ตัวตนแบ่งเป็น 3 ประเภทหลัก: 1. Something you know (เช่น รหัสผ่าน, PIN), 2. Something you have (เช่น โทเค็น, โทรศัพท์มือถือ), และ 3. Something you are (เช่น ลายนิ้วมือ, ใบหน้า)"
        },
        {
            question: "ในระบบปฏิบัติการ Linux, คำสั่งใดใช้สำหรับเปลี่ยนสิทธิ์ (Permissions) ของไฟล์และไดเรกทอรี",
            answers: [
                { text: "chown", correct: false },
                { text: "chmod", correct: true },
                { text: "chgrp", correct: false },
                { text: "passwd", correct: false }
            ],
            rationale: "คำสั่ง `chmod` (change mode) ใช้สำหรับแก้ไขสิทธิ์การเข้าถึงไฟล์ (อ่าน, เขียน, ประมวลผล) สำหรับเจ้าของ, กลุ่ม, และผู้ใช้อื่นๆ ส่วน `chown` ใช้เปลี่ยนเจ้าของ และ `chgrp` ใช้เปลี่ยนกลุ่ม"
        },
        {
            question: "User Account Control (UAC) ใน Windows มีหน้าที่หลักคืออะไร",
            imageUrl: "https://i.stack.imgur.com/uC2yV.png",
            answers: [
                { text: "เข้ารหัสไฟล์และโฟลเดอร์เพื่อป้องกันการเข้าถึง", correct: false },
                { text: "ป้องกันการเปลี่ยนแปลงระบบที่สำคัญโดยไม่ได้รับอนุญาตจากผู้ใช้", correct: true },
                { text: "จัดการการอัปเดตความปลอดภัยของ Windows", correct: false },
                { text: "สแกนหามัลแวร์และไวรัสในระบบ", correct: false }
            ],
            rationale: "UAC เป็นฟีเจอร์ความปลอดภัยที่ช่วยป้องกันการเปลี่ยนแปลงระบบโดยไม่ได้รับอนุญาต โดยจะแสดงหน้าต่างแจ้งเตือนเพื่อขอการยืนยันจากผู้ใช้ก่อนที่โปรแกรมจะทำการเปลี่ยนแปลงที่อาจส่งผลกระทบต่อระบบปฏิบัติการ"
        },
        {
            question: "Access Control Model แบบใดที่เจ้าของข้อมูล (Owner) เป็นผู้กำหนดสิทธิ์การเข้าถึงข้อมูลของตนเอง",
            answers: [
                { text: "Mandatory Access Control (MAC)", correct: false },
                { text: "Role-Based Access Control (RBAC)", correct: false },
                { text: "Discretionary Access Control (DAC)", correct: true },
                { text: "Attribute-Based Access Control (ABAC)", correct: false }
            ],
            rationale: "DAC เป็นโมเดลที่ให้ 'อำนาจ' แก่เจ้าของทรัพยากรในการตัดสินใจว่าจะให้สิทธิ์ใครเข้าถึงข้อมูลของตนได้บ้าง ระบบไฟล์ส่วนใหญ่ใน Windows และ Linux ใช้โมเดลแบบ DAC เป็นพื้นฐาน"
        },
        {
            question: "การใช้คำสั่ง `sudo` ใน Linux มีวัตถุประสงค์หลักเพื่ออะไร",
            answers: [
                { text: "เพื่อสลับไปยังบัญชีผู้ใช้ root อย่างถาวร", correct: false },
                { text: "เพื่อรันคำสั่งเพียงคำสั่งเดียวด้วยสิทธิ์ของผู้ใช้ root (หรือผู้ใช้อื่น)", correct: true },
                { text: "เพื่อเปลี่ยนรหัสผ่านของผู้ใช้ปัจจุบัน", correct: false },
                { text: "เพื่อสร้างผู้ใช้ใหม่ในระบบ", correct: false }
            ],
            rationale: "`sudo` (superuser do) ช่วยให้ผู้ใช้ที่ได้รับอนุญาตสามารถรันคำสั่งด้วยสิทธิ์ของ superuser (root) หรือผู้ใช้อื่นได้ชั่วคราว เป็นวิธีที่ปลอดภัยกว่าการล็อกอินด้วยบัญชี root โดยตรง"
        },
        {
            question: "ใน Windows Server, เครื่องมือใดที่ใช้ในการกำหนดและบังคับใช้นโยบายความปลอดภัย (Security Policies) กับคอมพิวเตอร์และผู้ใช้จำนวนมากในเครือข่าย",
            answers: [
                { text: "Registry Editor (regedit)", correct: false },
                { text: "Task Manager", correct: false },
                { text: "Group Policy Management Console (GPMC)", correct: true },
                { text: "Windows Defender", correct: false }
            ],
            rationale: "Group Policy เป็นโครงสร้างพื้นฐานที่ช่วยให้ผู้ดูแลระบบสามารถจัดการการตั้งค่าและการทำงานของคอมพิวเตอร์และผู้ใช้ในสภาพแวดล้อม Active Directory Domain Services ได้จากส่วนกลาง"
        },
        {
            question: "หลักการ 'Defense in Depth' เมื่อนำมาใช้กับระบบปฏิบัติการหมายถึงอะไร",
            answers: [
                { text: "การใช้ไฟร์วอลล์ที่ดีที่สุดเพียงอย่างเดียว", correct: false },
                { text: "การใช้มาตรการรักษาความปลอดภัยหลายชั้นซ้อนกัน", correct: true },
                { text: "การเข้ารหัสข้อมูลทั้งหมดในฮาร์ดดิสก์", correct: false },
                { text: "การสำรองข้อมูลอย่างสม่ำเสมอ", correct: false }
            ],
            rationale: "Defense in Depth คือแนวคิดการป้องกันแบบหลายชั้น (Layered Security) หากการป้องกันชั้นหนึ่งล้มเหลว ก็ยังมีชั้นอื่นๆ คอยป้องกันอยู่ ใน OS อาจหมายถึงการมีทั้ง Antivirus, Firewall, UAC, และการเข้ารหัสทำงานร่วมกัน"
        },
        {
            question: "คำสั่ง `chmod 755 script.sh` ใน Linux จะให้สิทธิ์อย่างไรกับไฟล์ `script.sh`",
            answers: [
                { text: "เจ้าของ: อ่าน/เขียน/รัน, กลุ่ม: อ่าน/รัน, อื่นๆ: อ่าน/รัน", correct: true },
                { text: "ทุกคนสามารถ อ่าน/เขียน/รัน ได้", correct: false },
                { text: "เจ้าของ: อ่าน/เขียน, กลุ่ม: อ่าน, อื่นๆ: อ่าน", correct: false },
                { text: "เจ้าของ: รันเท่านั้น, กลุ่มและอื่นๆ: ไม่มีสิทธิ์", correct: false }
            ],
            rationale: "ตัวเลข 755 มาจากการคำนวณค่าสิทธิ์: อ่าน(4), เขียน(2), รัน(1). ดังนั้น 7 = 4+2+1 (rwx), 5 = 4+1 (r-x). สิทธิ์ที่ได้คือ `rwxr-xr-x` ซึ่งหมายถึง เจ้าของ(rwx), กลุ่ม(r-x), และผู้ใช้อื่น(r-x)"
        },
        {
            question: "ข้อใด ไม่ใช่ แนวปฏิบัติที่ดีในการจัดการสิทธิ์ผู้ใช้ (User Privilege Management)",
            answers: [
                { text: "ใช้บัญชีผู้ดูแลระบบ (Administrator/root) สำหรับการทำงานทั่วไปในชีวิตประจำวัน", correct: true },
                { text: "ตรวจสอบสิทธิ์ของผู้ใช้เป็นประจำและนำสิทธิ์ที่ไม่จำเป็นออก", correct: false },
                { text: "ใช้ Role-Based Access Control (RBAC) เพื่อกำหนดสิทธิ์ตามหน้าที่", correct: false },
                { text: "ใช้หลักการ Least Privilege กับบัญชีผู้ใช้และบัญชีบริการ (Service Accounts)", correct: false }
            ],
            rationale: "การใช้บัญชีที่มีสิทธิ์สูง (Privileged Account) สำหรับงานทั่วไปเป็นความเสี่ยงอย่างยิ่ง เพราะหากถูกโจมตี (เช่น ผ่านมัลแวร์หรือฟิชชิง) ผู้โจมตีจะได้รับสิทธิ์ระดับผู้ดูแลระบบทันที"
        },
        {
            question: "SELinux (Security-Enhanced Linux) เป็นตัวอย่างของ Access Control Model แบบใด",
            answers: [
                { text: "Discretionary Access Control (DAC)", correct: false },
                { text: "Mandatory Access Control (MAC)", correct: true },
                { text: "Role-Based Access Control (RBAC)", correct: false },
                { text: "Identity-Based Access Control (IBAC)", correct: false }
            ],
            rationale: "SELinux บังคับใช้นโยบายความปลอดภัยที่กำหนดโดยผู้ดูแลระบบแบบตายตัว (Mandatory) โดยไม่สนใจว่าใครเป็นเจ้าของไฟล์ โปรเซสจะสามารถเข้าถึงได้เฉพาะสิ่งที่นโยบายอนุญาตไว้อย่างชัดเจนเท่านั้น"
        },
        {
            question: "การ Hardening ระบบปฏิบัติการหมายถึงอะไร",
            answers: [
                { text: "การทำให้ระบบทำงานเร็วขึ้น", correct: false },
                { text: "การติดตั้งโปรแกรมเพิ่มเติมให้มากที่สุด", correct: false },
                { text: "การลดพื้นผิวการโจมตี (Attack Surface) โดยการปิดฟีเจอร์และบริการที่ไม่จำเป็น", correct: true },
                { text: "การอัปเกรดฮาร์ดแวร์ของเซิร์ฟเวอร์", correct: false }
            ],
            rationale: "OS Hardening คือกระบวนการรักษาความปลอดภัยของระบบโดยการลดช่องโหว่ ซึ่งทำได้โดยการปิดพอร์ต, ลบบัญชีที่ไม่ใช้, ถอนการติดตั้งซอฟต์แวร์ที่ไม่จำเป็น, และกำหนดค่าความปลอดภัยให้รัดกุมที่สุด"
        },
        {
            question: "ใน Windows, AppLocker ใช้ทำอะไร",
            answers: [
                { text: "ล็อคหน้าจอคอมพิวเตอร์โดยอัตโนมัติ", correct: false },
                { text: "ควบคุมว่าแอปพลิเคชันและไฟล์ใดที่ผู้ใช้สามารถรันได้", correct: true },
                { text: "เข้ารหัสข้อมูลในแอปพลิเคชัน", correct: false },
                { text: "ตรวจสอบการใช้หน่วยความจำของแอปพลิเคชัน", correct: false }
            ],
            rationale: "AppLocker เป็นเทคโนโลยี Whitelisting ที่ช่วยป้องกันการรันซอฟต์แวร์ที่ไม่ได้รับอนุญาตและมัลแวร์ โดยผู้ดูแลระบบสามารถสร้างกฎเพื่ออนุญาตให้รันได้เฉพาะแอปพลิเคชันที่เชื่อถือได้เท่านั้น"
        },
        {
            question: "ข้อใดคือความเสี่ยงของการใช้รหัสผ่านที่ง่ายต่อการคาดเดา",
            answers: [
                { text: "การโจมตีแบบ Brute Force หรือ Dictionary Attack จะสำเร็จได้ง่ายขึ้น", correct: true },
                { text: "ทำให้ระบบทำงานช้าลง", correct: false },
                { text: "ไฟล์ในระบบอาจถูกเข้ารหัสโดยอัตโนมัติ", correct: false },
                { text: "เพิ่มความเสี่ยงต่อการโจมตีแบบ Denial-of-Service (DoS)", correct: false }
            ],
            rationale: "Brute Force Attack คือการลองผิดลองถูกกับรหัสผ่านที่เป็นไปได้ทั้งหมด ส่วน Dictionary Attack คือการใช้รายการคำศัพท์ที่พบบ่อยเป็นรหัสผ่าน หากผู้ใช้ตั้งรหัสผ่านที่ง่าย การโจมตีเหล่านี้ก็จะใช้เวลาน้อยลงมาก"
        },
        {
            question: "ไฟล์ `/etc/passwd` ในระบบ Linux เก็บข้อมูลอะไรเป็นหลัก",
            answers: [
                { text: "รหัสผ่านของผู้ใช้ที่ถูกเข้ารหัสไว้", correct: false },
                { text: "ข้อมูลพื้นฐานของบัญชีผู้ใช้ เช่น ชื่อผู้ใช้, UID, GID, และ home directory", correct: true },
                { text: "รายการคำสั่งที่ผู้ใช้สามารถรันผ่าน sudo ได้", correct: false },
                { text: "บันทึกการล็อกอินและล็อกเอาต์ของผู้ใช้ทั้งหมด", correct: false }
            ],
            rationale: "ไฟล์ `/etc/passwd` เก็บข้อมูลบัญชีผู้ใช้ แต่ไม่ได้เก็บรหัสผ่านโดยตรง รหัสผ่านที่ถูกแฮช (Hashed Password) จะถูกเก็บไว้ในไฟล์ `/etc/shadow` ซึ่งมีสิทธิ์การเข้าถึงที่เข้มงวดกว่า"
        },
        {
            question: "การใช้ Multi-Factor Authentication (MFA) เพิ่มความปลอดภัยได้อย่างไร",
            answers: [
                { text: "ทำให้รหัสผ่านแข็งแกร่งขึ้นโดยอัตโนมัติ", correct: false },
                { text: "ป้องกันการเข้าถึงแม้ว่ารหัสผ่านจะรั่วไหล โดยต้องการปัจจัยการยืนยันตัวตนเพิ่มเติม", correct: true },
                { text: "แจ้งเตือนผู้ใช้เมื่อมีการล็อกอินที่น่าสงสัย", correct: false },
                { text: "เข้ารหัสการเชื่อมต่อระหว่างผู้ใช้และเซิร์ฟเวอร์", correct: false }
            ],
            rationale: "MFA ต้องการการยืนยันตัวตนจากปัจจัยอย่างน้อยสองในสามประเภท (รู้, มี, เป็น) ดังนั้นถึงแม้ผู้โจมตีจะขโมยรหัสผ่าน (สิ่งที่คุณรู้) ไปได้ ก็ยังไม่สามารถล็อกอินได้หากไม่มีปัจจัยที่สอง (เช่น โทรศัพท์มือถือของคุณ)"
        },
        {
            question: "เครื่องมือ `ufw` ใน Ubuntu Linux ใช้สำหรับทำอะไร",
            answers: [
                { text: "อัปเดตซอฟต์แวร์ในระบบ", correct: false },
                { text: "จัดการผู้ใช้และกลุ่ม", correct: false },
                { text: "ตั้งค่าไฟร์วอลล์ (Firewall)", correct: true },
                { text: "ตรวจสอบพื้นที่ว่างบนดิสก์", correct: false }
            ],
            rationale: "`ufw` (Uncomplicated Firewall) เป็นเครื่องมือที่ช่วยให้การจัดการไฟร์วอลล์ `iptables` ของ Linux ง่ายขึ้น ผู้ใช้สามารถเปิดหรือปิดพอร์ตต่างๆ ได้ด้วยคำสั่งที่ไม่ซับซ้อน เช่น `sudo ufw allow 22/tcp`"
        },
        {
            question: "Security Baseline คืออะไร",
            answers: [
                { text: "ระดับความปลอดภัยขั้นต่ำสุดที่ยอมรับได้", correct: false },
                { text: "ชุดของการตั้งค่าความปลอดภัยมาตรฐานที่แนะนำสำหรับระบบหนึ่งๆ", correct:true },
                { text: "ซอฟต์แวร์ที่ใช้สแกนหาช่องโหว่", correct: false },
                { text: "คะแนนความปลอดภัยเริ่มต้นของระบบก่อนการ Hardening", correct: false }
            ],
            rationale: "Security Baseline คือชุดการกำหนดค่า (Configuration) ที่เป็นมาตรฐานและผ่านการทดสอบแล้วว่าปลอดภัย องค์กรจะนำ Baseline นี้ไปใช้กับระบบใหม่ๆ เพื่อให้แน่ใจว่าทุกระบบมีการตั้งค่าความปลอดภัยพื้นฐานที่สอดคล้องกัน"
        },
        {
            question: "ข้อใดคือความเสี่ยงของการไม่ปิดการใช้งานบัญชีผู้ใช้ที่ลาออกไปแล้ว",
            answers: [
                { text: "ทำให้ระบบมีข้อมูลขยะมากเกินไป", correct: false },
                { text: "บัญชีอาจถูกนำไปใช้ในทางที่ผิดโดยผู้ไม่หวังดีหรืออดีตพนักงานเอง", correct: true },
                { text: "ทำให้การสร้างผู้ใช้ใหม่ทำได้ยากขึ้น", correct: false },
                { text: "ลดประสิทธิภาพการทำงานของ Active Directory", correct: false }
            ],
            rationale: "บัญชีที่ไม่ได้ใช้งาน (Orphaned Account) เป็นเป้าหมายหลักของผู้โจมตี เพราะมักจะไม่ถูกตรวจสอบ และหากถูกบุกรุกก็อาจไม่มีใครสังเกตเห็นเป็นเวลานาน"
        },
        {
            question: "BitLocker ใน Windows เป็นเทคโนโลยีที่ใช้สำหรับอะไร",
            answers: [
                { text: "การสำรองและกู้คืนข้อมูล", correct: false },
                { text: "การเข้ารหัสไดรฟ์ทั้งหมด (Full-Volume Encryption)", correct: true },
                { text: "การป้องกันไวรัสและมัลแวร์", correct: false },
                { text: "การควบคุมการเข้าถึงเครือข่าย", correct: false }
            ],
            rationale: "BitLocker Drive Encryption เป็นฟีเจอร์ที่ช่วยป้องกันข้อมูลโดยการเข้ารหัสไดรฟ์ของระบบปฏิบัติการทั้งหมด หากคอมพิวเตอร์ถูกขโมย ข้อมูลในไดรฟ์จะยังคงปลอดภัยและไม่สามารถเข้าถึงได้หากไม่มีคีย์กู้คืน"
        },
        {
            question: "การตรวจสอบ Log (Log Auditing) ในระบบปฏิบัติการมีความสำคัญอย่างไร",
            answers: [
                { text: "ช่วยให้ระบบทำงานเร็วขึ้น", correct: false },
                { text: "ใช้เป็นหลักฐานในการสืบสวนเหตุการณ์ด้านความปลอดภัยและตรวจจับกิจกรรมที่น่าสงสัย", correct: true },
                { text: "ป้องกันการโจมตีแบบ Zero-day", correct: false },
                { text: "ลดจำนวนช่องโหว่ในระบบ", correct: false }
            ],
            rationale: "Log บันทึกเหตุการณ์ต่างๆ ที่เกิดขึ้นในระบบ การตรวจสอบ Log อย่างสม่ำเสมอช่วยให้สามารถตรวจจับรูปแบบการโจมตี, การเข้าถึงที่ไม่ได้รับอนุญาต, หรือความพยายามในการบุกรุก และยังเป็นหลักฐานสำคัญทางดิจิทัล (Digital Forensics)"
        },
        {
            question: "ใน Linux, ไฟล์ `sudoers` (มักจะแก้ไขผ่าน `visudo`) มีไว้เพื่ออะไร",
            answers: [
                { text: "กำหนดว่าผู้ใช้คนใดหรือกลุ่มใดสามารถรันคำสั่งใดได้บ้างด้วยสิทธิ์ของ root", correct: true },
                { text: "เก็บรายชื่อผู้ใช้ทั้งหมดในระบบ", correct: false },
                { text: "กำหนดค่าเริ่มต้นของ Shell สำหรับผู้ใช้ใหม่", correct: false },
                { text: "ตั้งค่ากฎของไฟร์วอลล์", correct: false }
            ],
            rationale: "ไฟล์ `/etc/sudoers` คือไฟล์ที่กำหนดนโยบายของคำสั่ง `sudo` ซึ่งระบุอย่างละเอียดว่าใครสามารถทำอะไรได้บ้าง การแก้ไขไฟล์นี้ควรทำผ่าน `visudo` เพื่อตรวจสอบความถูกต้องของ синтаксисก่อนบันทึก"
        },
        {
            question: "ข้อใดเป็นตัวอย่างของการพิสูจน์ตัวตนโดยใช้ 'Something you are'",
            answers: [
                { text: "การใส่ PIN 6 หลัก", correct: false },
                { text: "การใช้แอป Authenticator บนมือถือ", correct: false },
                { text: "การสแกนลายนิ้วมือเพื่อปลดล็อค", correct: true },
                { text: "การใช้บัตรสมาร์ทการ์ด", correct: false }
            ],
            rationale: "'Something you are' หมายถึงการใช้คุณลักษณะทางชีวภาพ (Biometrics) ในการยืนยันตัวตน เช่น ลายนิ้วมือ, ใบหน้า, ม่านตา, หรือเสียง ซึ่งเป็นสิ่งที่ติดตัวบุคคลและปลอมแปลงได้ยาก"
        },
        {
            question: "เหตุใดการปิดใช้งานบริการ (Services) ที่ไม่จำเป็นจึงช่วยเพิ่มความปลอดภัยของ OS ได้",
            answers: [
                { text: "ทำให้มี RAM เหลือใช้งานมากขึ้น", correct: false },
                { text: "ลดพื้นผิวการโจมตี (Attack Surface) เนื่องจากแต่ละบริการที่รันอยู่คือช่องทางที่อาจถูกโจมตีได้", correct: true },
                { text: "ช่วยให้ Windows Update ทำงานเร็วขึ้น", correct: false },
                { text: "ป้องกันการโจมตีแบบ Phishing", correct: false }
            ],
            rationale: "ทุกๆ บริการที่ทำงานอยู่ (โดยเฉพาะที่เปิดรับการเชื่อมต่อจากเครือข่าย) อาจมีช่องโหว่ในตัวเอง การปิดบริการที่ไม่จำเป็นเป็นการลดจำนวน 'ประตู' ที่ผู้โจมตีสามารถลองเข้ามาได้"
        },
        {
            question: "Access Control List (ACL) คืออะไร",
            answers: [
                { text: "รายชื่อผู้ใช้ที่ได้รับอนุญาตให้เข้าถึงระบบ", correct: false },
                { text: "ตารางที่ระบุสิทธิ์การเข้าถึงของแต่ละผู้ใช้หรือกลุ่มต่อทรัพยากรนั้นๆ", correct: true },
                { text: "นโยบายความปลอดภัยโดยรวมขององค์กร", correct: false },
                { text: "บันทึกเหตุการณ์การเข้าถึงไฟล์ทั้งหมด", correct: false }
            ],
            rationale: "ACL คือรายการของสิทธิ์ (Permissions) ที่ผูกอยู่กับวัตถุ (Object) เช่น ไฟล์ หรือ โฟลเดอร์ ใน ACL จะระบุว่าผู้ใช้ (Subject) คนไหนสามารถกระทำการ (Action) อะไรได้บ้าง (เช่น อ่าน, เขียน)"
        },
        {
            question: "ข้อใดคือความแตกต่างหลักระหว่าง Authentication และ Authorization",
            answers: [
                { text: "Authentication คือ 'คุณคือใคร' ส่วน Authorization คือ 'คุณทำอะไรได้บ้าง'", correct: true },
                { text: "Authentication ใช้สำหรับผู้ใช้ภายนอก แต่ Authorization ใช้สำหรับผู้ใช้ภายใน", correct: false },
                { text: "ทั้งสองคำมีความหมายเหมือนกัน", correct: false },
                { text: "Authorization ต้องทำก่อน Authentication", correct: false }
            ],
            rationale: "Authentication คือกระบวนการพิสูจน์ว่าคุณคือคนที่คุณอ้างว่าเป็นจริง (เช่น โดยการตรวจสอบรหัสผ่าน) หลังจากพิสูจน์ตัวตนสำเร็จแล้ว Authorization จะเป็นกระบวนการตรวจสอบว่าคุณมีสิทธิ์ทำอะไรได้บ้าง"
        },
        {
            question: "ใน Linux, ไดเรกทอรี `/var/log` มีความสำคัญอย่างไรต่อความปลอดภัย",
            answers: [
                { text: "ใช้เก็บไฟล์โปรแกรมที่สำคัญ", correct: false },
                { text: "เป็นที่เก็บไฟล์ Log ของระบบและแอปพลิเคชันต่างๆ ซึ่งจำเป็นต่อการตรวจสอบเหตุการณ์", correct: true },
                { text: "ใช้เก็บไฟล์ชั่วคราวของผู้ใช้", correct: false },
                { text: "เป็นที่เก็บ Home directory ของผู้ใช้ root", correct: false }
            ],
            rationale: "`/var/log` เป็นศูนย์รวมของไฟล์บันทึกเหตุการณ์ (Log files) เช่น การล็อกอิน (`auth.log`), ข้อความจากเคอร์เนล (`kern.log`), และ Log ของบริการต่างๆ การปกป้องและตรวจสอบไดเรกทอรีนี้จึงสำคัญมาก"
        },
        {
            question: "การตั้งค่า 'Password History' ในนโยบายความปลอดภัยของ Windows มีไว้เพื่ออะไร",
            answers: [
                { text: "เพื่อบันทึกรหัสผ่านเก่าของผู้ใช้ไว้สำหรับการกู้คืน", correct: false },
                { text: "เพื่อป้องกันไม่ให้ผู้ใช้เปลี่ยนกลับไปใช้รหัสผ่านเก่าที่เคยใช้แล้วซ้ำอีก", correct: true },
                { text: "เพื่อจำกัดจำนวนครั้งที่ผู้ใช้สามารถเปลี่ยนรหัสผ่านได้ในหนึ่งวัน", correct: false },
                { text: "เพื่อกำหนดความยาวขั้นต่ำของรหัสผ่าน", correct: false }
            ],
            rationale: "หากผู้ใช้สามารถนำรหัสผ่านเก่ากลับมาใช้ได้ทันที อาจทำให้ความปลอดภัยลดลงหากรหัสผ่านเก่านั้นเคยรั่วไหลไปแล้ว การบังคับให้จำประวัติรหัสผ่านไว้จะทำให้ผู้ใช้ต้องสร้างรหัสผ่านใหม่ที่ไม่ซ้ำเดิม"
        },
        {
            question: "เหตุใดการอัปเดตระบบปฏิบัติการและซอฟต์แวร์อย่างสม่ำเสมอจึงเป็นสิ่งสำคัญที่สุดอย่างหนึ่ง",
            answers: [
                { text: "เพื่อให้ได้ฟีเจอร์ใหม่ล่าสุดเสมอ", correct: false },
                { text: "เพื่อแก้ไขข้อบกพร่อง (Bugs) และอุดช่องโหว่ความปลอดภัย (Vulnerabilities) ที่เพิ่งถูกค้นพบ", correct: true },
                { text: "เพื่อให้แน่ใจว่าซอฟต์แวร์ยังคงเข้ากันได้กับฮาร์ดแวร์", correct: false },
                { text: "เพื่อเป็นการรีสตาร์ทระบบและล้างหน่วยความจำ", correct: false }
            ],
            rationale: "ผู้ผลิตซอฟต์แวร์จะปล่อยแพตช์ (Patches) หรืออัปเดตออกมาเพื่อแก้ไขช่องโหว่ที่นักวิจัยความปลอดภัยหรือแฮกเกอร์ค้นพบ การไม่อัปเดตระบบก็เหมือนกับการเปิดประตูทิ้งไว้ให้ผู้โจมตีเข้ามาโดยใช้ช่องโหว่ที่เป็นที่รู้จักกันดี"
        },
        {
            question: "Role-Based Access Control (RBAC) ทำงานอย่างไร",
            answers: [
                { text: "ให้สิทธิ์โดยตรงกับผู้ใช้แต่ละคน", correct: false },
                { text: "ให้สิทธิ์ตามคุณลักษณะของผู้ใช้ เช่น แผนก หรือตำแหน่ง", correct: false },
                { text: "กำหนดบทบาท (Roles) ขึ้นมาก่อน แล้วจึงให้สิทธิ์กับบทบาทนั้นๆ จากนั้นจึงกำหนดผู้ใช้ให้อยู่ในบทบาทที่เหมาะสม", correct: true },
                { text: "ให้สิทธิ์ตามระดับชั้นความลับของข้อมูล", correct: false }
            ],
            rationale: "RBAC ช่วยให้การจัดการสิทธิ์ง่ายขึ้นในองค์กรขนาดใหญ่ แทนที่จะต้องกำหนดสิทธิ์ให้ผู้ใช้ทีละคน ผู้ดูแลระบบจะสร้างบทบาท (เช่น 'ฝ่ายบุคคล', 'นักการตลาด') แล้วกำหนดสิทธิ์ให้บทบาทเหล่านั้น เมื่อมีพนักงานใหม่เข้ามา ก็เพียงแค่เพิ่มเขาเข้าไปในบทบาทที่ถูกต้อง"
        }
    ];

    // --- DOM ELEMENTS ---
    const startScreen = document.getElementById('start-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const resultScreen = document.getElementById('result-screen');
    const studentForm = document.getElementById('student-form');
    const studentIdInput = document.getElementById('student-id');
    const studentNameInput = document.getElementById('student-name');
    const questionText = document.getElementById('question-text');
    const questionImage = document.getElementById('question-image');
    const answerButtons = document.getElementById('answer-buttons');
    const nextBtn = document.getElementById('next-btn');
    const nextBtnText = document.getElementById('next-btn-text');
    const questionCounter = document.getElementById('question-counter');
    const progressBar = document.getElementById('progress-bar');
    const scoreText = document.getElementById('score-text');
    const scorePercentage = document.getElementById('score-percentage');
    const resultStudentInfo = document.getElementById('result-student-info');
    const summaryContainer = document.getElementById('summary-container');
    const retryBtn = document.getElementById('retry-btn');
    const explanationBox = document.getElementById('explanation-box');

    // --- STATE VARIABLES ---
    let shuffledQuestions, currentQuestionIndex;
    let score = 0;
    let userAnswers = [];
    let studentId = '';
    let studentName = '';

    // --- EVENT LISTENERS ---
    studentForm.addEventListener('submit', (e) => {
        e.preventDefault();
        studentId = studentIdInput.value.trim();
        studentName = studentNameInput.value.trim();
        if (studentId && studentName) {
            startQuiz();
        }
    });

    nextBtn.addEventListener('click', () => {
        currentQuestionIndex++;
        if (currentQuestionIndex < shuffledQuestions.length) {
            setNextQuestion();
        } else {
            showResults();
        }
    });

    retryBtn.addEventListener('click', resetQuiz);

    // --- FUNCTIONS ---
    function startQuiz() {
        shuffledQuestions = quizData.sort(() => Math.random() - 0.5);
        currentQuestionIndex = 0;
        score = 0;
        userAnswers = [];
        startScreen.classList.add('hidden');
        resultScreen.classList.add('hidden');
        quizScreen.classList.remove('hidden');
        setNextQuestion();
    }

    function resetQuiz() {
        resultScreen.classList.add('hidden');
        startScreen.classList.remove('hidden');
        studentIdInput.value = '';
        studentNameInput.value = '';
    }

    function setNextQuestion() {
        resetState();
        showQuestion(shuffledQuestions[currentQuestionIndex]);
        updateProgress();
    }

    function updateProgress() {
        const questionNumber = currentQuestionIndex + 1;
        questionCounter.innerText = `ข้อ ${questionNumber} / ${shuffledQuestions.length}`;
        const progressPercentage = (questionNumber / shuffledQuestions.length) * 100;
        progressBar.style.width = `${progressPercentage}%`;
    }

    function showQuestion(question) {
        questionText.innerText = question.question;
        
        if (question.imageUrl) {
            questionImage.src = question.imageUrl;
            questionImage.classList.remove('hidden');
            questionImage.onerror = () => { questionImage.classList.add('hidden'); };
        } else {
            questionImage.classList.add('hidden');
        }

        question.answers.forEach(answer => {
            const button = document.createElement('button');
            button.innerText = answer.text;
            button.classList.add('answer-btn', 'w-full', 'bg-gray-700', 'border', 'border-gray-600', 'text-gray-200', 'font-medium', 'py-4', 'px-4', 'rounded-lg', 'text-left');
            if (answer.correct) {
                button.dataset.correct = answer.correct;
            }
            button.addEventListener('click', selectAnswer);
            answerButtons.appendChild(button);
        });
    }

    function resetState() {
        nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
        nextBtn.disabled = true;
        while (answerButtons.firstChild) {
            answerButtons.removeChild(answerButtons.firstChild);
        }
        explanationBox.classList.add('hidden');
        explanationBox.innerHTML = '';
    }

    function selectAnswer(e) {
        Array.from(answerButtons.children).forEach(button => {
            button.disabled = true;
            button.classList.add('cursor-not-allowed');
        });

        const selectedButton = e.target;
        const correct = selectedButton.dataset.correct === "true";
        
        userAnswers.push({
            question: shuffledQuestions[currentQuestionIndex].question,
            selected: selectedButton.innerText,
            correctAnswer: shuffledQuestions[currentQuestionIndex].answers.find(a => a.correct).text,
            isCorrect: correct,
            rationale: shuffledQuestions[currentQuestionIndex].rationale
        });

        if (correct) {
            score++;
        }
        
        Array.from(answerButtons.children).forEach(button => {
            if (button.dataset.correct === "true") {
                button.classList.add('correct');
            }
        });
        if (!correct) {
            selectedButton.classList.add('incorrect');
        }

        showExplanation();

        nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        nextBtn.disabled = false;
        
        if (shuffledQuestions.length > currentQuestionIndex + 1) {
            nextBtnText.innerText = 'ข้อถัดไป';
        } else {
            nextBtnText.innerText = 'ดูผลลัพธ์';
        }
    }

    function showExplanation() {
        const rationale = shuffledQuestions[currentQuestionIndex].rationale;
        explanationBox.innerHTML = `
            <div class="bg-gray-900/50 p-4 rounded-lg border-l-4 border-blue-400">
                <h3 class="font-bold text-lg text-blue-300 mb-2">คำอธิบาย</h3>
                <p class="text-gray-300">${rationale}</p>
            </div>
        `;
        explanationBox.classList.remove('hidden');
    }

    function showResults() {
        quizScreen.classList.add('hidden');
        resultScreen.classList.remove('hidden');

        resultStudentInfo.innerText = `รหัสนักศึกษา: ${studentId} | ชื่อ: ${studentName}`;
        scoreText.innerText = `${score} / ${shuffledQuestions.length}`;
        const percentage = Math.round((score / shuffledQuestions.length) * 100);
        scorePercentage.innerText = `คิดเป็น ${percentage}%`;

        summaryContainer.innerHTML = '';
        const correctIcon = `<svg class="w-6 h-6 text-green-400 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`;
        const incorrectIcon = `<svg class="w-6 h-6 text-red-400 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`;

        userAnswers.forEach((answer, index) => {
            const summaryItem = document.createElement('div');
            summaryItem.classList.add('bg-gray-700', 'p-4', 'rounded-lg', 'border-l-4');
            summaryItem.classList.add(answer.isCorrect ? 'border-green-500' : 'border-red-500');
            
            summaryItem.innerHTML = `
                <div class="flex justify-between items-start">
                    <p class="font-bold text-white mb-2 flex-1 pr-4">ข้อ ${index + 1}: ${answer.question}</p>
                    ${answer.isCorrect ? correctIcon : incorrectIcon}
                </div>
                <div class="text-sm space-y-1">
                    <p class="text-gray-400">คุณตอบ: <span class="font-medium ${answer.isCorrect ? 'text-green-400' : 'text-red-400'}">${answer.selected}</span></p>
                    ${!answer.isCorrect ? `<p class="text-gray-400">คำตอบที่ถูก: <span class="font-medium text-green-400">${answer.correctAnswer}</span></p>` : ''}
                </div>
                <div class="mt-3 pt-3 border-t border-gray-600 bg-gray-900/50 p-3 rounded-md">
                    <p class="text-sm text-blue-300"><strong class="font-semibold text-blue-200">คำอธิบาย:</strong> ${answer.rationale}</p>
                </div>
            `;
            summaryContainer.appendChild(summaryItem);
        });
    }

</script>

</body>
</html>
