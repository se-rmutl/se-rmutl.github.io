<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENGSE611 - Day 3: State Management เบื้องต้น</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #61DAFB;
            /* React Blue */
            --secondary-color: #20232A;
            /* React Dark */
            --accent-color: #FFD700;
            /* Gold Accent */
            --success-color: #10B981;
            --danger-color: #ef4444;
            --background-gradient: linear-gradient(135deg, #20232A 0%, #282c34 100%);
            --slide-bg: #f8f9fa;
            --text-color: #212529;
            --header-color: #20232A;
            --base-font-size: clamp(16px, 1.5vw, 22px);
            --border-radius: 15px;
            --code-font: 'Fira Code', 'Courier New', monospace;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            overflow: hidden;
            height: 100%;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background: var(--background-gradient);
            color: var(--text-color);
            font-size: 16px;
            line-height: 1.7;
        }

        .presentation {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2vh 3vw;
        }

        .slide {
            background: var(--slide-bg);
            padding: 30px 40px 80px 40px;
            border-radius: var(--border-radius);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            width: 100%;
            height: 100%;
            font-size: var(--base-font-size);
            overflow-y: auto;
            display: none;
            animation: fadeIn 0.5s ease-in-out;
            position: relative;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .slide::-webkit-scrollbar {
            display: none;
        }

        .slide.active {
            display: block;
        }

        .title-slide.active {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: var(--background-gradient);
            color: white;
        }

        .title-slide h1,
        .title-slide h2,
        .title-slide h3,
        .title-slide p {
            color: white !important;
        }

        .title-slide h1 {
            font-size: 3em;
            margin-bottom: 10px;
            border: none;
            color: var(--primary-color) !important;
        }

        .title-slide h2 {
            font-size: 2em;
            margin-bottom: 20px;
            border: none;
        }

        .title-slide h3 {
            font-size: 1.5em;
            font-weight: 400;
            opacity: 0.9;
        }

        .title-slide .react-logo {
            font-size: 5em;
            color: var(--primary-color);
            animation: spin 20s linear infinite;
            display: block;
            margin-bottom: 20px;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.98);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .progress-bar-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background-color: rgba(255, 255, 255, 0.2);
            z-index: 2000;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(120deg, var(--primary-color) 0%, #90e0ef 100%);
            transition: width 0.3s ease-out;
        }

        .presentation-controls {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(32, 35, 42, 0.9);
            padding: 10px 15px;
            border-radius: 50px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(8px);
            z-index: 1000;
        }

        .nav-btn,
        .font-btn,
        .fullscreen-btn {
            background: transparent;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            font-size: 1.5rem;
        }

        .nav-btn:hover:not(:disabled),
        .font-btn:hover,
        .fullscreen-btn:hover {
            background: var(--primary-color);
            color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            background-color: transparent;
            color: #777;
            cursor: not-allowed;
            transform: none;
        }

        #slide-counter {
            color: white;
            font-weight: 500;
            font-size: 1.1em;
            min-width: 70px;
            text-align: center;
        }

        .slide-number {
            position: absolute;
            bottom: 15px;
            right: 20px;
            background: rgba(32, 35, 42, 0.8);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .slide h2 {
            font-size: 2.2em;
            color: var(--header-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 8px;
            margin-bottom: 1em;
            font-weight: 700;
        }

        .slide h3 {
            font-size: 1.6em;
            color: var(--secondary-color);
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            font-weight: 700;
        }

        p,
        ul,
        ol {
            font-size: 1em;
            max-width: 85ch;
            margin-bottom: 1rem;
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        ul li {
            position: relative;
            padding-left: 35px;
            margin-bottom: 12px;
        }

        ul li::before {
            content: attr(data-icon);
            position: absolute;
            left: 0;
            top: 0px;
            color: var(--primary-color);
            font-weight: bold;
            font-family: 'Font Awesome 6 Free';
        }

        pre {
            background: #282c34;
            color: #abb2bf;
            border-radius: 10px;
            padding: 1em;
            margin: 1em 0;
            font-family: var(--code-font);
            font-size: 0.9em;
            overflow-x: auto;
            line-height: 1.6;
        }

        code {
            font-family: var(--code-font);
            background-color: rgba(0, 0, 0, 0.05);
            padding: 2px 5px;
            border-radius: 4px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        .solution {
            border-left: 4px solid var(--accent-color);
            background: #fff9e6;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 20px 0;
            align-items: start;
        }

        blockquote {
            border-left: 5px solid var(--primary-color);
            margin: 1.5em 0;
            padding: 1em 1.5em;
            background-color: #f0f8ff;
            font-style: italic;
        }

        .highlight {
            background-color: #61DAFB33;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }

        .live-preview-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 1em;
            align-items: start;
        }

        .code-pane,
        .preview-pane {
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        .pane-title {
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--secondary-color);
            text-align: center;
        }

        .code-pane pre {
            flex-grow: 1;
            margin: 0;
            display: flex;
            flex-direction: column;
        }

        .code-pane pre code {
            flex-grow: 1;
        }

        .preview-pane-content {
            flex-grow: 1;
            border: 1px solid #ccc;
            border-radius: var(--border-radius);
            background: white;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1) inset;
            overflow-y: auto;
        }

        .interactive-demo {
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 1.5em;
            background: white;
            margin-top: 1em;
        }

        .interactive-demo input,
        .interactive-demo textarea,
        .interactive-demo button,
        .interactive-demo select {
            font-family: 'Sarabun', sans-serif;
            font-size: 0.9em;
            padding: 8px 12px;
            margin: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .interactive-demo button {
            background-color: var(--secondary-color);
            color: white;
            cursor: pointer;
        }

        .interactive-demo button:hover {
            background-color: #4a4e59;
        }

        .interactive-demo .output {
            margin-top: 1em;
            font-weight: bold;
        }

        .interactive-demo .todo-list ul {
            list-style-type: disc;
            padding-left: 20px;
        }

        .interactive-demo .todo-list li {
            padding-left: 10px;
        }

        .interactive-demo .todo-list li button {
            font-size: 0.8em;
            padding: 2px 6px;
            margin-left: 10px;
            background-color: var(--danger-color);
        }

        .explanation-btn {
            background-color: #ffc107;
            color: #212529;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Sarabun', sans-serif;
            font-size: 0.9em;
            font-weight: bold;
            margin-top: 1em;
            transition: all 0.2s ease;
        }

        .explanation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .explanation-box {
            display: none;
            margin-top: 1em;
            padding: 15px;
            background-color: #eef7ff;
            border-left: 5px solid #007bff;
            border-radius: 0 8px 8px 0;
            animation: fadeIn 0.3s;
        }

        .explanation-box h4 {
            margin-top: 0;
            margin-bottom: 0.5em;
            color: #0056b3;
        }

        .explanation-box p {
            font-size: 0.95em;
            margin-bottom: 0.5em;
        }

        .explanation-box code {
            font-size: 0.9em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
            text-align: left;
            margin-top: 1em;
        }

        th,
        td {
            padding: 12px;
            border: 1px solid #ddd;
        }

        thead tr {
            background-color: var(--secondary-color);
            color: white;
        }

        td:first-child {
            font-weight: bold;
        }

        .code-comment {
            color: #5c6370;
            font-style: italic;
        }

        .code-tag {
            color: #e06c75;
        }

        .code-attr {
            color: #d19a66;
        }

        .code-string {
            color: #98c379;
        }

        .code-keyword {
            color: #c678dd;
        }

        .code-js-expr {
            color: #61afef;
        }

        @media (max-width: 900px) {

            .live-preview-container,
            .grid-2 {
                grid-template-columns: 1fr;
                height: auto;
            }

            .slide {
                padding: 20px 25px 70px 25px;
            }

            .slide h2 {
                font-size: 1.8em;
            }
        }
    </style>
</head>

<body>
    <div class="progress-bar-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <div class="presentation">

        <section class="slide title-slide active">
            <h2>หัวข้อที่ 3: State Management เบื้องต้น</h2>
            <i class="fas fa-cogs react-logo" style="animation: none;"></i>
            <h1>State: หน่วยความจำของ Component</h1>
            <h3 style="margin-top: 30px;">เปลี่ยน Component ธรรมดาให้มีชีวิตชีวา!</h3>
            <p style="font-size: 1.2em; opacity: 0.9;">เป้าหมาย: "จาก Static Components → Interactive Applications!"</p>
            <div class="slide-number">1/20</div>
        </section>

        <section class="slide">
            <h2>State คืออะไร? 🧠</h2>
            <p><strong>State</strong> คือ "ความจำระยะสั้น" ของ Component
                เป็นข้อมูลที่สามารถเปลี่ยนแปลงได้ตลอดเวลาตามการโต้ตอบของผู้ใช้ และทุกครั้งที่ State เปลี่ยน React
                จะทำการ "Re-render" หรือวาดหน้าจอใหม่โดยอัตโนมัติ</p>
            <div class="grid-2">
                <div>
                    <h3>เปรียบเทียบชีวิตจริง</h3>
                    <ul>
                        <li data-icon="😊"><strong>อารมณ์:</strong> เศร้า → มีความสุข</li>
                        <li data-icon="🍔"><strong>ความหิว:</strong> หิว → อิ่ม</li>
                        <li data-icon="🔋"><strong>แบตมือถือ:</strong> 100% → 50%</li>
                    </ul>
                </div>
                <div>
                    <h3>ใน Component</h3>
                    <ul>
                        <li data-icon="🔢"><strong>ตัวนับ:</strong> 0 → 1 → 2...</li>
                        <li data-icon="📝"><strong>ฟอร์ม:</strong> ว่าง → มีข้อมูล</li>
                        <li data-icon="🎨"><strong>ธีม:</strong> สว่าง → มืด</li>
                    </ul>
                </div>
            </div>
            <blockquote>ถ้า Component ไม่มี State ก็จะเปรียบเสมือนหุ่นขี้ผึ้ง - สวยงามแต่ไม่มีการตอบสนอง! 🤖
            </blockquote>
            <div class="slide-number">2/20</div>
        </section>

        <section class="slide">
            <h2>Props vs State - ความแตกต่าง 🆚</h2>
            <p>นี่คือแนวคิดที่สำคัญที่สุดในการเริ่มต้นกับ React ครับ</p>
            <table>
                <thead>
                    <tr>
                        <th>คุณสมบัติ</th>
                        <th>Props 🎁 (ของขวัญ)</th>
                        <th>State 💰 (ของส่วนตัว)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>แหล่งที่มา</td>
                        <td>ได้รับมาจาก Component แม่ (Parent)</td>
                        <td>สร้างและจัดการภายใน Component เอง</td>
                    </tr>
                    <tr>
                        <td>การเปลี่ยนแปลง</td>
                        <td><strong style="color: var(--danger-color);">Read-Only</strong> (แก้ไขไม่ได้)</td>
                        <td><strong style="color: var(--success-color);">Mutable</strong> (เปลี่ยนแปลงได้)</td>
                    </tr>
                    <tr>
                        <td>วัตถุประสงค์</td>
                        <td>ใช้สำหรับส่งข้อมูลและการตั้งค่าจากบนลงล่าง</td>
                        <td>ใช้สำหรับจัดการข้อมูลที่เปลี่ยนแปลงตาม Interaction</td>
                    </tr>
                    <tr>
                        <td>ตัวอย่างเปรียบเทียบ</td>
                        <td>ชื่อ-นามสกุลในบัตรประชาชน (ติดตัวมา)</td>
                        <td>อารมณ์ความรู้สึก (เปลี่ยนแปลงได้ตลอด)</td>
                    </tr>
                </tbody>
            </table>

            <div class="grid-2" style="margin-top: 2em;">
                <div>
                    <h3>ตัวอย่าง Props</h3>
                    <pre><code class="language-jsx">function Greeting({ name }) {
  // "name" มาจากข้างนอก แก้ไขไม่ได้
  return &lt;h1&gt;สวัสดี, {name}&lt;/h1&gt;;
}
// การใช้งาน: &lt;Greeting name="สมชาย" /&gt;</code></pre>
                </div>
                <div>
                    <h3>ตัวอย่าง State</h3>
                    <pre><code class="language-jsx">function Counter() {
  // "count" เป็นของเราเอง เปลี่ยนได้
  const [count, setCount] = useState(0);
  return (
    &lt;button onClick={() => setCount(count + 1)}&gt;
      นับไปแล้ว {count}
    &lt;/button>
  );
}</code></pre>
                </div>
            </div>
            <div class="slide-number">3/20</div>
        </section>

        <section class="slide">
            <h2>useState Hook - เวทมนตร์แห่ง State 🪄</h2>
            <p><code>useState</code> คือ Hook หรือฟังก์ชันพิเศษของ React ที่ช่วยให้เราเพิ่ม State เข้าไปในฟังก์ชัน
                Component ได้</p>
            <h3>Syntax พื้นฐาน</h3>
            <pre><code class="language-jsx">import React, { useState } from 'react';

const [state, setState] = useState(initialValue);
//     ↑         ↑            ↑
//   ค่าปัจจุบัน  ฟังก์ชันเปลี่ยน  ค่าเริ่มต้น</code></pre>
            <div class="live-preview-container">
                <div class="code-pane">
                    <div class="pane-title">📝 โค้ด</div>
                    <pre><code class="language-jsx">function LikeButton() {
    // 1. ประกาศ state ชื่อ likes, ค่าเริ่มต้น 0
    const [likes, setLikes] = useState(0);
    
    // 2. สร้างฟังก์ชันสำหรับจัดการ event
    const handleClick = () => {
        // 3. เรียก setLikes เพื่ออัปเดตค่า
        setLikes(likes + 1);
    };
    
    return (
        &lt;div&gt;
            &lt;p&gt;👍 ถูกใจ: {likes} ครั้ง&lt;/p&gt;
            &lt;button onClick={handleClick}&gt;
                กดไลค์
            &lt;/button&gt;
        &lt;/div&gt;
    );
}</code></pre>
                </div>
                <div class="preview-pane">
                    <div class="pane-title">👀 ผลลัพธ์ (Interactive)</div>
                    <div class="interactive-demo" id="demo-like-button"></div>
                </div>
            </div>
            <div class="slide-number">4/20</div>
        </section>

        <section class="slide">
            <h2>ประเภทข้อมูลใน State 📊</h2>
            <p>เราสามารถเก็บข้อมูลได้ทุกประเภทใน State ไม่ว่าจะเป็น Number, String, Boolean, Array, หรือ Object</p>
            <div class="live-preview-container" style="grid-template-columns: 1fr; height: auto;">
                <div class="preview-pane" style="height: auto;">
                    <div class="pane-title">👀 ผลลัพธ์ (Interactive)</div>
                    <div class="grid-2">
                        <div class="interactive-demo" id="demo-number-state"></div>
                        <div class="interactive-demo" id="demo-string-state"></div>
                        <div class="interactive-demo" id="demo-boolean-state"></div>
                        <div class="interactive-demo" id="demo-array-state"></div>
                    </div>
                </div>
            </div>
            <button class="explanation-btn" onclick="toggleExplanation(this)"><i class="fas fa-lightbulb"></i>
                ดูโค้ดตัวอย่าง</button>
            <div class="explanation-box">
                <h4>1. Number State</h4>
                <pre><code>const [count, setCount] = useState(0);</code></pre>
                <h4>2. String State</h4>
                <pre><code>const [name, setName] = useState('');</code></pre>
                <h4>3. Boolean State</h4>
                <pre><code>const [isOn, setIsOn] = useState(false);</code></pre>
                <h4>4. Array State (สำคัญ: ใช้ Spread Operator `...` เพื่อสร้าง array ใหม่)</h4>
                <pre><code>const [todos, setTodos] = useState([]);
const addTodo = (newTodo) => {
  setTodos([...todos, newTodo]);
};</code></pre>
            </div>
            <div class="slide-number">5/20</div>
        </section>

        <section class="slide">
            <h2>Event Handling ใน React 🎯</h2>
            <p><strong>Event Handler</strong> คือฟังก์ชันที่จะถูกเรียกใช้งานเมื่อมีเหตุการณ์ (Event) เกิดขึ้น เช่น
                การคลิก, การพิมพ์, หรือการเลื่อนเมาส์</p>
            <div class="live-preview-container">
                <div class="code-pane">
                    <div class="pane-title">📝 โค้ด</div>
                    <pre><code class="language-jsx">function FormExample() {
    const [inputValue, setInputValue] = useState('');
    
    // Event handler รับ 'event object' เป็นพารามิเตอร์
    const handleInputChange = (event) => {
        // event.target คือ element ที่เกิด event (input)
        // event.target.value คือค่าที่พิมพ์ล่าสุด
        setInputValue(event.target.value);
    };
    
    return (
        &lt;div&gt;
            &lt;input 
                type="text"
                value={inputValue}
                onChange={handleInputChange}
                placeholder="ลองพิมพ์ที่นี่..."
            /&gt;
            &lt;p&gt;คุณพิมพ์: {inputValue}&lt;/p&gt;
        &lt;/div&gt;
    );
}</code></pre>
                </div>
                <div class="preview-pane">
                    <div class="pane-title">👀 ผลลัพธ์ (Interactive)</div>
                    <div class="interactive-demo" id="demo-event-handling"></div>
                </div>
            </div>
            <div class="slide-number">6/20</div>
        </section>

        <section class="slide">
            <h2>Forms และ Controlled Components 📝</h2>
            <p><strong>Controlled Component</strong> คือเทคนิคที่ React แนะนำในการจัดการฟอร์ม โดย State จะเป็น
                "แหล่งความจริงเพียงแหล่งเดียว (Single Source of Truth)" สำหรับข้อมูลในฟอร์ม</p>
            <div class="interactive-demo" id="demo-controlled-form">
                <form>
                    <div>
                        <label>ชื่อผู้ใช้: </label>
                        <input type="text" data-name="username" placeholder="..." />
                    </div>
                    <div>
                        <label>อีเมล: </label>
                        <input type="email" data-name="email" placeholder="..." />
                    </div>
                    <button type="submit">ส่งข้อมูล</button>
                </form>
                <div class="output">
                    <h4>ข้อมูลใน State ตอนนี้:</h4>
                    <pre><code></code></pre>
                </div>
            </div>
            <button class="explanation-btn" onclick="toggleExplanation(this)"><i class="fas fa-lightbulb"></i>
                ข้อดีคืออะไร?</button>
            <div class="explanation-box">
                <h4>ประโยชน์ของ Controlled Components</h4>
                <ul>
                    <li data-icon="✅"><strong>ตรวจสอบข้อมูลได้ทันที (Instant Validation):</strong> เราสามารถเช็ค error
                        ขณะที่ผู้ใช้กำลังพิมพ์ได้เลย</li>
                    <li data-icon="✅"><strong>ควบคุมฟอร์มได้ทั้งหมด:</strong> สามารถ reset หรือ pre-fill
                        ข้อมูลในฟอร์มได้ง่ายๆ แค่เปลี่ยนค่าใน State</li>
                    <li data-icon="✅"><strong>จัดการข้อมูลง่าย:</strong> เมื่อกด submit ข้อมูลทั้งหมดก็พร้อมใช้งานอยู่ใน
                        State แล้ว ไม่ต้องไปดึงจาก DOM</li>
                </ul>
            </div>
            <div class="slide-number">7/20</div>
        </section>

        <section class="slide">
            <h2>Lifting State Up - ยกเก็บข้อมูลขึ้นไป 📤</h2>
            <p>เมื่อมีหลายๆ Component ลูกที่ต้องการเข้าถึงหรือเปลี่ยนแปลงข้อมูลเดียวกัน เราควร "ยก" State
                นั้นขึ้นไปเก็บไว้ที่ <strong>Component แม่ (Parent) ที่ใกล้ที่สุด</strong>
                แล้วส่งข้อมูลและฟังก์ชันลงมาให้ลูกผ่านทาง Props</p>
            <h3>ตัวอย่าง: Panel ที่เปิด-ปิดได้</h3>
            <div class="interactive-demo" id="demo-lifting-state">
                <div class="panel">
                    <h3>หัวข้อที่ 1</h3>
                    <button data-index="0">แสดง</button>
                    <div class="content" style="display:none;">
                        <p>เนื้อหาของหัวข้อที่ 1...</p>
                    </div>
                </div>
                <div class="panel">
                    <h3>หัวข้อที่ 2</h3>
                    <button data-index="1">แสดง</button>
                    <div class="content" style="display:none;">
                        <p>เนื้อหาของหัวข้อที่ 2...</p>
                    </div>
                </div>
            </div>
            <button class="explanation-btn" onclick="toggleExplanation(this)"><i class="fas fa-lightbulb"></i>
                อธิบายหลักการ</button>
            <div class="explanation-box">
                <h4>หลักการ Lifting State Up</h4>
                <p>ในตัวอย่างนี้ ถ้าแต่ละ Panel จัดการ State การเปิด/ปิดของตัวเอง จะทำให้เปิดพร้อมกันได้หลายอัน</p>
                <p>วิธีแก้คือให้ Component แม่ (Accordion) เก็บ State ว่า Panel ไหนกำลัง Active อยู่
                    (<code>activeIndex</code>) แล้วส่งข้อมูลนี้ลงไปให้ลูกแต่ละคน ลูกจะรู้ว่าตัวเองควรแสดงเนื้อหาหรือไม่
                    และเมื่อถูกคลิก ก็จะเรียกฟังก์ชันของแม่เพื่อเปลี่ยน <code>activeIndex</code></p>
                <p>นี่คือหลักการที่ทำให้ Component ต่างๆ สื่อสารและทำงานร่วมกันได้ครับ</p>
            </div>
            <div class="slide-number">8/20</div>
        </section>

        <section class="slide">
            <h2>ตัวอย่างจริง - Shopping Cart 🛒</h2>
            <p>แนวคิดทั้งหมดที่เรียนมาสามารถนำมารวมกันเพื่อสร้างแอปพลิเคชันที่ซับซ้อนขึ้นได้ เช่น ระบบตะกร้าสินค้า</p>

            <h3>Diagram การไหลของข้อมูล (Data Flow)</h3>
            <div style="display: flex; justify-content: center; margin-top: 1em;">
                <pre style="width: 80%; font-size: 0.9em; line-height: 1.8;"><code style="text-align: left;">
  ShoppingApp (Parent Component)
  - state: [cartItems]
  - func: addToCart()
      │
      ├─ Props (cartCount) ─> Header (แสดงจำนวน)
      │
      ├─ Props (items) ─────> Cart (แสดงรายการ)
      │
      └─ Props (onAddToCart) -> ProductList (ส่ง Action กลับมา)
                                  ▲
                                  │
                                (ผู้ใช้คลิกปุ่ม 'Add to Cart')
    </code></pre>
            </div>
            <p class="solution" style="margin-top: 1em;">นี่คือ Pattern ที่สำคัญที่สุดในการสร้าง React Application:
                <strong>State อยู่บน, ส่ง Props ลงล่าง, ส่ง Action กลับขึ้นบน</strong>
            </p>

            <div class="slide-number">9/20</div>
        </section>

        <section class="slide">
            <h2>State Updates และ Re-rendering 🔄</h2>
            <p>การอัปเดต State ใน React มีลักษณะเป็น <strong>Asynchronous</strong> และ React จะทำการ <strong>Batch
                    Updates</strong> เพื่อประสิทธิภาพ</p>
            <h3>Asynchronous Update</h3>
            <p>เมื่อเราเรียก <code>setCount(count + 1)</code> ค่าของ <code>count</code>
                จะยังไม่เปลี่ยนทันทีในบรรทัดถัดไป</p>
            <h3>Functional Update</h3>
            <p>หากการอัปเดตครั้งถัดไปต้องใช้ค่าล่าสุดของ State **ต้องใช้ Functional Update**</p>
            <div class="interactive-demo" id="demo-functional-update">
                <p>Count: <span class="count">0</span></p>
                <button class="add-one">เพิ่ม 1</button>
                <button class="add-three">เพิ่ม 3 (กดครั้งเดียว)</button>
            </div>
            <button class="explanation-btn" onclick="toggleExplanation(this)"><i class="fas fa-lightbulb"></i>
                ดูโค้ด</button>
            <div class="explanation-box">
                <h4>โค้ดสำหรับ "เพิ่ม 3"</h4>
                <pre><code class="language-jsx">const handleTripleClick = () => {
  // ❌ วิธีที่ผิด: React อาจรวมรัดการอัปเดตเหลือครั้งเดียว
  // setCount(count + 1);
  // setCount(count + 1);
  // setCount(count + 1);

  // ✅ วิธีที่ถูก: ใช้ callback function เพื่อเข้าถึงค่าล่าสุด (previous state)
  setCount(prevCount => prevCount + 1);
  setCount(prevCount => prevCount + 1);
  setCount(prevCount => prevCount + 1);
};
                </code></pre>
            </div>
            <div class="slide-number">10/20</div>
        </section>

        <section class="slide">
            <h2>Common Mistakes และ Debugging 🐛</h2>
            <p>ข้อผิดพลาดที่สำคัญที่สุดที่นักพัฒนา React มือใหม่มักจะเจอคือ <strong>การแก้ไข State โดยตรง (Direct
                    Mutation)</strong></p>
            <h3>❌ ห้ามแก้ไข State โดยตรง!</h3>
            <p>เราต้องสร้าง Array หรือ Object ใหม่เสมอเมื่อต้องการอัปเดต State เพื่อให้ React
                ตรวจจับการเปลี่ยนแปลงและทำการ Re-render ได้อย่างถูกต้อง</p>
            <div class="grid-2">
                <div>
                    <h4>การอัปเดต Array</h4>
                    <pre><code class="language-jsx"><span class="code-comment">// ❌ ผิด</span>
todos.push('งานใหม่');
setTodos(todos);

<span class="code-comment">// ✅ ถูก</span>
setTodos([...todos, 'งานใหม่']);</code></pre>
                </div>
                <div>
                    <h4>การอัปเดต Object</h4>
                    <pre><code class="language-jsx"><span class="code-comment">// ❌ ผิด</span>
user.age = 26;
setUser(user);

<span class="code-comment">// ✅ ถูก</span>
setUser({ ...user, age: 26 });</code></pre>
                </div>
            </div>


            <div class="interactive-demo" id="demo-mutation" style="margin-top: 2em;">
                <h3>ตัวอย่าง: การเพิ่ม Item ใน List</h3>
                <ul class="todo-list"></ul>
                <button class="wrong-btn">เพิ่ม (❌ วิธีผิด)</button>
                <button class="correct-btn">เพิ่ม (✅ วิธีถูก)</button>
                <div class="explanation-box" style="display: block; margin-top: 1em;">
                    <h4>เกิดอะไรขึ้น?</h4>
                    <p>ใน React จริง, การกดปุ่ม "วิธีผิด" ที่ใช้ <code>.push()</code> จะไม่ทำให้ UI อัปเดต เพราะ React
                        ไม่เห็นว่า State มีการเปลี่ยนแปลง (Memory address เดิม) แต่ "วิธีถูก" ที่สร้าง Array ใหม่ด้วย
                        <code>[...todos, 'งานใหม่']</code> จะทำให้ UI อัปเดตเสมอ
                    </p>
                </div>
            </div>

            <blockquote>จำไว้ว่า: State ใน React นั้น <strong>Immutable</strong> เราไม่แก้ไขของเก่า แต่เรา
                "สร้างของใหม่" มาแทนที่เสมอ</blockquote>
            <div class="slide-number">11/20</div>
        </section>

        <section class="slide">
            <h2>Performance และ Optimization 🚀</h2>
            <p>โดยปกติ React เร็วมากอยู่แล้ว แต่ในแอปพลิเคชันขนาดใหญ่ การ Re-render ที่ไม่จำเป็นอาจทำให้แอปช้าลงได้</p>
            <h3>ปัญหา: Re-render ที่ไม่จำเป็น</h3>
            <p>เมื่อ State ของ Component แม่เปลี่ยน Component ลูกทั้งหมดจะ Re-render ตามไปด้วย แม้ว่า Props
                ของลูกจะไม่เปลี่ยนแปลงก็ตาม</p>
            <h3>วิธีแก้: <code>React.memo</code></h3>
            <p><code>React.memo</code> คือ Higher-Order Component ที่จะ "จำ" ผลลัพธ์การ render ของ Component ไว้ และจะ
                Re-render ก็ต่อเมื่อ Props ของมันเปลี่ยนแปลงเท่านั้น</p>

            <div class="interactive-demo" id="demo-memo">
                <p><strong>เวลาของ Parent: <span class="parent-time">0</span> วินาที</strong></p>
                <button class="change-prop-btn">เปลี่ยน Props ของลูก</button>
                <div class="grid-2" style="margin-top: 1em;">
                    <div>
                        <h4>Normal Child</h4>
                        <div class="preview-pane-content">Rendered: <span class="normal-renders">0</span> ครั้ง</div>
                    </div>
                    <div>
                        <h4>Memoized Child (React.memo)</h4>
                        <div class="preview-pane-content">Rendered: <span class="memo-renders">0</span> ครั้ง</div>
                    </div>
                </div>
                <div style="margin-top:1em;">
                    <strong>Console Log:</strong>
                    <pre class="console-log" style="height: 100px; overflow-y: scroll; font-size: 0.8em;"></pre>
                </div>
            </div>


            <p class="solution"><strong>กฎสำคัญ:</strong> "Don't optimize prematurely" - อย่าเพิ่งกังวลเรื่อง
                Performance จนกว่าจะเจอปัญหาจริงๆ ทำให้แอปทำงานให้ได้ก่อน แล้วค่อยปรับปรุงประสิทธิภาพทีหลัง</p>
            <div class="slide-number">12/20</div>
        </section>

        <section class="slide">
            <h2>State Patterns ที่ใช้บ่อย 🎨</h2>
            <p>เมื่อเขียน React ไปสักพัก เราจะพบกับรูปแบบการจัดการ State ที่ใช้ซ้ำๆ กันบ่อยๆ</p>
            <ul>
                <li data-icon="🔄"><strong>Toggle Pattern (เปิด/ปิด):</strong> ใช้ Boolean state เพื่อสลับการแสดงผล เช่น
                    การเปิด-ปิด Modal, Dark/Light Mode, หรือการแสดงรายละเอียดเพิ่มเติม
                    <pre><code>const [isOpen, setIsOpen] = useState(false);
const toggle = () => setIsOpen(!isOpen);</code></pre>
                </li>
                <li data-icon="📋"><strong>List Management Pattern:</strong> ใช้ Array state สำหรับการจัดการลิสต์ข้อมูล
                    เช่น การเพิ่ม, ลบ, แก้ไข item ใน Todo List หรือตะกร้าสินค้า
                    <pre><code>const [items, setItems] = useState([]);
const addItem = (item) => setItems([...items, item]);</code></pre>
                </li>
                <li data-icon="📝"><strong>Form State Pattern:</strong> ใช้ Object state เพื่อรวบรวมข้อมูลจากหลายๆ input
                    field ในฟอร์มเดียวกัน ทำให้จัดการและส่งข้อมูลง่ายขึ้น
                    <pre><code>const [formData, setFormData] = useState({ name: '', email: '' });
const handleChange = (e) => setFormData({...});</code></pre>
                </li>
            </ul>
            <div class="slide-number">13/20</div>
        </section>

        <section class="slide">
            <h2>State vs Props - เมื่อไหร่ใช้อะไร? 🤔</h2>
            <p>แผนผังการตัดสินใจง่ายๆ เพื่อช่วยเลือกว่าควรใช้ State หรือ Props</p>
            <ol>
                <li>ข้อมูลนี้มาจากการคำนวณหรือได้มาจาก Props อื่นๆ หรือไม่? → ถ้าใช่, ไม่จำเป็นต้องเป็น State</li>
                <li>ข้อมูลนี้จำเป็นต้องถูกส่งต่อมาจาก Component แม่หรือไม่? → ถ้าใช่, มันคือ Props</li>
                <li>ข้อมูลนี้มีการเปลี่ยนแปลงตามการกระทำของผู้ใช้ภายใน Component นี้หรือไม่? → ถ้าใช่, มันคือ State</li>
            </ol>
            <div class="grid-2">
                <div>
                    <h3>ใช้ State เมื่อ:</h3>
                    <ul>
                        <li data-icon="✅">ข้อมูลมีการเปลี่ยนแปลง</li>
                        <li data-icon="✅">เป็นข้อมูลเฉพาะของ Component</li>
                        <li data-icon="✅">จัดการ input จากผู้ใช้</li>
                    </ul>
                </div>
                <div>
                    <h3>ใช้ Props เมื่อ:</h3>
                    <ul>
                        <li data-icon="✅">ข้อมูลถูกส่งมาจากแม่</li>
                        <li data-icon="✅">ต้องการให้ Component นำไปใช้ซ้ำได้</li>
                        <li data-icon="✅">ข้อมูลไม่มีการเปลี่ยนแปลงใน Component นี้</li>
                    </ul>
                </div>
            </div>
            <div class="slide-number">14/20</div>
        </section>

        <section class="slide">
            <h2>Multiple States และการจัดการ 📊</h2>
            <p>ใน Component ที่ซับซ้อน การมี State หลายตัวเป็นเรื่องปกติ
                การจัดระเบียบที่ดีจะช่วยให้โค้ดอ่านง่ายและจัดการสะดวก</p>
            <h3>เคล็ดลับการจัดการ</h3>
            <ul>
                <li data-icon="1.">
                    <strong>แยก State ตามหน้าที่:</strong> แบ่ง State ตามกลุ่มของข้อมูล เช่น UI State, Data State, Form
                    State
                    <pre><code class="language-jsx">// UI State
const [isLoading, setIsLoading] = useState(true);
// Data State
const [user, setUser] = useState(null);</code></pre>
                </li>
                <li data-icon="2.">
                    <strong>ใช้ Object สำหรับข้อมูลที่เกี่ยวข้องกัน:</strong> ถ้ารวบรวมข้อมูลฟอร์ม ให้ใช้ State
                    เดียวที่เป็น Object
                    <pre><code class="language-jsx">const [formData, setFormData] = useState({
  name: '',
  email: ''
});</code></pre>
                </li>
                <li data-icon="3.">
                    <strong>พิจารณาใช้ <code>useReducer</code> (ขั้นสูง):</strong> เมื่อ State
                    มีความซับซ้อนและมีการเปลี่ยนแปลงหลายรูปแบบ <code>useReducer</code> อาจเป็นทางเลือกที่ดีกว่า
                    <code>useState</code>
                </li>
            </ul>
            <div class="slide-number">15/20</div>
        </section>

        <section class="slide">
            <h2>Lab 3.3 Preview - Counter Game 🎮</h2>
            <p>ใน Lab สุดท้ายของวันนี้ เราจะนำความรู้เรื่อง State ทั้งหมดมาประยุกต์ใช้เพื่อสร้างเกมง่ายๆ ครับ</p>
            <h3>สิ่งที่เราจะสร้าง:</h3>
            <p>เกมคลิกนับคะแนนแข่งกับเวลา โดยมีฟีเจอร์ต่างๆ เช่น:</p>
            <ul>
                <li data-icon="🎯"><strong>Multiple States:</strong> <code>score</code>, <code>level</code>,
                    <code>timeLeft</code>, <code>isGameActive</code>, <code>highScore</code>
                </li>
                <li data-icon="⏱️"><strong>Timer Logic:</strong> ใช้ <code>setInterval</code> และ <code>useEffect</code>
                    เพื่อนับเวลาถอยหลัง</li>
                <li data-icon="🏆"><strong>Game Logic:</strong> การคำนวณคะแนน, การเลื่อน level, การบันทึกคะแนนสูงสุด
                </li>
                <li data-icon="🔄"><strong>Conditional Rendering:</strong> แสดงหน้าจอต่างกันตามสถานะของเกม (ก่อนเริ่ม,
                    กำลังเล่น, จบเกม)</li>
            </ul>
            <div class="interactive-demo" id="demo-counter-game">
                <h3>ตัวอย่าง Demo เกม (อย่างง่าย)</h3>
                <p><strong>คะแนน:</strong> 0 | <strong>เวลา:</strong> 10</p>
                <button>เริ่มเกม</button>
                <button disabled>คลิก!</button>
            </div>
            <p class="solution">เตรียมตัวให้พร้อมสำหรับ Lab ที่จะทดสอบความเข้าใจเรื่อง State ของคุณอย่างเต็มที่!</p>
            <div class="slide-number">16/20</div>
        </section>

        <section class="slide">
            <h2>State Best Practices 💎</h2>
            <p>เคล็ดลับที่จะทำให้การจัดการ State ของคุณเป็นมืออาชีพ</p>
            <ul>
                <li data-icon="1.">
                    <strong>Keep State Minimal & DRY:</strong> อย่าเก็บข้อมูลที่ไม่จำเป็นหรือคำนวณได้จาก State อื่นๆ
                    <pre><code class="language-jsx">// ❌ ไม่ดี: fullName เป็น state ซ้ำซ้อน
const [firstName, setFirstName] = useState('สมชาย');
const [lastName, setLastName] = useState('ใจดี');
const [fullName, setFullName] = useState('สมชาย ใจดี');

// ✅ ดี: คำนวณเมื่อต้องการใช้งาน
const fullName = `${firstName} ${lastName}`;</code></pre>
                </li>
                <li data-icon="2.">
                    <strong>Group Related State:</strong> ถ้ารู้สึกว่ามี <code>useState</code> เยอะเกินไป
                    ลองจัดกลุ่มข้อมูลที่เกี่ยวข้องกันด้วย Object หรือ <code>useReducer</code>
                </li>
                <li data-icon="3.">
                    <strong>Avoid Deeply Nested State:</strong> State ที่มีโครงสร้างซับซ้อนเกินไป (Object ซ้อน Object
                    ซ้อน Array) จะอัปเดตได้ยากและอาจนำไปสู่บั๊ก
                </li>
            </ul>
            <div class="slide-number">17/20</div>
        </section>

        <section class="slide">
            <h2>Common Use Cases - ใช้ State ทำอะไรได้บ้าง? 🛠️</h2>
            <p>State เป็นหัวใจของการสร้างฟีเจอร์ Interactive ส่วนใหญ่ในเว็บแอปพลิเคชัน</p>
            <div class="grid-2">
                <ul>
                    <li data-icon="📝">Form Handling</li>
                    <li data-icon="🔍">Real-time Search & Filtering</li>
                    <li data-icon="💬">Modal / Dialog Management</li>
                    <li data-icon="🎨">Theme Management (Dark/Light Mode)</li>
                </ul>
                <ul>
                    <li data-icon="⏳">Loading / Error / Success States</li>
                    <li data-icon="🔢">Pagination</li>
                    <li data-icon="🧭">Tabs & Accordions</li>
                    <li data-icon="🛒">Shopping Carts</li>
                </ul>
            </div>
            <blockquote>ทุกครั้งที่คุณเห็น UI ที่เปลี่ยนแปลงได้ตามการกระทำของผู้ใช้ เบื้องหลังมักจะมี State
                เข้ามาเกี่ยวข้องเสมอ</blockquote>
            <div class="slide-number">18/20</div>
        </section>

        <section class="slide">
            <h2>State vs Local Storage - เก็บข้อมูลที่ไหน? 💾</h2>
            <p>การเลือกที่เก็บข้อมูลที่ถูกต้องเป็นสิ่งสำคัญ</p>
            <table>
                <thead>
                    <tr>
                        <th>คุณสมบัติ</th>
                        <th>State</th>
                        <th>Local Storage</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>อายุขัย</strong></td>
                        <td>หายเมื่อรีเฟรชหน้า</td>
                        <td>คงอยู่ถาวร (จนกว่าจะล้าง)</td>
                    </tr>
                    <tr>
                        <td><strong>การอัปเดต UI</strong></td>
                        <td>อัปเดตอัตโนมัติเมื่อเปลี่ยนค่า</td>
                        <td>ต้องเขียนโค้ดเพื่ออัปเดตเอง</td>
                    </tr>
                    <tr>
                        <td><strong>ประเภทข้อมูล</strong></td>
                        <td>ทุกประเภทใน JS</td>
                        <td>เก็บได้แค่ String</td>
                    </tr>
                </tbody>
            </table>

            <div class="interactive-demo" id="demo-localstorage" style="margin-top: 1.5em;">
                <p>ลองพิมพ์ในช่องด้านล่าง แล้วกดปุ่ม <strong>'Refresh Demo'</strong> (หรือรีเฟรชทั้งหน้าด้วย F5)</p>
                <div>
                    <label><strong>1. ควบคุมด้วย State:</strong> </label>
                    <input type="text" class="state-input" placeholder="ข้อมูลนี้จะหายไป...">
                </div>
                <div>
                    <label><strong>2. ควบคุมด้วย Local Storage:</strong> </label>
                    <input type="text" class="localstorage-input" placeholder="ข้อมูลนี้จะยังอยู่...">
                </div>
                <button class="refresh-demo-btn" style="margin-top: 1em; background-color: var(--success-color);">🔄
                    Refresh Demo</button>
            </div>

            <h3>หลักการง่ายๆ:</h3>
            <ul>
                <li data-icon="💭"><strong>ใช้ State</strong> สำหรับข้อมูลชั่วคราวที่เกี่ยวกับ UI ปัจจุบัน</li>
                <li data-icon="💾"><strong>ใช้ Local Storage</strong> สำหรับการตั้งค่าของผู้ใช้ที่ต้องการให้จดจำข้าม
                    session (เช่น Dark mode, ภาษา)</li>
            </ul>
            <div class="slide-number">19/20</div>
        </section>

        <section class="slide">
            <h2>สรุปและเตรียมตัวสำหรับ Lab 🎓</h2>
            <h3>สิ่งที่เราได้เรียนรู้ในหัวข้อนี้:</h3>
            <ul>
                <li data-icon="✅"><strong>useState Hook:</strong> วิธีการสร้างและอัปเดต State</li>
                <li data-icon="✅"><strong>Event Handling:</strong> การทำให้ Component ตอบสนองต่อผู้ใช้</li>
                <li data-icon="✅"><strong>Controlled Components:</strong> การจัดการฟอร์มอย่างมีประสิทธิภาพ</li>
                <li data-icon="✅"><strong>Lifting State Up:</strong> การสื่อสารระหว่าง Components</li>
                <li data-icon="✅"><strong>Immutable Updates:</strong> หลักการสำคัญในการอัปเดต State</li>
            </ul>
            <blockquote>ตอนนี้คุณมีเครื่องมือที่ทรงพลังที่สุดในการสร้าง React Application ที่มีชีวิตชีวาแล้ว!
            </blockquote>
            <h3 style="text-align:center; margin-top:2em;">เตรียมพร้อมสำหรับ Lab 3.3: สร้าง Counter Game!</h3>
            <div class="slide-number">20/20</div>
        </section>

    </div>

    <div class="presentation-controls">
        <button id="prev-btn" class="nav-btn" title="สไลด์ก่อนหน้า">‹</button>
        <span id="slide-counter"></span>
        <button id="next-btn" class="nav-btn" title="สไลด์ถัดไป">›</button>
        <button id="font-decrease-btn" class="font-btn" title="ลดขนาดตัวอักษร">-</button>
        <button id="font-increase-btn" class="font-btn" title="เพิ่มขนาดตัวอักษร">+</button>
        <button id="fullscreen-btn" class="fullscreen-btn" title="เต็มจอ">⛶</button>
    </div>

    <script>
        function toggleExplanation(btn) {
            const explanationBox = btn.nextElementSibling;
            if (explanationBox && explanationBox.classList.contains('explanation-box')) {
                const isVisible = explanationBox.style.display === 'block';
                explanationBox.style.display = isVisible ? 'none' : 'block';
                btn.innerHTML = isVisible ? '<i class="fas fa-lightbulb"></i> อธิบายเพิ่มเติม' : '<i class="fas fa-times"></i> ปิดคำอธิบาย';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const slides = document.querySelectorAll('.slide');
            const totalSlides = slides.length;
            let currentSlideIndex = 0;

            const nextBtn = document.getElementById('next-btn');
            const prevBtn = document.getElementById('prev-btn');
            const slideCounter = document.getElementById('slide-counter');
            const progressBar = document.getElementById('progress-bar');

            // --- ✨ UPDATE: Get fullscreen & font buttons ---
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const fontIncreaseBtn = document.getElementById('font-increase-btn');
            const fontDecreaseBtn = document.getElementById('font-decrease-btn');

            function showSlide(index) {
                if (index < 0 || index >= totalSlides) return;
                slides.forEach((slide, i) => slide.classList.toggle('active', i === index));
                currentSlideIndex = index;
                updateControls();
                runInteractiveDemos(slides[index]);
            }

            function updateControls() {
                slideCounter.textContent = `${currentSlideIndex + 1} / ${totalSlides}`;
                progressBar.style.width = `${((currentSlideIndex + 1) / totalSlides) * 100}%`;
                prevBtn.disabled = currentSlideIndex === 0;
                nextBtn.disabled = currentSlideIndex === totalSlides - 1;
            }

            nextBtn.addEventListener('click', () => showSlide(currentSlideIndex + 1));
            prevBtn.addEventListener('click', () => showSlide(currentSlideIndex - 1));
            document.addEventListener('keydown', (e) => {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.isContentEditable) return;
                if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextBtn.click(); }
                if (e.key === 'ArrowLeft') { e.preventDefault(); prevBtn.click(); }
            });

            // --- ✨ UPDATE: Fullscreen Button Logic ---
            fullscreenBtn.addEventListener('click', () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        alert(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
                    });
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    }
                }
            });

            // --- ✨ UPDATE: Font Size Control Logic ---
            const changeFontSize = (amount) => {
                const root = document.documentElement;
                const currentSize = parseFloat(getComputedStyle(root).getPropertyValue('--base-font-size'));
                // Use clamp's min and max as boundaries if possible, otherwise set manual limits.
                const newSize = Math.max(12, Math.min(32, currentSize + amount)); // Limits font size between 12px and 32px
                root.style.setProperty('--base-font-size', `${newSize}px`);
            };
            fontIncreaseBtn.addEventListener('click', () => changeFontSize(1));
            fontDecreaseBtn.addEventListener('click', () => changeFontSize(-1));


            // --- Interactive Demos ---
            function runInteractiveDemos(activeSlide) {
                if (!activeSlide) return;

                // Demo: Like Button (Slide 4)
                const likeButtonDemo = activeSlide.querySelector('#demo-like-button');
                if (likeButtonDemo && !likeButtonDemo.dataset.initialized) {
                    likeButtonDemo.dataset.initialized = true;
                    let likes = 0;
                    likeButtonDemo.innerHTML = `
                    <p class="output">👍 ถูกใจ: <span>0</span> ครั้ง</p>
                    <button>กดไลค์</button>`;
                    const span = likeButtonDemo.querySelector('span');
                    likeButtonDemo.querySelector('button').addEventListener('click', () => {
                        likes++;
                        span.textContent = likes;
                    });
                }

                // Demo: State Types (Slide 5)
                const numberStateDemo = activeSlide.querySelector('#demo-number-state');
                if (numberStateDemo && !numberStateDemo.dataset.initialized) {
                    numberStateDemo.dataset.initialized = true;
                    let count = 0;
                    numberStateDemo.innerHTML = `<h4>Number State</h4><p class="output">ตัวนับ: <span>0</span></p><button class="plus">+</button><button class="minus">-</button>`;
                    const span = numberStateDemo.querySelector('span');
                    numberStateDemo.querySelector('.plus').addEventListener('click', () => span.textContent = ++count);
                    numberStateDemo.querySelector('.minus').addEventListener('click', () => span.textContent = --count);
                }
                const stringStateDemo = activeSlide.querySelector('#demo-string-state');
                if (stringStateDemo && !stringStateDemo.dataset.initialized) {
                    stringStateDemo.dataset.initialized = true;
                    stringStateDemo.innerHTML = `<h4>String State</h4><input type="text" placeholder="กรอกชื่อ..."><p class="output">สวัสดี, <span></span>!</p>`;
                    const span = stringStateDemo.querySelector('span');
                    stringStateDemo.querySelector('input').addEventListener('input', (e) => span.textContent = e.target.value || 'ท่านผู้มีเกียรติ');
                    span.textContent = 'ท่านผู้มีเกียรติ';
                }
                const booleanStateDemo = activeSlide.querySelector('#demo-boolean-state');
                if (booleanStateDemo && !booleanStateDemo.dataset.initialized) {
                    booleanStateDemo.dataset.initialized = true;
                    let isOn = false;
                    booleanStateDemo.innerHTML = `<h4>Boolean State</h4><p class="output">สถานะ: <span>🔴 ปิด</span></p><button>สลับ</button>`;
                    const span = booleanStateDemo.querySelector('span');
                    const button = booleanStateDemo.querySelector('button');
                    const update = () => {
                        span.textContent = isOn ? '🟢 เปิด' : '🔴 ปิด';
                        button.textContent = isOn ? 'ปิด' : 'เปิด';
                    };
                    button.addEventListener('click', () => {
                        isOn = !isOn;
                        update();
                    });
                }
                const arrayStateDemo = activeSlide.querySelector('#demo-array-state');
                if (arrayStateDemo && !arrayStateDemo.dataset.initialized) {
                    arrayStateDemo.dataset.initialized = true;
                    let todos = ['เรียน React'];
                    arrayStateDemo.innerHTML = `<h4>Array State</h4><div class="todo-list"><ul></ul></div><input type="text" placeholder="เพิ่มงาน..."><button>เพิ่ม</button>`;
                    const ul = arrayStateDemo.querySelector('ul');
                    const input = arrayStateDemo.querySelector('input');
                    const renderTodos = () => {
                        ul.innerHTML = '';
                        todos.forEach((todo, index) => {
                            const li = document.createElement('li');
                            li.textContent = todo;
                            const removeBtn = document.createElement('button');
                            removeBtn.textContent = 'ลบ';
                            removeBtn.onclick = () => {
                                todos.splice(index, 1);
                                renderTodos();
                            };
                            li.appendChild(removeBtn);
                            ul.appendChild(li);
                        });
                    };
                    arrayStateDemo.querySelector('button').addEventListener('click', () => {
                        if (input.value.trim()) {
                            todos.push(input.value.trim());
                            renderTodos();
                            input.value = '';
                        }
                    });
                    renderTodos();
                }

                // Demo: Event Handling (Slide 6)
                const eventDemo = activeSlide.querySelector('#demo-event-handling');
                if (eventDemo && !eventDemo.dataset.initialized) {
                    eventDemo.dataset.initialized = true;
                    eventDemo.innerHTML = `<input type="text" placeholder="ลองพิมพ์ที่นี่..."><p class="output">คุณพิมพ์: <span></span></p>`;
                    const span = eventDemo.querySelector('span');
                    eventDemo.querySelector('input').addEventListener('input', e => span.textContent = e.target.value);
                }

                // Demo: Controlled Form (Slide 7)
                const formDemo = activeSlide.querySelector('#demo-controlled-form');
                if (formDemo && !formDemo.dataset.initialized) {
                    formDemo.dataset.initialized = true;
                    const state = { username: '', email: '' };
                    const output = formDemo.querySelector('pre code');
                    const updateOutput = () => output.textContent = JSON.stringify(state, null, 2);
                    formDemo.querySelectorAll('input').forEach(input => {
                        input.addEventListener('input', e => {
                            state[e.target.dataset.name] = e.target.value;
                            updateOutput();
                        });
                    });
                    formDemo.querySelector('form').addEventListener('submit', e => {
                        e.preventDefault();
                        alert(`ส่งข้อมูล:\n${JSON.stringify(state, null, 2)}`);
                    });
                    updateOutput();
                }

                // Demo: Lifting State (Slide 8)
                const liftingDemo = activeSlide.querySelector('#demo-lifting-state');
                if (liftingDemo && !liftingDemo.dataset.initialized) {
                    liftingDemo.dataset.initialized = true;
                    let activeIndex = null;
                    const panels = liftingDemo.querySelectorAll('.panel');
                    panels.forEach((panel, index) => {
                        panel.querySelector('button').addEventListener('click', () => {
                            activeIndex = (activeIndex === index) ? null : index;
                            panels.forEach((p, i) => {
                                p.querySelector('.content').style.display = i === activeIndex ? 'block' : 'none';
                                p.querySelector('button').textContent = i === activeIndex ? 'ซ่อน' : 'แสดง';
                            });
                        });
                    });
                }

                // Demo: Functional Update (Slide 10)
                const funcUpdateDemo = activeSlide.querySelector('#demo-functional-update');
                if (funcUpdateDemo && !funcUpdateDemo.dataset.initialized) {
                    funcUpdateDemo.dataset.initialized = true;
                    let count = 0;
                    const countSpan = funcUpdateDemo.querySelector('.count');
                    funcUpdateDemo.querySelector('.add-one').addEventListener('click', () => {
                        count++;
                        countSpan.textContent = count;
                    });
                    funcUpdateDemo.querySelector('.add-three').addEventListener('click', () => {
                        count = count + 3; // Simulate functional update batching
                        countSpan.textContent = count;
                    });
                }


                // Demo: Mutation (Slide 11)
                const mutationDemo = activeSlide.querySelector('#demo-mutation');
                if (mutationDemo && !mutationDemo.dataset.initialized) {
                    mutationDemo.dataset.initialized = true;
                    let todos = ['เรียน HTML'];
                    const ul = mutationDemo.querySelector('ul');

                    const render = () => {
                        ul.innerHTML = '';
                        todos.forEach(todo => {
                            const li = document.createElement('li');
                            li.textContent = todo;
                            ul.appendChild(li);
                        });
                    };

                    mutationDemo.querySelector('.wrong-btn').addEventListener('click', () => {
                        todos.push('เรียน CSS (ผิด)'); // Direct Mutation
                        render();
                    });

                    mutationDemo.querySelector('.correct-btn').addEventListener('click', () => {
                        todos = [...todos, 'เรียน JS (ถูก)'];
                        render();
                    });

                    render();
                }

                // Demo: React.memo (Slide 12)
                const memoDemo = activeSlide.querySelector('#demo-memo');
                if (memoDemo && !memoDemo.dataset.initialized) {
                    memoDemo.dataset.initialized = true;
                    let parentTime = 0, normalRenders = 0, memoRenders = 0, propForChild = 'A';
                    const timeSpan = memoDemo.querySelector('.parent-time');
                    const normalSpan = memoDemo.querySelector('.normal-renders');
                    const memoSpan = memoDemo.querySelector('.memo-renders');
                    const consoleLog = memoDemo.querySelector('.console-log');

                    const log = (msg) => {
                        consoleLog.innerHTML += `${msg}\n`;
                        consoleLog.scrollTop = consoleLog.scrollHeight;
                    };

                    const render = () => {
                        normalRenders++;
                        timeSpan.textContent = parentTime;
                        normalSpan.textContent = normalRenders;
                        memoSpan.textContent = memoRenders;
                        log(`--- Parent state changed (Time: ${parentTime}) ---`);
                        log(`NormalChild re-rendered.`);
                    };

                    memoDemo.querySelector('.change-prop-btn').addEventListener('click', () => {
                        propForChild = propForChild === 'A' ? 'B' : 'A';
                        memoRenders++;
                        log(`*** Child Prop changed to '${propForChild}' ***`);
                        log(`MemoizedChild re-rendered because its prop changed.`);
                        render();
                    });

                    normalRenders++;
                    memoRenders++;
                    log('Initial Render.');
                    log('NormalChild rendered.');
                    log('MemoizedChild rendered.');
                    normalSpan.textContent = normalRenders;
                    memoSpan.textContent = memoRenders;

                    setInterval(() => {
                        parentTime++;
                        render();
                    }, 2000);
                }
                // Demo: Counter Game (Slide 16)
                const gameDemo = activeSlide.querySelector('#demo-counter-game');
                if (gameDemo && !gameDemo.dataset.initialized) {
                    gameDemo.dataset.initialized = true;

                    gameDemo.innerHTML = `
                    <h3>ตัวอย่าง Demo เกม (อย่างง่าย)</h3>
                    <p><strong>คะแนน:</strong> <span class="score">0</span> | <strong>เวลา:</strong> <span class="time">10</span></p>
                    <button class="start-btn">เริ่มเกม</button>
                    <button class="click-btn" disabled>คลิก!</button>
                `;
                    const scoreSpan = gameDemo.querySelector('.score');
                    const timeSpan = gameDemo.querySelector('.time');
                    const startBtn = gameDemo.querySelector('.start-btn');
                    const clickBtn = gameDemo.querySelector('.click-btn');
                    let score = 0, timeLeft = 10, gameInterval = null, isGameActive = false;

                    const resetGame = () => {
                        score = 0; timeLeft = 10; isGameActive = false;
                        scoreSpan.textContent = score;
                        timeSpan.textContent = timeLeft;
                        startBtn.disabled = false;
                        clickBtn.disabled = true;
                        if (gameInterval) clearInterval(gameInterval);
                    };

                    const startGame = () => {
                        isGameActive = true; startBtn.disabled = true; clickBtn.disabled = false;
                        gameInterval = setInterval(() => {
                            timeLeft--;
                            timeSpan.textContent = timeLeft;
                            if (timeLeft <= 0) {
                                alert(`หมดเวลา! คุณได้ ${score} คะแนน`);
                                resetGame();
                            }
                        }, 1000);
                    };

                    startBtn.addEventListener('click', startGame);
                    clickBtn.addEventListener('click', () => {
                        if (isGameActive) {
                            score++;
                            scoreSpan.textContent = score;
                        }
                    });

                    resetGame();
                }


                // --- ✨ UPDATE: Local Storage Demo (Slide 19) ---
                const lsDemo = activeSlide.querySelector('#demo-localstorage');
                if (lsDemo && !lsDemo.dataset.initialized) {
                    lsDemo.dataset.initialized = true;
                    const stateInput = lsDemo.querySelector('.state-input');
                    const localStorageInput = lsDemo.querySelector('.localstorage-input');
                    const refreshBtn = lsDemo.querySelector('.refresh-demo-btn');
                    const STORAGE_KEY = 'my-demo-text';

                    const initializeDemo = () => {
                        const savedValue = localStorage.getItem(STORAGE_KEY);
                        localStorageInput.value = savedValue || '';
                        stateInput.value = ''; // State input is always cleared on "refresh"
                    };

                    localStorageInput.addEventListener('input', (e) => {
                        localStorage.setItem(STORAGE_KEY, e.target.value);
                    });

                    // Add event listener for the new refresh button
                    refreshBtn.addEventListener('click', initializeDemo);

                    initializeDemo(); // Initial load
                }
            }

            showSlide(0);
        });
    </script>


</body>

</html>